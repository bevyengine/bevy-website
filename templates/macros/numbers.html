<!-- Forgive the one-liner. Zola will introduce weird spaces if you insert newlines here -->
{% macro comma_string(value) %}{% set_global number_string = value | as_str %}{% set_global number_commas = "" %}{% set_global letter_count = 0 %}{% for letter in number_string | reverse %}{% set_global number_commas = number_commas ~ letter %}{% set_global letter_count = letter_count + 1 %}{% if letter_count > 2 and letter_count % 3 == 0 and letter_count != number_string | length %}{% set_global number_commas = number_commas ~ "," %}{% endif %}{% endfor %}{{ number_commas | reverse }}{% endmacro comma_string %}
