<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Bevy 0.7" property=og:title><meta content=website property=og:type><meta content=https://bevy.org//news/bevy-0-7/ property=og:url><meta content=https://bevy.org/news/bevy-0-7/mushroom.png property=og:image><meta content="Thanks to 123 contributors, 349 pull requests, and our generous sponsors, I'm happy to announce the Bevy 0.7 release on crates.io!
For those who don'tâ€¦" property=og:description><link rel="shortcut icon" href=/assets/favicon.png type=image/png><link href=/site.css rel=stylesheet><link href=/atom.xml rel=alternate type=application/atom+xml><title>Bevy 0.7</title><script defer src=/highlight-intrapage-link.js></script><body><div class=layout><input class=hidden id=mobile-menu-state type=checkbox><header class="layout__header header print:hidden" data-mobile-menu-state-container><div class=header__content><label class=main-menu-backdrop for=mobile-menu-state></label><label class="header__hamburger button-square button-square--header" for=mobile-menu-state><img alt="Three horizontal lines stacked on top of eachother" height=16 src=/assets/icon-hamburger.svg width=20></label><div class=header__left-block><a class=header__logo href=/> <picture class=logo><img alt="Bevy logo" class=logo height=130 src=/assets/bevy_logo_dark.svg width=520></picture> </a><div class=header__message>News</div></div><input checked class=hidden id=page-menu-switch-state type=checkbox><nav class="header__menu main-menu main-menu--with-page-menu" data-page-menu-switch-state-container role=navigation><div class=main-menu__header><a href=/> <picture class=logo><img alt="Bevy Engine" class=logo height=130 src=/assets/bevy_logo_dark.svg width=520></picture> </a><label class="button-square button-square--header" for=mobile-menu-state><img alt="A saltire or x-cross" height=16 src=/assets/icon-times.svg width=16></label></div><div class=main-menu__page-menu-switch><label class=menu-switch for=page-menu-switch-state><div class="menu-switch__option menu-switch__option--main-menu">Main Menu</div> <div class="menu-switch__option menu-switch__option--page-menu">Post</div></label></div><div class=main-menu__content><div class=main-menu__page-menu><ul class=tree-menu data-highlight-intrapage-link><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#skeletal-animation>Skeletal Animation</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#gltf-animation-importing>GLTF Animation Importing</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#unlimited-point-lights>Unlimited* Point Lights</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#light-clustering-features-and-optimizations>Light Clustering Features and Optimizations</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#configurable-light-visibility>Configurable Light Visibility</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#compressed-gpu-textures>Compressed GPU Textures</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#render-to-texture>Render To Texture</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#bevy-native-compute-shaders>Bevy-Native Compute Shaders</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#flexible-mesh-vertex-layouts>Flexible Mesh Vertex Layouts</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#camera-marker-components>Camera Marker Components</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#ergonomic-system-ordering>Ergonomic System Ordering</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#default-shorthand>Default Shorthand</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#query-many>Query::many</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#paramsets>ParamSets</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#deref-derefmut-derives>Deref / DerefMut Derives</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#worldquery-derives>WorldQuery Derives</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#world-resource>World::resource</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#anyof-queries>AnyOf Queries</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#world-system-param>&World System Param</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#ecs-soundness-correctness-improvements>ECS Soundness / Correctness Improvements</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#audio-control>Audio Control</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#sprite-anchors>Sprite Anchors</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#eventloop-power-saving-modes>EventLoop Power Saving Modes</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#documentation-improvements>Documentation improvements</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#dev-docs>Dev Docs</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#website-improvements>Website Improvements</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#scene-viewer-tool>Scene Viewer Tool</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#support-bevy>Support Bevy</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#contributors>Contributors</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#full-change-log>Full Change Log</a></div></ul></div><ul class=main-menu__menu><li class="main-menu__entry main-menu__entry--getting-started"><a class=main-menu__link href=/learn/quick-start/getting-started/> <span>Getting Started</span> </a><li class=main-menu__entry><a class=main-menu__link href=/learn/> <span>Learn</span> </a><li class=main-menu__entry><a class="main-menu__link main-menu__link--active" href=/news/> <span>News</span> </a><li class=main-menu__entry><a class=main-menu__link href=/community/> <span>Community</span> </a><li class=main-menu__entry><a class=main-menu__link href=/foundation/> <span>Foundation</span> </a><li class=main-menu__entry><a class=main-menu__link href=/assets/> <span>Assets</span> </a><li class=main-menu__entry><a class=main-menu__link href=/examples/> <span>Examples</span> </a></ul></div></nav><div class=header__cta-container><a class="button button--pink header__cta" href=/donate>Donate <img alt="heart icon" class=button__icon height=512 src=/assets/heart.svg width=512> </a><a class="header__cta header__cta--github" href=https://github.com/bevyengine/bevy> <img alt="GitHub repo" height=96 src=/assets/github-mark-white.svg width=98> </a></div></div></header><main class=layout__content><div class=container><div class="page-with-menu page-with-menu--news"><div class="page-with-menu__menu-wrapper print:hidden"><div class=page-with-menu__menu><ul class=tree-menu data-highlight-intrapage-link><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#skeletal-animation>Skeletal Animation</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#gltf-animation-importing>GLTF Animation Importing</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#unlimited-point-lights>Unlimited* Point Lights</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#light-clustering-features-and-optimizations>Light Clustering Features and Optimizations</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#configurable-light-visibility>Configurable Light Visibility</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#compressed-gpu-textures>Compressed GPU Textures</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#render-to-texture>Render To Texture</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#bevy-native-compute-shaders>Bevy-Native Compute Shaders</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#flexible-mesh-vertex-layouts>Flexible Mesh Vertex Layouts</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#camera-marker-components>Camera Marker Components</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#ergonomic-system-ordering>Ergonomic System Ordering</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#default-shorthand>Default Shorthand</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#query-many>Query::many</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#paramsets>ParamSets</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#deref-derefmut-derives>Deref / DerefMut Derives</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#worldquery-derives>WorldQuery Derives</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#world-resource>World::resource</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#anyof-queries>AnyOf Queries</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#world-system-param>&World System Param</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#ecs-soundness-correctness-improvements>ECS Soundness / Correctness Improvements</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#audio-control>Audio Control</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#sprite-anchors>Sprite Anchors</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#eventloop-power-saving-modes>EventLoop Power Saving Modes</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#documentation-improvements>Documentation improvements</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#dev-docs>Dev Docs</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#website-improvements>Website Improvements</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#scene-viewer-tool>Scene Viewer Tool</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#support-bevy>Support Bevy</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#contributors>Contributors</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=https://bevy.org/news/bevy-0-7/#full-change-log>Full Change Log</a></div></ul></div></div><div class=page-with-menu__content><h1 class=news-title>Bevy 0.7</h1><h2 class=news-subtitle>Posted on April 15, 2022 by Carter Anderson <span class=news-social-links> ( <img alt="A silhouette of a figure with cat ears waving a tentacle, or Octocat: GitHub's mascot and logo" class=news-social-icon height=512 src=/assets/github_grey.svg width=496> <span class=media-content> <a class=news-social-link href=https://www.github.com/cart>@cart</a></span> <img alt="A triangle pointing right in a rounded rectangle; Youtube's logo" class=news-social-icon height=512 src=/assets/youtube_grey.svg width=576> <span class=media-content> <a class=news-social-link href=https://www.youtube.com/cartdev>cartdev</a> </span> ) </span></h2><div class="media-content news-content news-content__hero-image"><img alt="'Stylized mushrooms' scene by QumoDone rendered in Bevy. This scene is licensed under Creative Commons Attribution." style="aspect-ratio:auto 16/9" src=mushroom.png><div class=news-image-subtitle><a href=https://sketchfab.com/3d-models/stylized-mushrooms-9d22e02ce2a548959b1c4c4c1d546842>'Stylized mushrooms' scene by QumoDone rendered in Bevy. This scene is licensed under Creative Commons Attribution.</a></div></div><div class="media-content news-content"><p>Thanks to <strong>123</strong> contributors, <strong>349</strong> pull requests, and our <a href=https://github.com/sponsors/cart><strong>generous sponsors</strong></a>, I'm happy to announce the <strong>Bevy 0.7</strong> release on <a href=https://crates.io/crates/bevy>crates.io</a>!<p>For those who don't know, Bevy is a refreshingly simple data-driven game engine built in Rust. You can check out <a href=/learn/quick-start/introduction>The Quick Start Guide</a> to get started. Bevy is also free and open source forever! You can grab the full <a href=https://github.com/bevyengine/bevy>source code</a> on GitHub. Check out <a href=https://bevy.org/assets>Bevy Assets</a> for a collection of community-developed plugins, games, and learning resources.<p>To update an existing Bevy App or Plugin to <strong>Bevy 0.7</strong>, check out our <a href=/learn/migration-guides/0.6-0.7/>0.6 to 0.7 Migration Guide</a>.<p>As always, there are a <em>ton</em> of new features, bug fixes, and quality of life tweaks in this release, but here are some of the highlights:<ul><li>Skeletal animation and mesh skinning<li>GLTF animation importing<li>Unlimited* point lights in a scene<li>Improved clustered forward rendering: dynamic/adaptive clustering and faster, more accurate cluster assignment<li>Compressed texture support (KTX2 / DDS / .basis): load more textures in a scene, faster<li>Compute shader / pipeline specialization: Bevy's flexible shader system was ported to compute shaders, enabling hot reloading, shader defs, and shader imports<li>Render to texture: cameras can now be configured to render to a texture instead of a window<li>Flexible mesh vertex layouts in shaders<li>ECS improvements: Order systems using their names, Query::many_mut, use conflicting parameters in systems via ParamSets, WorldQuery derives<li>Documentation improvements: better examples, more doc tests and more coverage<li>More audio control: pause, volume, speed, and looping<li>Power usage options to enable only updating Bevy Apps when input occurs</ul><span id=continue-reading></span><h2 id=skeletal-animation>Skeletal Animation <a class=anchor-link href=#skeletal-animation>#</a></h2><div class=release-feature-authors>authors: @james7132, @mockersf, @lassade, @Looooong</div><p>Bevy finally supports 3D skeletal animation!<p><video controls loop><source src=skeletal_animation.mp4 type=video/mp4></video><div class=release-feature-authors style=font-size:1rem>Scene Credits: <a href=https://skfb.ly/6TsvL>Tanabata evening - Kyoto inspired city scene</a> by Mathias Tossens is licensed under <a href=http://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution</a>. Character model and animation are royalty free assets from Mixamo.</div><p>Skeletal animations can now be played, paused, scrubbed, looped, reversed, and speed controlled using the new <a href=https://docs.rs/bevy/0.7.0/bevy/animation/struct.AnimationPlayer.html><code>AnimationPlayer</code></a> component and <a href=https://docs.rs/bevy/0.7.0/bevy/animation/struct.AnimationClip.html><code>AnimationClip</code></a> asset:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Component</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Animations</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">dance</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-meta z-generic z-rust">Handle<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>AnimationClip<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">start_dancing</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span>Animations, <span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> AnimationPlayer<span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>animations<span class="z-punctuation z-separator z-rust">,</span> <span class="z-storage z-modifier z-rust">mut</span> animation_player</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">in</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        animation_player<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">play</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>animations<span class="z-punctuation z-accessor z-dot z-rust">.</span>dance<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">clone</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p><a href=https://docs.rs/bevy/0.7.0/bevy/animation/struct.AnimationPlayer.html><code>AnimationPlayer</code></a> can also be used to animate arbitrary <a href=https://docs.rs/bevy/0.7.0/bevy/transform/components/struct.Transform.html><code>Transform</code></a> components, not just skeletons!<p>This critical feature has been a long time coming, but we wanted to build it in a way that meshed nicely with the <a href=/news/bevy-0-6/#the-new-bevy-renderer>new Bevy renderer</a> and didn't just "hack things in". This builds on our new <a href=/news/bevy-0-7/#flexible-mesh-vertex-layouts>Flexible Mesh Vertex Layouts</a>, <a href=/news/bevy-0-6/#shader-imports>Shader Imports</a>, and <a href=/news/bevy-0-6/#materials>Material</a> systems, which ensures that this logic is flexible and reusable, even with non-standard meshes and custom render pipelines.<p>And we're just getting started! Multi-track animation blending and higher level animation state management should arrive in the very near future. Now is a great time to start contributing animation features to Bevy. We've smashed through most of the foundational technical hurdles and what remains is largely high level API design choices. We already have a couple of draft RFCs open in these areas: <a href=https://github.com/bevyengine/rfcs/pull/51>Animation Composition</a> and <a href=https://github.com/bevyengine/rfcs/pull/49>Animation Primitives</a>. Feel free to join the conversation!<h2 id=gltf-animation-importing>GLTF Animation Importing <a class=anchor-link href=#gltf-animation-importing>#</a></h2><div class=release-feature-authors>authors: @mockersf</div><p>Bevy's GLTF importer was extended to import GLTF animations into the new <a href=https://docs.rs/bevy/0.7.0/bevy/animation/struct.AnimationPlayer.html><code>AnimationPlayer</code></a> system. This supports both "skeletal animation" and arbitrary transform animations:<p><video controls loop><source src=fox.mp4 type=video/mp4></video><pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">FoxAnimations</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">walk</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-meta z-generic z-rust">Handle<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>AnimationClip<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">setup</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">commands</span><span class="z-punctuation z-separator z-rust">:</span> Commands</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn_scene</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>asset_server<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">load</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>models/animated/Fox.glb#Scene0<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">insert_resource</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>FoxAnimations <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">        walk<span class="z-punctuation z-separator z-rust">:</span> asset_server<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">load</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>models/animated/Fox.glb#Animation0<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">play_on_load</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    <span class="z-variable z-parameter z-rust">animations</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>FoxAnimations<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    <span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">players</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> AnimationPlayer, <span class="z-meta z-generic z-rust">Added<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>AnimationPlayer<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> <span class="z-storage z-modifier z-rust">mut</span> player <span class="z-keyword z-operator z-rust">in</span> players<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        player<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">play</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>animations<span class="z-punctuation z-accessor z-dot z-rust">.</span>walk<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">clone</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">repeat</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><h2 id=unlimited-point-lights>Unlimited* Point Lights <a class=anchor-link href=#unlimited-point-lights>#</a></h2><div class=release-feature-authors>authors: Rob Swain (@superdump), @robtfm</div><p>Bevy can now render scenes with arbitrary numbers of point lights on platforms that support storage buffers (which is basically everything but WebGL). In the last Bevy release (0.6) we added <a href=/news/bevy-0-6/#clustered-forward-rendering>Clustered Forward Rendering</a>, which is a rendering technique that optimizes each fragment's light calculation costs by assigning lights to sub-volumes of the visible volume, called "clusters". However in the interest of platform compatibility (WebGL), we initially limited ourselves to 256 lights because that is what fit in a uniform buffer binding.<p>In <strong>Bevy 0.7</strong>, we added the ability to automatically "upgrade" to using unbounded storage buffers for Clustered Forward Rendering on platforms that support them, enabling unlimited* point lights. There is an asterisk there because in practice this is limited by memory and hardware constraints.<h2 id=light-clustering-features-and-optimizations>Light Clustering Features and Optimizations <a class=anchor-link href=#light-clustering-features-and-optimizations>#</a></h2><div class=release-feature-authors>authors: Rob Swain (@superdump), @robtfm, @dataphract, @cart</div><p>With the upper limit of 256 point lights removed, the only limit on lights is what the hardware can support and bottlenecks in our algorithms. To increase the number of lights, we made a number of optimizations to our clustering algorithms.<ul><li><strong>Dynamic Light Clusters</strong> <ul><li>By default cluster x/y slices are now dynamically configured based on the lights in the scene, which can significantly increase performance in some scenes.<li>The clustering behavior is now also user-configurable as FixedZ (the new default dynamic x/y behavior, fixing the number of z slices), custom fixed x/y/z slice values, single-cluster, and "no clustering", giving you control when you know a certain cluster configuration will perform even better.<li>Additionally, in 0.6 the visible volume that is covered by all the clusters basically matched the full visible volume of the view frustum. This meant that if all the point lights were in the foreground, all the clusters beyond the lights were wasted space. In 0.7, it is possible to limit the far bound to be closer than the camera far bound, which means the lights can be spread across more clusters, which can significantly increase rendering performance.</ul><li><strong>Iterative Sphere Refinement</strong>: Bevy now uses the Just Cause 3 iterative sphere refinement approach to cluster assignment, which gives us a ~10% performance increase on some benchmarks and more accurate clustering (which can also improve render performance).<li><strong>Light Frustum Change Detection</strong>: We now use Bevy ECS's change detection feature to only recalculate the view frustum of lights that have changed.<li><strong>Cluster Assignment Optimizations</strong>: The cluster assignment data access patterns and data structures received a variety of tweaks that improved performance.</ul><p>Here is a video illustrating a progression from the old limit of 256 point lights to 25,000 point lights at 60fps!<p>(Note that the 25,000 lights example disables the debug light spheres to ensure that light calculations are the bottleneck)<p><video controls loop><source src=many_lights.mp4 type=video/mp4></video><p>And we have <a href=https://github.com/bevyengine/bevy/pull/4345>even more clustering optimizations</a> in the works!<h2 id=configurable-light-visibility>Configurable Light Visibility <a class=anchor-link href=#configurable-light-visibility>#</a></h2><div class=release-feature-authors>authors: @robtfm</div><p>Lights can now be turned on and off using Bevy's standard <a href=https://docs.rs/bevy/0.7.0/bevy/render/view/struct.Visibility.html><code>Visibility</code></a> component:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>PointLightBundle <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    visibility<span class="z-punctuation z-separator z-rust">:</span> Visibility <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        is_visible<span class="z-punctuation z-separator z-rust">:</span> <span class="z-constant z-language z-rust">false</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-operator z-range z-rust">..</span><span class="z-support z-function z-rust">default</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><h2 id=compressed-gpu-textures>Compressed GPU Textures <a class=anchor-link href=#compressed-gpu-textures>#</a></h2><div class=release-feature-authors>authors: Rob Swain (@superdump)</div><p>As scenes grow larger, so do their assets. Compressing these assets is a great way to save space. The Amazon Bistro scene featured below has well over 1GB of compressed textures.<p>PNG is a popular compressed format, but it must be decompressed before the GPU can use it. This can be a slow process for large scenes. Those textures are then used in their uncompressed form, taking up large quantities of limited memory. Compressed GPU textures can be used directly in their compressed format by the GPU and can be loaded without any additional processing. This reduces load times significantly. As they remain compressed, this also reduces RAM usage significantly.<p>The Bistro scene took a total of 12.9s to load with PNG textures, but only 1.5s with compressed textures - taking approximately a tenth of the load time! The total RAM usage was ~12GB with uncompressed textures, and 5GB with compressed textures, less than half!<p>The benefits don't stop there either - because the textures are compressed and can be used by the GPU in that format, reading from them uses less memory bandwidth, which can bring performance benefits. The Bistro scene gains about 10% in frame rate from using compressed textures.<p><img alt="bistro compressed" src=https://bevy.org/news/bevy-0-7/bistro_compressed.png><p>Another benefit is that mipmaps are supported, which makes for smoother, less noisy textures. Bevy currently doesn't have support for automatically generating mipmaps for uncompressed textures, so using compressed textures is a nice way to have mipmaps now!<p>In summary, Bevy now supports loading compressed textures from <code>.dds</code>, <code>.ktx2</code>, and <code>.basis</code> files. This includes support for the standard ASTC, BCn, and ETC2 formats, as well as 'universal' formats like ETC1S and UASTC that can be transcoded to the standard formats supported by specific systems at runtime. The glTF loader was also extended to support loading these formats.<p>These features can be enabled using the <code>dds</code>, <code>ktx2</code>, and <code>basis-universal</code> cargo features.<h2 id=render-to-texture>Render To Texture <a class=anchor-link href=#render-to-texture>#</a></h2><div class=release-feature-authors>authors: @HackerFoo</div><p>Bevy now has initial support for rendering to texture by configuring the <code>render_target</code> field on <code>Camera</code>. This enables scenarios such as mirrors, split screen, 2d UI in 3d space, portals, etc.<p><video controls loop><source src=render_to_texture.mp4 type=video/mp4></video><p>Note that the current implementation is relatively low level. It will generally require interacting with Bevy's Render Graph and defining new camera types. If you would like to use this feature now, the <a href=https://github.com/bevyengine/bevy/blob/main/examples/3d/render_to_texture.rs>render_to_texture example</a> illustrates the steps required. We have plans for <a href=https://github.com/bevyengine/bevy/discussions/4191>"high level render targets"</a> that will make rendering to textures possible in just a few lines of code. Stay tuned for details!<h2 id=bevy-native-compute-shaders>Bevy-Native Compute Shaders <a class=anchor-link href=#bevy-native-compute-shaders>#</a></h2><div class=release-feature-authors>authors: @Ku95</div><p>Bevy's flexible asset-driven shader system was ported to compute shaders/pipelines, enabling hot reloading, <a href=https://bevy.org/news/bevy-0-6/#shader-preprocessor>shader defs</a>, <a href=https://bevy.org/news/bevy-0-6/#shader-imports>shader imports</a>, and <a href=https://bevy.org/news/bevy-0-6/#pipeline-specialization>pipeline specialization</a> based on user-configurable keys:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-keyword z-operator z-rust">#</span>import <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>shaders/game_of_life_texture_bind_group.wgsl<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-support z-function z-rust">stage</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>compute</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-support z-function z-rust">workgroup_size</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">8</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">8</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">1</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">game_of_life_update</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span>[[builtin<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-variable z-parameter z-rust">global_invocation_id</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>]] <span class="z-variable z-parameter z-rust">invocation_id</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">vec3<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-storage z-type z-rust">u32</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> location <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-generic z-rust">vec2<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-storage z-type z-rust">i32</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-storage z-type z-rust">i32</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>invocation_id<span class="z-punctuation z-accessor z-dot z-rust">.</span>x</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-storage z-type z-rust">i32</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>invocation_id<span class="z-punctuation z-accessor z-dot z-rust">.</span>y</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> alive <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-support z-function z-rust">is_location_alive</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>location</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> shader defs are configurable at runtime, prompting new variants of the shader to be compiled
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-keyword z-operator z-rust">#</span>ifdef <span class="z-constant z-other z-rust">WRITE_OUTPUT</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    storageBarrier<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    textureStore<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>texture<span class="z-punctuation z-separator z-rust">,</span> location<span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-generic z-rust">vec4<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-storage z-type z-rust">f32</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-storage z-type z-rust">f32</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>alive</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-keyword z-operator z-rust">#</span>endif
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><h2 id=flexible-mesh-vertex-layouts>Flexible Mesh Vertex Layouts <a class=anchor-link href=#flexible-mesh-vertex-layouts>#</a></h2><div class=release-feature-authors>authors: @cart, @parasyte</div><p>In <strong>Bevy 0.7</strong>, it is now easy to make shaders support any Mesh vertex layout and arbitrary vertex attributes. Bevy's "shader pipeline specialization" system was extended to support "specializing on mesh vertex layouts".<p>For most Bevy users, this means that <a href=/news/bevy-0-6/#materials>Materials</a>, including the built in <a href=https://docs.rs/bevy/0.7.0/bevy/pbr/struct.StandardMaterial.html><code>StandardMaterial</code></a> and custom shader materials now support arbitrary Meshes automatically, provided those Meshes have the vertex attributes required by the material shaders. It also means that if your Mesh is missing any attribute required by its material, rendering can fail gracefully.<p>We also made use of this system to implement joint weights and indices for our new <a href=/news/bevy-0-7/#skeletal-animation>Skeletal Animation</a> implementation.<p>For Bevy users that like to write lower level graphics pipelines, this feature makes it possible to easily and efficiently specialize your pipelines according to Mesh vertex layouts:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-storage z-type z-impl z-rust">impl</span> </span><span class="z-meta z-impl z-rust">SpecializedMeshPipeline <span class="z-keyword z-other z-rust">for</span></span><span class="z-meta z-impl z-rust"> <span class="z-entity z-name z-impl z-rust">SomeCustomPipeline</span> </span><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-type z-rust">type</span> <span class="z-entity z-name z-type z-rust">Key</span> <span class="z-keyword z-operator z-assignment z-rust">=</span> SomeCustomKey<span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">specialize</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">        <span class="z-keyword z-operator z-rust">&</span><span class="z-variable z-parameter z-rust">self</span>,
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">        <span class="z-variable z-parameter z-rust">key</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-path z-rust"><span class="z-storage z-type z-rust"><span class="z-storage z-type z-rust">Self</span><span class="z-punctuation z-accessor z-rust">::</span></span></span>Key,
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">        <span class="z-variable z-parameter z-rust">layout</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span>MeshVertexBufferLayout,
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    </span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-></span> <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Result</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>RenderPipelineDescriptor, SpecializedMeshPipelineError<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> this is a layout that matches the requirements requested,
</span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> but catered to whatever mesh is currently being rendered
</span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-storage z-type z-rust">let</span> vertex_buffer_layout <span class="z-keyword z-operator z-assignment z-rust">=</span> layout<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get_layout</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-bitwise z-rust">&</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">            <span class="z-meta z-path z-rust">Mesh<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">ATTRIBUTE_POSITION</span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">at_shader_location</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">0</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">            <span class="z-meta z-path z-rust">Mesh<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">ATTRIBUTE_NORMAL</span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">at_shader_location</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">1</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">            <span class="z-meta z-path z-rust">Mesh<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">ATTRIBUTE_UV_0</span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">at_shader_location</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">2</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">        <span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-keyword z-operator z-rust">?</span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-support z-type z-rust">Ok</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>RenderPipelineDescriptor <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">            vertex<span class="z-punctuation z-separator z-rust">:</span> VertexState <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                buffers<span class="z-punctuation z-separator z-rust">:</span> <span class="z-support z-macro z-rust">vec!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>vertex_buffer_layout<span class="z-punctuation z-section z-group z-end z-rust">]</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                <span class="z-comment z-block z-rust"><span class="z-punctuation z-definition z-comment z-rust">/*</span> define the rest of the vertex state here <span class="z-punctuation z-definition z-comment z-rust">*/</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">            </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">            <span class="z-comment z-block z-rust"><span class="z-punctuation z-definition z-comment z-rust">/*</span> define the rest of the mesh pipeline here <span class="z-punctuation z-definition z-comment z-rust">*/</span></span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">        </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></span></span></code></pre><h2 id=camera-marker-components>Camera Marker Components <a class=anchor-link href=#camera-marker-components>#</a></h2><div class=release-feature-authors>authors: @jakobhellermann</div><p>In <strong>Bevy 0.7</strong>, Cameras now use the "marker component" pattern to determine the "camera type" (ex: 3D, 2D, UI), rather than using string names.<p>This means that it is now cheaper and easier to select cameras of a specific type:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">move_3d_camera_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">transforms</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> Transform, <span class="z-meta z-generic z-rust">With<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Camera3d<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> <span class="z-storage z-modifier z-rust">mut</span> camera <span class="z-keyword z-operator z-rust">in</span> transforms<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> move camera here
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><h2 id=ergonomic-system-ordering>Ergonomic System Ordering <a class=anchor-link href=#ergonomic-system-ordering>#</a></h2><div class=release-feature-authors>authors: @cart, @aevyrie, @alice-i-cecile, @DJMcNab</div><p>Bevy uses "labels" to define ordering constraints between its ECS systems when they run in parallel. In previous versions of Bevy, the only way to order systems was to define custom labels:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">SystemLabel<span class="z-punctuation z-separator z-rust">,</span> Clone<span class="z-punctuation z-separator z-rust">,</span> Hash<span class="z-punctuation z-separator z-rust">,</span> Debug<span class="z-punctuation z-separator z-rust">,</span> PartialEq<span class="z-punctuation z-separator z-rust">,</span> Eq</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">UpdateVelocity</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust">app
</span><span class="z-source z-rust">  <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>update_velocity<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">label</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>UpdateVelocity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">  <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>movement<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">after</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>UpdateVelocity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre><p>In <strong>Bevy 0.7</strong>, manually defining labels is no longer required. You can order systems using functions, just like you do when adding systems!<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">app
</span><span class="z-source z-rust">  <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>update_velocity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">  <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>movement<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">after</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>update_velocity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre><p>This is accomplished by "auto-labeling" systems with their <a href=https://doc.rust-lang.org/std/any/struct.TypeId.html><code>TypeId</code></a> (the label type is <a href=https://docs.rs/bevy/0.7.0/bevy/ecs/system/struct.SystemTypeIdLabel.html><code>SystemTypeIdLabel</code></a>). Internally ordering still uses labels.<p>The Bevy ECS labeling system is powerful and there are still legitimate use cases for custom labels (such as labeling multiple systems with the same label and exporting a stable public API as a plugin author). But most common use cases can take advantage of the ergonomic auto-labeling functionality.<h2 id=default-shorthand>Default Shorthand <a class=anchor-link href=#default-shorthand>#</a></h2><div class=release-feature-authors>authors: @cart</div><p>Bevy makes heavy use of Rust's <a href=https://doc.rust-lang.org/book/ch05-01-defining-structs.html#creating-instances-from-other-instances-with-struct-update-syntax>struct update pattern</a> in combination with the <code>Default</code> trait when initializing entities. This significantly reduces the amount of typing required by enabling developers to only fill in the fields they want to change.<p>The standard way of doing this is to write out <code>..Default::default()</code>:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn_bundle</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>SpriteBundle <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    texture<span class="z-punctuation z-separator z-rust">:</span> some_texture<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-operator z-range z-rust">..</span><span class="z-support z-type z-rust">Default</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre><p>This is much better than filling in each field's component manually:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>SpriteBundle <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    texture<span class="z-punctuation z-separator z-rust">:</span> some_texture<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    sprite<span class="z-punctuation z-separator z-rust">:</span> <span class="z-support z-type z-rust">Default</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    transform<span class="z-punctuation z-separator z-rust">:</span> <span class="z-support z-type z-rust">Default</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    global_transform<span class="z-punctuation z-separator z-rust">:</span> <span class="z-support z-type z-rust">Default</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    visibility<span class="z-punctuation z-separator z-rust">:</span> <span class="z-support z-type z-rust">Default</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>However this can feel repetitive when you're doing it for tens or hundreds of entities. We added a way to make this even easier, without needing to resort to macros:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn_bundle</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>SpriteBundle <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    texture<span class="z-punctuation z-separator z-rust">:</span> some_texture<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-operator z-range z-rust">..</span><span class="z-support z-function z-rust">default</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre><p>This is equivalent in functionality to <code>..Default::default()</code>, it's just more compressed. And you can still use the longer form if you prefer. The <code>default()</code> function is included in Bevy's prelude, so you don't need to manually import it. Ergonomics for the win!<h2 id=query-many>Query::many <a class=anchor-link href=#query-many>#</a></h2><div class=release-feature-authors>authors: @alice-i-cecile</div><p>Bevy ECS solves a hard problem: providing easy and fast access to data in parallel while still respecting Rust's strict mutability and ownership rules. Since our first release, we've supported efficiently accessing specific entities in our ECS Queries:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">SomeEntities</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">a</span><span class="z-punctuation z-separator z-type z-rust">:</span> Entity,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">b</span><span class="z-punctuation z-separator z-type z-rust">:</span> Entity,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> Transform<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>, <span class="z-variable z-parameter z-rust">entities</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>SomeEntities<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> a_transform <span class="z-keyword z-operator z-assignment z-rust">=</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>entities<span class="z-punctuation z-accessor z-dot z-rust">.</span>a</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>However, to respect Rust's mutability rules, we need to disallow APIs that might produce "aliased mutability". Seasoned Bevy users will probably recognize this Rust borrow checker error:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> Transform<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>, <span class="z-variable z-parameter z-rust">entities</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>SomeEntities<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> a_transform <span class="z-keyword z-operator z-assignment z-rust">=</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>entities<span class="z-punctuation z-accessor z-dot z-rust">.</span>a</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> This line fails to compile because `query` is already mutably borrowed above
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> b_transform <span class="z-keyword z-operator z-assignment z-rust">=</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>entities<span class="z-punctuation z-accessor z-dot z-rust">.</span>b</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p><em>You</em> know Entity A and Entity B are different entities at runtime. But Rust's borrow checker has no way to know that at compile time! I'm sure you can imagine game development scenarios that would benefit from having mutable access to multiple components at the same time. This borrow checker restriction was a common pain point and the workarounds were ... not fun (using scopes to ensure conflicting accesses are dropped, copying data, re-querying things, etc).<p>Fortunately, <strong>Bevy 0.7</strong> introduces a brand new set of APIs to save the day!<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> Transform<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>, <span class="z-variable z-parameter z-rust">entities</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>SomeEntities<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Takes an array of entities and returns an array of mutable Query results
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> This will panic if there are entity conflicts or the entities do not exist
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>a_transform<span class="z-punctuation z-separator z-rust">,</span> b_transform<span class="z-punctuation z-section z-group z-end z-rust">]</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">many_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>entities<span class="z-punctuation z-accessor z-dot z-rust">.</span>a<span class="z-punctuation z-separator z-rust">,</span> entities<span class="z-punctuation z-accessor z-dot z-rust">.</span>b<span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>There are plenty of variants:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Same as many_mut, but returns a Result instead of panicking
</span></span><span class="z-source z-rust"><span class="z-keyword z-control z-rust">if</span> <span class="z-storage z-type z-rust">let</span> <span class="z-support z-type z-rust">Ok</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>a_transform<span class="z-punctuation z-separator z-rust">,</span> b_transform<span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get_many_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>entities<span class="z-punctuation z-accessor z-dot z-rust">.</span>a<span class="z-punctuation z-separator z-rust">,</span> entities<span class="z-punctuation z-accessor z-dot z-rust">.</span>b<span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> There are also immutable/read-only variants
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>a_transform<span class="z-punctuation z-separator z-rust">,</span> b_transform<span class="z-punctuation z-section z-group z-end z-rust">]</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">many</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>entities<span class="z-punctuation z-accessor z-dot z-rust">.</span>a<span class="z-punctuation z-separator z-rust">,</span> entities<span class="z-punctuation z-accessor z-dot z-rust">.</span>b<span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-keyword z-control z-rust">if</span> <span class="z-storage z-type z-rust">let</span> <span class="z-support z-type z-rust">Ok</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>a_transform<span class="z-punctuation z-separator z-rust">,</span> b_transform<span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get_many</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>entities<span class="z-punctuation z-accessor z-dot z-rust">.</span>a<span class="z-punctuation z-separator z-rust">,</span> entities<span class="z-punctuation z-accessor z-dot z-rust">.</span>b<span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></code></pre><p>And they all support arbitrary numbers of entities:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>a<span class="z-punctuation z-separator z-rust">,</span> b<span class="z-punctuation z-separator z-rust">,</span> c<span class="z-punctuation z-section z-group z-end z-rust">]</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">many</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>entity_a<span class="z-punctuation z-separator z-rust">,</span> entity_b<span class="z-punctuation z-separator z-rust">,</span> entity_c<span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><h2 id=paramsets>ParamSets <a class=anchor-link href=#paramsets>#</a></h2><div class=release-feature-authors>authors: @bilsen</div><p>To prevent aliased mutability, Bevy ECS disallows systems that have parameters that conflict with each other. For example, if two Queries both request write access to the same component in the same "archetype", that could result in aliased mutable access, so Bevy disallows that system and errors out.<p>Previous versions of Bevy supported conflicting Queries in the same system using QuerySets, which only allow access to one Query in the set at a time:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> These queries could each return a mutable A component for the same entity, so they must be put in a set to be considered a valid system. 
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">set</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">QuerySet<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-generic z-rust">QueryState<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> A, <span class="z-keyword z-operator z-rust">&</span>B<span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>, <span class="z-meta z-generic z-rust">QueryState<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> A, <span class="z-keyword z-operator z-rust">&</span>C<span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>a<span class="z-punctuation z-separator z-rust">,</span> b</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">in</span> set<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">q0</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p><strong>Bevy 0.7</strong> removes <code>QuerySet</code> in favor of <code>ParamSet</code>, which generalizes the QuerySet pattern for <em>any</em> system parameter:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">set</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">ParamSet<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> A, <span class="z-keyword z-operator z-rust">&</span>B<span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>, <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> A, <span class="z-keyword z-operator z-rust">&</span>C<span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>a<span class="z-punctuation z-separator z-rust">,</span> b</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">in</span> set<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">p0</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>But ParamSets aren't just limited to Queries! Consider this example, where the <code>EventWriter&LTJump></code> parameter (which internally accesses the <code>Events&LTJump></code> resource) conflicts with the raw access to that resource. Previously, expressing this wouldn't be possible. But with ParamSets, it is!<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">set</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">ParamSet<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-generic z-rust">EventWriter<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Jump<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>, <span class="z-meta z-generic z-rust">ResMut<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-meta z-generic z-rust">Events<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Jump<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> jump_event <span class="z-keyword z-operator z-rust">in</span> set<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">p1</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">drain</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>We still recommend avoiding ParamSets where possible for clarity's sake. But every so often they are a necessary and useful tool!<h2 id=deref-derefmut-derives>Deref / DerefMut Derives <a class=anchor-link href=#deref-derefmut-derives>#</a></h2><div class=release-feature-authors>authors: @MrGVSV</div><p>Rust encourages the use of the <a href=https://doc.rust-lang.org/rust-by-example/generics/new_types.html>newtype pattern</a> when expanding a type with new functionality or meaning. This is also a useful tool in Bevy:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Component</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Items</span></span><span class="z-meta z-struct z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Vec</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Item<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">give_sword</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> Items<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> 
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> <span class="z-storage z-modifier z-rust">mut</span> items <span class="z-keyword z-operator z-rust">in</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        items<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-support z-function z-rust">push</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">Item<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>Flaming Poisoning Raging Sword of Doom<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>This works just fine, but that <code>0</code> at the end of <code>items.0</code> sticks out like a sore thumb. Many of us in the Bevy Org think <code>.0</code> has no place in public APIs. But the newtype pattern is still useful! Ideally, Rust would provide a way to express that <code>Items</code> is a new type, while transparently provided access to the <code>Vec&LTItem></code> stored within. There are designs being discussed by the Rust team, but we don't want to wait for nice things!<p>Fortunately, the Deref / DerefMut traits in std provide the behavior we want. Users can already manually implement these traits, but for such a common pattern, we decided that providing our own trait derives was worth it. In <strong>Bevy 0.7</strong>, you can now derive Deref and DerefMut, enabling much nicer public APIs:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Component<span class="z-punctuation z-separator z-rust">,</span> Deref<span class="z-punctuation z-separator z-rust">,</span> DerefMut</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Items</span></span><span class="z-meta z-struct z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Vec</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Item<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">give_sword</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> Items<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> 
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> <span class="z-storage z-modifier z-rust">mut</span> items <span class="z-keyword z-operator z-rust">in</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> No more .0!
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        items<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">push</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">Item<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>Flaming Poisoning Raging Sword of Doom<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>Astute <code>std</code> doc readers might notice that the Rust team <a href=https://doc.rust-lang.org/std/ops/trait.Deref.html>recommends only using <code>Deref</code>/<code>DerefMut</code> for smart pointers, to avoid confusion</a>. Components like <code>Items</code> are <em>not</em> smart pointers. We choose to ignore this advice, as this pattern works, is already widely used in the Rust ecosystem, and Good UX Comes First.<h2 id=worldquery-derives>WorldQuery Derives <a class=anchor-link href=#worldquery-derives>#</a></h2><div class=release-feature-authors>authors: @mvlabat</div><p>Sometimes when building Bevy Apps you might find yourself repeating the same sets of components over and over in your queries:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">move_players</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">players</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> Transform, <span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> Velocity, <span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> PlayerStats<span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>transform<span class="z-punctuation z-separator z-rust">,</span> velocity<span class="z-punctuation z-separator z-rust">,</span> stats</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">in</span> players<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">player_gravity</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">players</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span>Entity, <span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> Transform, <span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> Velocity, <span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> PlayerStats<span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>entity<span class="z-punctuation z-separator z-rust">,</span> transform<span class="z-punctuation z-separator z-rust">,</span> velocity<span class="z-punctuation z-separator z-rust">,</span> stats</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">in</span> players<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>Maybe you've gotten tired of typing the same components over and over. In <strong>Bevy 0.7</strong>, you can now easily create your own custom <a href=http://docs.rs/bevy/0.7.0/bevy/ecs/query/trait.WorldQuery.html><code>WorldQuery</code></a> trait implementations with the <a href=http://docs.rs/bevy/0.7.0/bevy/ecs/query/trait.WorldQuery.html><code>WorldQuery</code></a> derive:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">WorldQuery</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">world_query</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">mutable</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-generic z-rust"><span class="z-entity z-name z-struct z-rust">PlayerMovementQuery</span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-storage z-modifier z-lifetime z-rust">'w</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span></span><span class="z-meta z-struct z-rust"> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">transform</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-lifetime z-rust">'w</span> <span class="z-storage z-modifier z-rust">mut</span> Transform,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">velocity</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-lifetime z-rust">'w</span> <span class="z-storage z-modifier z-rust">mut</span> Velocity,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">stats</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-lifetime z-rust">'w</span> <span class="z-storage z-modifier z-rust">mut</span> PlayerStats,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">move_players</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">players</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>PlayerMovementQuery<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> player <span class="z-keyword z-operator z-rust">in</span> players<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">player_gravity</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">players</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span>Entity, PlayerMovementQuery<span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>entity<span class="z-punctuation z-separator z-rust">,</span> player</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">in</span> players<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><h2 id=world-resource>World::resource <a class=anchor-link href=#world-resource>#</a></h2><div class=release-feature-authors>authors: @alice-i-cecile</div><p>We've noticed that the majority of direct <a href=https://docs.rs/bevy/0.7.0/bevy/ecs/world/struct.World.html><code>World</code></a> resource access immediately unwraps the results of <code>get_resource</code>:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> time <span class="z-keyword z-operator z-assignment z-rust">=</span> world<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">get_resource<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Time<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>In <strong>Bevy 0.7</strong> we added an ergonomic variant that internally panics:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> time <span class="z-keyword z-operator z-assignment z-rust">=</span> world<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">resource<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Time<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>There is also a mutable variant:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> <span class="z-storage z-modifier z-rust">mut</span> time <span class="z-keyword z-operator z-assignment z-rust">=</span> world<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">resource_mut<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Time<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>The <code>get_resource</code> variants are still available for cases where users still want to manually handle the returned <code>Option</code>.<h2 id=anyof-queries>AnyOf Queries <a class=anchor-link href=#anyof-queries>#</a></h2><div class=release-feature-authors>authors: @TheRawMeatball</div><p>Bevy ECS Queries now support <a href=http://docs.rs/bevy/0.7.0/bevy/ecs/query/struct.AnyOf.html><code>AnyOf</code></a>, which will return results for entities that match "any of" the given component queries:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-meta z-generic z-rust">AnyOf<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span>A, <span class="z-keyword z-operator z-rust">&</span>B<span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">for</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>a<span class="z-punctuation z-separator z-rust">,</span> b</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">in</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Either A or B is guaranteed to be Some
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-support z-macro z-rust">assert!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>a<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">is_some</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-logical z-rust">||</span> b<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">is_some</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>For the example above <a href=http://docs.rs/bevy/0.7.0/bevy/ecs/query/struct.AnyOf.html><code>AnyOf</code></a> will return entities that have A and not B, B and not A, and both A and B.<h2 id=world-system-param>&World System Param <a class=anchor-link href=#world-system-param>#</a></h2><div class=release-feature-authors>authors: @bilsen</div><p>It is now possible for "normal systems" have <code>&World</code> system params, which provide full read-only access to the entire <a href=https://docs.rs/bevy/0.7.0/bevy/ecs/world/struct.World.html><code>World</code></a>:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">world</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span>World, <span class="z-variable z-parameter z-rust">transforms</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span>Transform<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>Just keep in mind that <code>&World</code> will conflict with <em>any</em> mutable Query:<div class=incorrect><div class=incorrect-image><img alt="This code is invalid" title="This code is invalid" height=82 src=/assets/error_icon.svg width=82></div><pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">invalid_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">world</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span>World, <span class="z-variable z-parameter z-rust">transforms</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> Transform<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre></div><p>In these cases, consider using our new <a href=/news/bevy-0-7/#paramsets>ParamSets</a> to resolve the conflict:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">valid_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">set</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">ParamSet<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span>World, <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> Transform<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><h2 id=ecs-soundness-correctness-improvements>ECS Soundness / Correctness Improvements <a class=anchor-link href=#ecs-soundness-correctness-improvements>#</a></h2><div class=release-feature-authors>authors: @BoxyUwU, @TheRawMeatball, @bjorn3</div><p>Bevy ECS received a solid number of soundness and correctness bug fixes this release:<ul><li>Removed unsound lifetime annotations on <code>EntityMut</code> and <code>Query</code>, which could be used to get aliased mutability in some situations.<li>Labeled <code>World::entities_mut</code> unsafe (because manually modifying entity metadata can invalidate safety assumptions)<li>Removed unsound <code>World::components_mut</code> (which allowed replacing component metadata, invalidating assumptions made elsewhere in World)<li>Fixed a <code>World::resource_scope</code> soundness bug<li>Used <code>ManuallyDrop</code> in resource id initialization instead of <code>forget()</code> to avoid invalidating a data pointer before it is used.</ul><p>We now also run the <a href=https://github.com/rust-lang/miri>miri</a> interpreter on Bevy ECS in our CI to help detect and prevent future soundness / correctness issues.<p>As Bevy ECS matures, our bar for unsafe code blocks and soundness must also mature. Bevy ECS will probably never be 100% free of unsafe code blocks because we are modeling parallel data access that Rust cannot reason about without our help. But we are committed to removing as much unsafe code as we can and improving the quality and scope of our unsafe code.<h2 id=audio-control>Audio Control <a class=anchor-link href=#audio-control>#</a></h2><div class=release-feature-authors>authors: @mockersf</div><p>Bevy's audio system has been in a ... minimalist state since our first release. Until now, it only supported pressing "play" on audio assets. Third party plugins such as <a href=https://github.com/NiklasEi/bevy_kira_audio>bevy_kira_audio</a> have filled in the gaps with much more flexible audio solutions.<p>In <strong>Bevy 0.7</strong> we've started expanding what our built in audio plugin can do. It is now possible to pause, adjust volume, and set playback speed using <a href=http://docs.rs/bevy/0.7.0/bevy/audio/struct.AudioSink.html><code>AudioSink</code></a> assets.<p>Playing audio now returns a <code>Handle&LTAudioSink></code> which can be used to play/pause/set_speed/set_volume:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">BeautifulMusic</span></span><span class="z-meta z-struct z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-generic z-rust">Handle<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>AudioSink<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">setup_audio</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    <span class="z-variable z-parameter z-rust">asset_server</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>AssetServer<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    <span class="z-variable z-parameter z-rust">audio</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Audio<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    <span class="z-variable z-parameter z-rust">audio_sinks</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-meta z-generic z-rust">Assets<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>AudioSink<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> music <span class="z-keyword z-operator z-assignment z-rust">=</span> asset_server<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">load</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>BeautifulMusic.ogg<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> play audio and upgrade to a strong handle
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> sink_handle <span class="z-keyword z-operator z-assignment z-rust">=</span> audio_sinks<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get_handle</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>audio<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">play</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>music</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">insert_resource</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>BeautifulMusic<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>sink_handle</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> later in another system
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">adjust_audio</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">music</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>BeautifulMusic<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>, <span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">audio_sinks</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">ResMut<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-meta z-generic z-rust">Assets<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>AudioSink<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">if</span> <span class="z-storage z-type z-rust">let</span> <span class="z-support z-type z-rust">Some</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>sink</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> audio_sinks<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>music<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-constant z-numeric z-integer z-decimal z-rust">0</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> pause playback
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        sink<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">pause</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> start playback again
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        sink<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">play</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> increase the volume
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        sink<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">set_volume</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>sink<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">volume</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-arithmetic z-rust">+</span> <span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">1</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> slow down playback
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        sink<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">set_speed</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">5</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>You can also now loop audio playback:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">audio<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">play_with_settings</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>music<span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">PlaybackSettings<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">LOOP</span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_volume</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">75</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>We plan to continue iterating on these APIs with even more functionality and usability improvements!<h2 id=sprite-anchors>Sprite Anchors <a class=anchor-link href=#sprite-anchors>#</a></h2><div class=release-feature-authors>authors: @mockersf</div><p><a href=https://docs.rs/bevy/0.7.0/bevy/sprite/enum.Sprite.html><code>Sprite</code></a> components can now define an <a href=https://docs.rs/bevy/0.7.0/bevy/sprite/enum.Anchor.html><code>Anchor</code></a> point (also known as a "pivot" point), which determines the "origin" of the sprite. Sprites still default to a "center" origin, but this is now configurable:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn_bundle</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>SpriteBundle <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    texture<span class="z-punctuation z-separator z-rust">:</span> asset_server<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">load</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>bevy_logo.png<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    sprite<span class="z-punctuation z-separator z-rust">:</span> Sprite <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        anchor<span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-path z-rust">Anchor<span class="z-punctuation z-accessor z-rust">::</span></span>TopRight<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-keyword z-operator z-range z-rust">..</span><span class="z-support z-function z-rust">default</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-operator z-range z-rust">..</span><span class="z-support z-function z-rust">default</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p><video controls loop><source src=pivot.mp4 type=video/mp4></video><h2 id=eventloop-power-saving-modes>EventLoop Power Saving Modes <a class=anchor-link href=#eventloop-power-saving-modes>#</a></h2><div class=release-feature-authors>authors: @aevyrie</div><p>By default Bevy will run updates "as fast as it can" (limited by the screen's refresh rate). This is great for most games, but some application types (such as GUI apps) need to prioritize CPU and GPU power usage.<p><strong>Bevy 0.7</strong> adds the ability to configure the [<code>UpdateMode</code>] in [<code>WinitConfig</code>] to configure how Bevy Apps run updates:<ul><li><strong>Continuous</strong>: always update "as soon as possible" (honoring vsync configuration)<li><strong>Reactive</strong>: only update when there is a window event, a redraw is requested, or a configurable wait time has elapsed<li><strong>ReactiveLowPower</strong>: only update when there is user input (mouse movement, keyboard input, etc), a redraw is requested, or a configurable wait time has elapsed</ul><p>These settings can be configured separately for focused windows and unfocused windows (enabling you to save power when a window loses focus).<p><strong>ReactiveLowPower</strong> can <em>significantly</em> reduce power / resource usage, but it won't be suitable for every app type, as some apps need to assume that they are constantly being updated as quickly as possible. Therefore these settings are opt-in.<p>This app demos the various modes available. Note that Game mode was configured to lower its tick rate when it loses focus, which is not the default:<p><video controls loop><source src=power_settings.mp4 type=video/mp4></video><h2 id=documentation-improvements>Documentation improvements <a class=anchor-link href=#documentation-improvements>#</a></h2><div class=release-feature-authors>authors: @alice-i-cecile and many more</div><p>Great docs make learning, using and building Bevy better. But as a young engine, they're still a work-in-progress.<h3 id=deny-missing-docs>deny-missing-docs <a class=anchor-link href=#deny-missing-docs>#</a></h3><p>Our docs team (led by <code>@alice-i-cecile</code>) has started to <a href=https://github.com/bevyengine/bevy/issues/3492>systematically fix that</a>, with the help of Rust's <code>#[warn(missing_docs)]</code> lint. Since 0.6, we've fully documented (and prevented doc-regressions for):<ul><li><code>bevy_tasks</code> by <code>@james7132</code><li><code>bevy_app</code> by <code>@dbearden</code><li><code>bevy_dylib</code> by <code>@KDecay</code><li><code>bevy_internal</code> by <code>@sheepyhead</code></ul><p>There have been <a href="https://github.com/bevyengine/bevy/pulls?q=is%3Apr+is%3Aclosed+label%3AC-Docs">many other doc improvements</a> over this time period as well, including the addition of many helpful <a href=https://doc.rust-lang.org/rustdoc/documentation-tests.html>doc tests</a>, and our bar for docs in new code continues to rise. A huge thanks to everyone making Bevy's docs better.<h3 id=new-contributors>New contributors <a class=anchor-link href=#new-contributors>#</a></h3><p>If you're <a href=https://github.com/bevyengine/bevy/blob/main/CONTRIBUTING.md>interested in contributing</a>, the docs team is always ready to help new contributors get their first Bevy PR merged ASAP. There have been a <em>ton</em> of new contributors who've helped out with docs, either as a writer or a reviewer. If this is you: thanks!<h3 id=better-examples>Better examples <a class=anchor-link href=#better-examples>#</a></h3><p>For many people, the best way to learn a tool is to see it in action. We've been steadily polishing our <a href=https://github.com/bevyengine/bevy/tree/latest/examples>examples</a> with better explanations, more coverage, and higher code quality. If you're new to Bevy, check out the much-improved <a href=https://github.com/bevyengine/bevy/blob/latest/examples/games/breakout.rs>Breakout example</a>!<h2 id=dev-docs>Dev Docs <a class=anchor-link href=#dev-docs>#</a></h2><div class=release-feature-authors>authors: @james7132, @mockersf, @aevyrie</div><p>We now automatically deploy Bevy's <code>main</code> development branch to <a href=https://dev-docs.bevy.org>https://dev-docs.bevy.org</a> whenever a change is merged. This will help Bevy documentation authors easily validate their changes. And "bleeding edge" Bevy users can learn about API changes we're working on.<p><img alt="dev docs" src=https://bevy.org/news/bevy-0-7/dev_docs.png><h2 id=website-improvements>Website Improvements <a class=anchor-link href=#website-improvements>#</a></h2><div class=release-feature-authors>authors: @doup</div><p>The Bevy Book now has a much nicer pager widget that displays previous / next section names:<p><img alt=pager src=https://bevy.org/news/bevy-0-7/pager.png><p>We also added an "improve this page" footer link to make it easier for Bevy Book readers to contribute changes.<p>The sidebar got an overhaul that improves clarity and makes it possible to open/close sections without clicking on them:<p><img alt=sidebar src=https://bevy.org/news/bevy-0-7/sidebar.png><p>The responsiveness of the website has also been improved and some sections layout much better on mobile.<h2 id=scene-viewer-tool>Scene Viewer Tool <a class=anchor-link href=#scene-viewer-tool>#</a></h2><div class=release-feature-authors>authors: Rob Swain (@superdump), @mockersf, @IceSentry, @jakobhellermann</div><p>Bevy now has a dedicated scene viewer tool that can load arbitrary GLTF scene files. If you check out the main Bevy repo you can try it out by running:<pre class="language-sh z-code" data-lang=sh><code class=language-sh data-lang=sh><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">cargo</span></span><span class="z-meta z-function-call z-arguments z-shell"> run<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>release</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>example</span> scene_viewer /some/path/castle.gltf</span>
</span></code></pre><p>It has a built in "fly camera" and has tools to play animations and toggle lights and shadows.<p><img alt="scene viewer" src=https://bevy.org/news/bevy-0-7/bevy_scene_viewer.png><h2 id=support-bevy>Support Bevy <a class=anchor-link href=#support-bevy>#</a></h2><p>Sponsorships help make my full time work on Bevy sustainable. If you believe in Bevy's mission, consider sponsoring me (@cart) ... every bit helps!<p><a class="button button--pink header__cta" href=https://github.com/sponsors/cart>Donate <img alt="heart icon" class=button__icon src=/assets/heart.svg></a><h2 id=contributors>Contributors <a class=anchor-link href=#contributors>#</a></h2><p>A huge thanks to the <strong>123 contributors</strong> that made this release (and associated docs) possible! In random order:<ul><li>@mfdorst<li>@devjobe<li>@PrototypeNM1<li>@devil-ira<li>@IsseW<li>@SuperSamus<li>@alice-i-cecile<li>@bilsen<li>@CooCooCaCha<li>@lufog<li>@chescock<li>@dbearden<li>@doup<li>@MiniaczQ<li>@C-BJ<li>@TedDriggs<li>@idanarye<li>@plof27<li>@robtfm<li>@ickk<li>@rsk700<li>@dataphract<li>@Looooong<li>@mdickopp<li>@bjorn3<li>@aloucks<li>@EpsilonDelphine<li>@rparrett<li>@CptPotato<li>@horvbalint<li>@jakobhellermann<li>@light4<li>@Lindenk<li>@rib<li>@ItsDoot<li>@KDecay<li>@p3rsik<li>@danieleades<li>@parasyte<li>@Sorck<li>@chenzhekl<li>@jch-13<li>@SecretPocketCat<li>@DJMcNab<li>@jak6jak<li>@ShadowCurse<li>@MrGVSV<li>@NiklasEi<li>@ZainlessBrombie<li>@lwansbrough<li>@ramon-bernardo<li>@aevyrie<li>@OptimisticPeach<li>@bitshifter<li>@glfmn<li>@rezural<li>@joshuataylor<li>@nakedible<li>@GarettCooper<li>@rand0m-cloud<li>@kirusfg<li>@oceantume<li>@l4desu-mizu<li>@fgiordana-netflix<li>@sarkahn<li>@Weasy666<li>@bytemuck<li>@james7132<li>@sseemayer<li>@pubrrr<li>@Sliman4<li>@geckoxx<li>@Bobox214<li>@mirkoRainer<li>@Veykril<li>@Gingeh<li>@pocket7878<li>@cart<li>@infmagic2047<li>@MinerSebas<li>@ramirezmike<li>@cjglo<li>@Sheepyhead<li>@L-french<li>@JoJoJet<li>@Wcubed<li>@Shatur<li>@reinismu<li>@boguscoder<li>@tversteeg<li>@TheRawMeatball<li>@mcobzarenco<li>@ezekg<li>@hlb8122<li>@B-Janson<li>@emersonmx<li>@mvlabat<li>@Nilirad<li>@jamesbeilby<li>@ryo33<li>@cdbfoster<li>@blaind<li>@fgiordana<li>@josh65536<li>@CleanCut<li>@tornewuff<li>@Ku95<li>@kcking<li>@luke-biel<li>@SUPERCILEX<li>@BoxyUwU<li>@TheAndrewJackson<li>@HackerFoo<li>@andresovela<li>@IceSentry<li>@RedlineTriad<li>@killercup<li>@Azorlogh<li>@superdump<li>@nebkor<li>@mockersf<li>@Gordon-F<li>@Jupp56</ul><h2 id=full-change-log>Full Change Log <a class=anchor-link href=#full-change-log>#</a></h2><h3 id=added>Added <a class=anchor-link href=#added>#</a></h3><ul><li><a href=https://github.com/bevyengine/bevy/pull/4238>Mesh Skinning</a><li><a href=https://github.com/bevyengine/bevy/pull/4375>Animation Player</a><li><a href=https://github.com/bevyengine/bevy/pull/3751>Gltf animations</a><li><a href=https://github.com/bevyengine/bevy/pull/3959>Mesh vertex buffer layouts</a><li><a href=https://github.com/bevyengine/bevy/pull/3412>Render to a texture</a><li><a href=https://github.com/bevyengine/bevy/pull/3884>KTX2/DDS/.basis compressed texture support</a><li><a href=https://github.com/bevyengine/bevy/pull/3948>Audio control - play, pause, volume, speed, loop</a><li><a href=https://github.com/bevyengine/bevy/pull/4224>Auto-label function systems with SystemTypeIdLabel</a><li><a href=https://github.com/bevyengine/bevy/pull/4298>Query::get_many</a><li><a href=https://github.com/bevyengine/bevy/pull/3968>Dynamic light clusters</a><li><a href=https://github.com/bevyengine/bevy/pull/4169>Always update clusters and remove per-frame allocations</a><li><a href=https://github.com/bevyengine/bevy/pull/2765><code>ParamSet</code> for conflicting <code>SystemParam</code>:s</a><li><a href=https://github.com/bevyengine/bevy/pull/4071>default() shorthand</a><li><a href=https://github.com/bevyengine/bevy/pull/3635>use marker components for cameras instead of name strings</a><li><a href=https://github.com/bevyengine/bevy/pull/2713>Implement <code>WorldQuery</code> derive macro</a><li><a href=https://github.com/bevyengine/bevy/pull/2889>Implement AnyOf queries</a><li><a href=https://github.com/bevyengine/bevy/pull/3979>Compute Pipeline Specialization</a><li><a href=https://github.com/bevyengine/bevy/pull/4047>Make get_resource (and friends) infallible</a><li><a href=https://github.com/bevyengine/bevy/pull/4433>bevy_pbr: Support flipping tangent space normal map y for DirectX normal maps</a><li><a href=https://github.com/bevyengine/bevy/pull/4181>Faster view frustum culling</a><li><a href=https://github.com/bevyengine/bevy/pull/3989>Use storage buffers for clustered forward point lights</a><li><a href=https://github.com/bevyengine/bevy/pull/2923>Add &World as SystemParam</a><li><a href=https://github.com/bevyengine/bevy/pull/4347>Add text wrapping support to Text2d</a><li><a href=https://github.com/bevyengine/bevy/pull/4183>Scene Viewer to display glTF files</a><li><a href=https://github.com/bevyengine/bevy/pull/3966>Internal Asset Hot Reloading</a><li><a href=https://github.com/bevyengine/bevy/pull/3952>Add FocusPolicy to NodeBundle and ImageBundle</a><li><a href=https://github.com/bevyengine/bevy/pull/3656>Allow iter combinations on queries with filters</a><li><a href=https://github.com/bevyengine/bevy/pull/3912>bevy_render: Support overriding wgpu features and limits</a><li><a href=https://github.com/bevyengine/bevy/pull/3931>bevy_render: Use RenderDevice to get limits/features and expose AdapterInfo</a><li><a href=https://github.com/bevyengine/bevy/pull/3974>Reduce power usage with configurable event loop</a><li><a href=https://github.com/bevyengine/bevy/pull/3463>can specify an anchor for a sprite</a><li><a href=https://github.com/bevyengine/bevy/pull/2969>Implement len and is_empty for EventReaders</a><li><a href=https://github.com/bevyengine/bevy/pull/3945>Add more FromWorld implementations</a><li><a href=https://github.com/bevyengine/bevy/pull/4225>Add cart's fork of ecs_bench_suite</a><li><a href=https://github.com/bevyengine/bevy/pull/4328>bevy_derive: Add derives for <code>Deref</code> and <code>DerefMut</code></a><li><a href=https://github.com/bevyengine/bevy/pull/3941>Add clear_schedule</a><li><a href=https://github.com/bevyengine/bevy/pull/3090>Add Query::contains</a><li><a href=https://github.com/bevyengine/bevy/pull/3048>bevy_render: Support removal of nodes, edges, subgraphs</a><li><a href=https://github.com/bevyengine/bevy/pull/3079>Implement init_resource for <code>Commands</code> and <code>World</code></a><li><a href=https://github.com/bevyengine/bevy/pull/3328>Added method to restart the current state</a><li><a href=https://github.com/bevyengine/bevy/pull/2935>Simplify sending empty events</a><li><a href=https://github.com/bevyengine/bevy/pull/2996>impl Command for &LTimpl FnOnce(&mut World)></a><li><a href=https://github.com/bevyengine/bevy/pull/3739>Useful error message when two assets have the save UUID</a><li><a href=https://github.com/bevyengine/bevy/pull/3643>bevy_asset: Add AssetServerSettings watch_for_changes member</a><li><a href=https://github.com/bevyengine/bevy/pull/4088>Add conversio from Color to u32</a><li><a href=https://github.com/bevyengine/bevy/pull/3917>Introduce <code>SystemLabel</code>'s for <code>RenderAssetPlugin</code>, and change <code>Image</code> preparation system to run before others</a><li><a href=https://github.com/bevyengine/bevy/pull/4079>Add a helper for storage buffers similar to <code>UniformVec</code></a><li><a href=https://github.com/bevyengine/bevy/pull/3982>StandardMaterial: expose a cull_mode option</a><li><a href=https://github.com/bevyengine/bevy/pull/4056>Expose draw indirect</a><li><a href=https://github.com/bevyengine/bevy/pull/3885>Add view transform to view uniform</a><li><a href=https://github.com/bevyengine/bevy/pull/3696>Add a size method on Image.</a><li><a href=https://github.com/bevyengine/bevy/pull/3958>add Visibility for lights</a><li><a href=https://github.com/bevyengine/bevy/pull/3711>bevy_render: Provide a way to opt-out of the built-in frustum culling</a><li><a href=https://github.com/bevyengine/bevy/pull/3675>use error scope to handle errors on shader module creation</a><li><a href=https://github.com/bevyengine/bevy/pull/3724>include sources in shader validation error</a><li><a href=https://github.com/bevyengine/bevy/pull/4119>insert the gltf mesh name on the entity if there is one</a><li><a href=https://github.com/bevyengine/bevy/pull/2154>expose extras from gltf nodes</a><li><a href=https://github.com/bevyengine/bevy/pull/4396>gltf: add a name to nodes without names</a><li><a href=https://github.com/bevyengine/bevy/pull/3772>Enable drag-and-drop events on windows</a><li><a href=https://github.com/bevyengine/bevy/pull/4170>Add transform hierarchy stress test</a><li><a href=https://github.com/bevyengine/bevy/pull/3054>Add TransformBundle</a><li><a href=https://github.com/bevyengine/bevy/pull/3107>Add Transform::rotate_around method</a><li><a href=https://github.com/bevyengine/bevy/pull/4399>example on how to create an animation in code</a><li><a href=https://github.com/bevyengine/bevy/pull/2441>Add examples for Transforms</a><li><a href=https://github.com/bevyengine/bevy/pull/4114>Add mouse grab example</a><li><a href=https://github.com/bevyengine/bevy/pull/4063>examples: add screenspace texture shader example</a><li><a href=https://github.com/bevyengine/bevy/pull/2636>Add generic systems example</a><li><a href=https://github.com/bevyengine/bevy/pull/2915>add examples on how to have a data source running in another thread / in a task pool thread</a><li><a href=https://github.com/bevyengine/bevy/pull/3065>Simple 2d rotation example</a><li><a href=https://github.com/bevyengine/bevy/pull/2414>Add move sprite example.</a><li><a href=https://github.com/bevyengine/bevy/pull/2960>add an example using UI & states to create a game menu</a><li><a href=https://github.com/bevyengine/bevy/pull/4310>CI runs <code>cargo miri test -p bevy_ecs</code></a><li><a href=https://github.com/bevyengine/bevy/pull/4182>Tracy spans around main 3D passes</a><li><a href=https://github.com/bevyengine/bevy/pull/3535>Add automatic docs deployment to GitHub Pages</a></ul><h3 id=changed>Changed <a class=anchor-link href=#changed>#</a></h3><ul><li><a href=https://github.com/bevyengine/bevy/pull/3963>Proper prehashing</a><li><a href=https://github.com/bevyengine/bevy/pull/3976>Move import_path definitions into shader source</a><li><a href=https://github.com/bevyengine/bevy/pull/4115>Make <code>System</code> responsible for updating its own archetypes</a><li><a href=https://github.com/bevyengine/bevy/pull/3923>Some small changes related to run criteria piping</a><li><a href=https://github.com/bevyengine/bevy/pull/4340>Remove unnecessary system labels</a><li><a href=https://github.com/bevyengine/bevy/pull/2382>Increment last event count on next instead of iter</a><li><a href=https://github.com/bevyengine/bevy/pull/3817>Obviate the need for <code>RunSystem</code>, and remove it</a><li><a href=https://github.com/bevyengine/bevy/pull/2982>Cleanup some things which shouldn't be components</a><li><a href=https://github.com/bevyengine/bevy/pull/3633>Remove the config API</a><li><a href=https://github.com/bevyengine/bevy/pull/3302>Deprecate <code>.system</code></a><li><a href=https://github.com/bevyengine/bevy/pull/4250>Hide docs for concrete impls of Fetch, FetchState, and SystemParamState</a><li><a href=https://github.com/bevyengine/bevy/pull/2434>Move the CoreStage::Startup to a seperate StartupSchedule label</a><li><a href=https://github.com/bevyengine/bevy/pull/3565><code>iter_mut</code> on Assets: send modified event only when asset is iterated over</a><li><a href=https://github.com/bevyengine/bevy/pull/3560>check if resource for asset already exists before adding it</a><li><a href=https://github.com/bevyengine/bevy/pull/4179>bevy_render: Batch insertion for prepare_uniform_components</a><li><a href=https://github.com/bevyengine/bevy/pull/3981>Change default <code>ColorMaterial</code> color to white</a><li><a href=https://github.com/bevyengine/bevy/pull/3803>bevy_render: Only auto-disable mappable primary buffers for discrete GPUs</a><li><a href=https://github.com/bevyengine/bevy/pull/3698>bevy_render: Do not automatically enable MAPPABLE_PRIMARY_BUFFERS</a><li><a href=https://github.com/bevyengine/bevy/pull/4435>increase the maximum number of point lights with shadows to the max supported by the device</a><li><a href=https://github.com/bevyengine/bevy/pull/4086>perf: only recalculate frusta of changed lights</a><li><a href=https://github.com/bevyengine/bevy/pull/3984>bevy_pbr: Optimize assign_lights_to_clusters</a><li><a href=https://github.com/bevyengine/bevy/pull/3930>improve error messages for render graph runner</a><li><a href=https://github.com/bevyengine/bevy/pull/4428>Skinned extraction speedup</a><li><a href=https://github.com/bevyengine/bevy/pull/4361>Sprites - keep color as 4 f32</a><li><a href=https://github.com/bevyengine/bevy/pull/4055>Change scaling mode to FixedHorizontal</a><li><a href=https://github.com/bevyengine/bevy/pull/3812>Replace VSync with PresentMode</a><li><a href=https://github.com/bevyengine/bevy/pull/3617>do not set cursor grab on window creation if not asked for</a><li><a href=https://github.com/bevyengine/bevy/pull/4180>bevy_transform: Use Changed in the query for much faster transform_propagate_system</a><li><a href=https://github.com/bevyengine/bevy/pull/4168>Split bevy_hierarchy out from bevy_transform</a><li><a href=https://github.com/bevyengine/bevy/pull/3045>Make transform builder methods const</a><li><a href=https://github.com/bevyengine/bevy/pull/4126>many_cubes: Add a cube pattern suitable for benchmarking culling changes</a><li><a href=https://github.com/bevyengine/bevy/pull/4015>Make many_cubes example more interesting</a><li><a href=https://github.com/bevyengine/bevy/pull/3849>Run tests (including doc tests) in <code>cargo run -p ci</code> command</a><li><a href=https://github.com/bevyengine/bevy/pull/4246>Use more ergonomic span syntax</a></ul><h3 id=fixed>Fixed <a class=anchor-link href=#fixed>#</a></h3><ul><li><a href=https://github.com/bevyengine/bevy/pull/4096>Remove unsound lifetime annotations on <code>EntityMut</code></a><li><a href=https://github.com/bevyengine/bevy/pull/4243>Remove unsound lifetime annotations on <code>Query</code> methods</a><li><a href=https://github.com/bevyengine/bevy/pull/4092>Remove <code>World::components_mut</code></a><li><a href=https://github.com/bevyengine/bevy/pull/4093>unsafeify <code>World::entities_mut</code></a><li><a href=https://github.com/bevyengine/bevy/pull/2947>Use ManuallyDrop instead of forget in insert_resource_with_id</a><li><a href=https://github.com/bevyengine/bevy/pull/3685>Backport soundness fix</a><li><a href=https://github.com/bevyengine/bevy/pull/4194>Fix clicked UI nodes getting reset when hovering child nodes</a><li><a href=https://github.com/bevyengine/bevy/pull/3926>Fix ui interactions when cursor disappears suddenly</a><li><a href=https://github.com/bevyengine/bevy/pull/3785>Fix node update</a><li><a href=https://github.com/bevyengine/bevy/pull/4400>Fix derive(SystemParam) macro</a><li><a href=https://github.com/bevyengine/bevy/pull/2838>SystemParam Derive fixes</a><li><a href=https://github.com/bevyengine/bevy/pull/4427>Do not crash if RenderDevice doesn't exist</a><li><a href=https://github.com/bevyengine/bevy/pull/4383>Fixed case of R == G, following original conversion formula</a><li><a href=https://github.com/bevyengine/bevy/pull/4035>Fixed the frustum-sphere collision and added tests</a><li><a href=https://github.com/bevyengine/bevy/pull/3741>bevy_render: Fix Quad flip</a><li><a href=https://github.com/bevyengine/bevy/pull/3795>Fix HDR asset support</a><li><a href=https://github.com/bevyengine/bevy/pull/4148>fix cluster tiling calculations</a><li><a href=https://github.com/bevyengine/bevy/pull/3697>bevy_pbr: Do not panic when more than 256 point lights are added the scene</a><li><a href=https://github.com/bevyengine/bevy/pull/3916>fix issues with too many point lights</a><li><a href=https://github.com/bevyengine/bevy/pull/4012>shader preprocessor - do not import if scope is not valid</a><li><a href=https://github.com/bevyengine/bevy/pull/3603>support all line endings in shader preprocessor</a><li><a href=https://github.com/bevyengine/bevy/pull/4367>Fix animation: shadow and wireframe support</a><li><a href=https://github.com/bevyengine/bevy/pull/4417>add AnimationPlayer component only on scene roots that are also animation roots</a><li><a href=https://github.com/bevyengine/bevy/pull/4376>Fix loading non-TriangleList meshes without normals in gltf loader</a><li><a href=https://github.com/bevyengine/bevy/pull/4270>gltf-loader: disable backface culling if material is double-sided</a><li><a href=https://github.com/bevyengine/bevy/pull/4006>Fix glTF perspective camera projection</a><li><a href=https://github.com/bevyengine/bevy/pull/3811>fix mul_vec3 transformation order: should be scale -> rotate -> translate</a></ul></div><script type=module>import{enable_image_compare as a}from"/components.js";document.addEventListener(`DOMContentLoaded`,(()=>{a()}))</script></div></div></div></main><footer class=print:hidden><div class=footer__social-container><a class=footer__social href=https://github.com/bevyengine/bevy title=GitHub> <img alt="GitHub logo" height=24 src=/assets/github-mark-white.svg width=24> </a><a class=footer__social href=https://discord.gg/bevy title=Discord> <img alt="Discord logo" height=24 src=/assets/discord.svg width=24> </a><a class=footer__social href=https://bsky.app/profile/bevy.org title=Bluesky> <img alt="Bluesky logo" height=24 src=/assets/bluesky.svg width=24> </a><a class=footer__social href=https://mastodon.social/@bevy title=Mastodon> <img alt="Mastodon logo" height=24 src=/assets/mastodon-logo-purple.svg width=24> </a><a class=footer__social href=https://www.reddit.com/r/bevy/ title=Reddit> <img alt="Reddit logo" height=24 src=/assets/reddit.svg width=24> </a><a class=footer__social href=https://itch.io/games/tag-bevy title=itch.io> <img alt="itch.io logo" height=24 src=/assets/itchio-textless.svg width=24> </a><a title="Bevy news feed" class=footer__social href=/atom.xml> <img alt="Bevy news feed" height=24 src=/assets/feed.svg width=24> </a></div></footer></div><script>const search_params=new URLSearchParams(window.location.search);if(search_params.has(`show_drafts`)||document.cookie.indexOf(`show_drafts`)>=0){let a=`show_drafts`;if(search_params.get(a)===`0`){document.cookie=`show_drafts=;path=/;expires=Thu, 01 Jan 1970 00:00:00 UTC`}else{document.cookie=`show_drafts=1;path=/`;document.body.classList.add(a)}}</script>