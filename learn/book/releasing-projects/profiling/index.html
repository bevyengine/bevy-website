<!doctype html><html class=light-mode lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Bevy Book: Profiling" property=og:title><meta content=website property=og:type><meta content=https://bevy.org//learn/book/releasing-projects/profiling/ property=og:url><meta content=https://bevy.org/assets/bevy_logo_fill.png property=og:image><meta content="Bevy is a refreshingly simple data-driven game engine built in Rust. It is free and open-source forever!" property=og:description><link rel="shortcut icon" href=/assets/favicon.png type=image/png><link href=/site.css rel=stylesheet><link href=/atom.xml rel=alternate type=application/atom+xml><title>Bevy Book: Profiling</title><script src=/optional-helpers.js></script><script defer src=/highlight-intrapage-link.js></script><body><div class=layout><input class=hidden id=mobile-menu-state type=checkbox><header class="layout__header header print:hidden" data-mobile-menu-state-container><div class=header__content><label class=main-menu-backdrop for=mobile-menu-state></label><label class="header__hamburger button-square button-square--header" for=mobile-menu-state><img alt="Three horizontal lines stacked on top of eachother" height=16 src=/assets/icon-hamburger.svg width=20></label><div class=header__left-block><a class=header__logo href=/> <picture class=logo><img alt="Bevy logo" class=logo height=130 src=/assets/bevy_logo_dark.svg width=520></picture> </a><div class=header__message>The Book</div></div><input checked class=hidden id=page-menu-switch-state type=checkbox><nav class="header__menu main-menu main-menu--with-page-menu" data-page-menu-switch-state-container role=navigation><div class=main-menu__header><a href=/> <picture class=logo><img alt="Bevy Engine" class=logo height=130 src=/assets/bevy_logo_dark.svg width=520></picture> </a><label class="button-square button-square--header" for=mobile-menu-state><img alt="A saltire or x-cross" height=16 src=/assets/icon-times.svg width=16></label></div><div class=main-menu__page-menu-switch><label class=menu-switch for=page-menu-switch-state><div class="menu-switch__option menu-switch__option--main-menu">Main Menu</div> <div class="menu-switch__option menu-switch__option--page-menu">The Book</div></label></div><div class=main-menu__content><div class=main-menu__page-menu><ul class=tree-menu><input class=tree-menu__state id=mobile-menu-learn-book-intro type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/intro/>Introduction</a><label class=tree-menu__toggle for=mobile-menu-learn-book-intro><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/what-is-bevy/>What is Bevy?</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/the-three-letters/>The E, the C, and the S</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/the-next-three-letters/>Resources, Queries, and Commands</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/apps-worlds/>Apps and Worlds</a></div></ul></li><input class=tree-menu__state id=mobile-menu-learn-book-storing-data type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/storing-data/>Storing Data</a><label class=tree-menu__toggle for=mobile-menu-learn-book-storing-data><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/entities-components/>Entities Have Components</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/required-components/>Required Components</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/world/>The World</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/queries/>Queries</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/resources/>Resources</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/relations/>Relations</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/local-system-param/>System-Local Data Storage</a></div></ul></li><input class=tree-menu__state id=mobile-menu-learn-book-control-flow type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/control-flow/>Control Flow</a><label class=tree-menu__toggle for=mobile-menu-learn-book-control-flow><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/systems/>Systems</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/run-conditions/>Skipping systems</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/states/>States</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/commands/>Commands</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/handling-errors/>Handling Errors</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/change-detection/>Change Detection</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/events/>Events</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/observers/>Observers</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/hooks/>Hooks</a></div></ul></li><input class=tree-menu__state id=mobile-menu-learn-book-the-game-loop type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/the-game-loop/>The Game Loop</a><label class=tree-menu__toggle for=mobile-menu-learn-book-the-game-loop><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/app/>App</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/schedules/>Schedules</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/rendering-frames/>Rendering frames</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/input-and-windowing/>Input and windowing</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/time-and-timers/>Time and Timers</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/custom-loops/>Custom Loops</a></div></ul></li><input class=tree-menu__state id=mobile-menu-learn-book-modular-architecture type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/modular-architecture/>Modular Architecture</a><label class=tree-menu__toggle for=mobile-menu-learn-book-modular-architecture><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/modular-architecture/plugins/>Plugins</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/modular-architecture/project-organization/>Project Organization</a></div></ul></li><input class=tree-menu__state id=mobile-menu-learn-book-development-practices type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/development-practices/>Development Practices</a><label class=tree-menu__toggle for=mobile-menu-learn-book-development-practices><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/fast-compiles/>Fast Compiles</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/hot-reloading/>Hot Reloading Code and Assets</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/debugging/>Debugging</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/testing/>Testing Bevy apps</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/linting/>Linting</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/dev-tools/>Dev tools</a></div></ul></li><input checked class=tree-menu__state id=mobile-menu-learn-book-releasing-projects type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/releasing-projects/>Releasing Projects</a><label class=tree-menu__toggle for=mobile-menu-learn-book-releasing-projects><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class="tree-menu__item tree-menu__item--active"><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/profiling/>Profiling</a><nav aria-label="On This Page" class="on-this-page tree-menu__toc" data-highlight-intrapage-link><ul><li><a href=#cpu-runtime>CPU runtime</a> <ul><li><a href=#overview>Overview</a><li><a href=#adding-your-own-spans>Adding your own spans</a><li><a href=#tracy-profiler>Tracy profiler</a><li><a href=#chrome-tracing-format>Chrome tracing format</a><li><a href=#perf-flame-graph>perf Flame Graph</a></ul><li><a href=#gpu-runtime>GPU runtime</a> <ul><li><a href=#vendor-tools>Vendor tools</a><li><a href=#tracy-renderqueue>Tracy RenderQueue</a></ul><li><a href=#compile-time>Compile time</a> <ul><li><a href=#general-advice>General advice</a><li><a href=#cargo-timings>Cargo timings</a><li><a href=#rustc-self-profile>rustc self-profile</a><li><a href=#cargo-llvm-lines>cargo-llvm-lines</a><li><a href=#cargo-bloat>cargo-bloat</a></ul></ul></nav></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/optimizing-performance/>Optimizing Performance</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/optimizing-binary-size/>Optimizing Binary Size</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/libraries-for-bevy/>Creating libraries for Bevy</a></div></ul></ul></div><ul class=main-menu__menu><li class="main-menu__entry main-menu__entry--getting-started"><a class=main-menu__link href=/learn/quick-start/getting-started/> <span>Getting Started</span> </a><li class=main-menu__entry><a class="main-menu__link main-menu__link--active" href=/learn/> <span>Learn</span> </a><li class=main-menu__entry><a class=main-menu__link href=/news/> <span>News</span> </a><li class=main-menu__entry><a class=main-menu__link href=/community/> <span>Community</span> </a><li class=main-menu__entry><a class=main-menu__link href=/foundation/> <span>Foundation</span> </a><li class=main-menu__entry><a class=main-menu__link href=/assets/> <span>Assets</span> </a><li class=main-menu__entry><a class=main-menu__link href=/examples/> <span>Examples</span> </a></ul></div></nav><div class=header__cta-container><a class="button button--pink header__cta" href=/donate>Donate <img alt="heart icon" class=button__icon height=512 src=/assets/heart.svg width=512> </a><a class="header__cta header__cta--github" href=https://github.com/bevyengine/bevy> <img alt="GitHub repo" height=96 src=/assets/github-mark-white.svg width=98> </a></div></div></header><main class=layout__content><div class=container><h1 class=warning>This page is hidden because an ancestor is hidden</h1><div class=page-with-menu><div class="page-with-menu__menu-wrapper print:hidden"><div class=page-with-menu__menu><ul class=tree-menu><input class=tree-menu__state id=page-menu-learn-book-intro type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/intro/>Introduction</a><label class=tree-menu__toggle for=page-menu-learn-book-intro><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/what-is-bevy/>What is Bevy?</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/the-three-letters/>The E, the C, and the S</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/the-next-three-letters/>Resources, Queries, and Commands</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/apps-worlds/>Apps and Worlds</a></div></ul></li><input class=tree-menu__state id=page-menu-learn-book-storing-data type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/storing-data/>Storing Data</a><label class=tree-menu__toggle for=page-menu-learn-book-storing-data><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/entities-components/>Entities Have Components</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/required-components/>Required Components</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/world/>The World</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/queries/>Queries</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/resources/>Resources</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/relations/>Relations</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/local-system-param/>System-Local Data Storage</a></div></ul></li><input class=tree-menu__state id=page-menu-learn-book-control-flow type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/control-flow/>Control Flow</a><label class=tree-menu__toggle for=page-menu-learn-book-control-flow><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/systems/>Systems</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/run-conditions/>Skipping systems</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/states/>States</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/commands/>Commands</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/handling-errors/>Handling Errors</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/change-detection/>Change Detection</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/events/>Events</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/observers/>Observers</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/hooks/>Hooks</a></div></ul></li><input class=tree-menu__state id=page-menu-learn-book-the-game-loop type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/the-game-loop/>The Game Loop</a><label class=tree-menu__toggle for=page-menu-learn-book-the-game-loop><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/app/>App</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/schedules/>Schedules</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/rendering-frames/>Rendering frames</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/input-and-windowing/>Input and windowing</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/time-and-timers/>Time and Timers</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/custom-loops/>Custom Loops</a></div></ul></li><input class=tree-menu__state id=page-menu-learn-book-modular-architecture type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/modular-architecture/>Modular Architecture</a><label class=tree-menu__toggle for=page-menu-learn-book-modular-architecture><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/modular-architecture/plugins/>Plugins</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/modular-architecture/project-organization/>Project Organization</a></div></ul></li><input class=tree-menu__state id=page-menu-learn-book-development-practices type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/development-practices/>Development Practices</a><label class=tree-menu__toggle for=page-menu-learn-book-development-practices><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/fast-compiles/>Fast Compiles</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/hot-reloading/>Hot Reloading Code and Assets</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/debugging/>Debugging</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/testing/>Testing Bevy apps</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/linting/>Linting</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/dev-tools/>Dev tools</a></div></ul></li><input checked class=tree-menu__state id=page-menu-learn-book-releasing-projects type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/releasing-projects/>Releasing Projects</a><label class=tree-menu__toggle for=page-menu-learn-book-releasing-projects><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class="tree-menu__item tree-menu__item--active"><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/profiling/>Profiling</a><nav aria-label="On This Page" class="on-this-page tree-menu__toc" data-highlight-intrapage-link><ul><li><a href=#cpu-runtime>CPU runtime</a> <ul><li><a href=#overview>Overview</a><li><a href=#adding-your-own-spans>Adding your own spans</a><li><a href=#tracy-profiler>Tracy profiler</a><li><a href=#chrome-tracing-format>Chrome tracing format</a><li><a href=#perf-flame-graph>perf Flame Graph</a></ul><li><a href=#gpu-runtime>GPU runtime</a> <ul><li><a href=#vendor-tools>Vendor tools</a><li><a href=#tracy-renderqueue>Tracy RenderQueue</a></ul><li><a href=#compile-time>Compile time</a> <ul><li><a href=#general-advice>General advice</a><li><a href=#cargo-timings>Cargo timings</a><li><a href=#rustc-self-profile>rustc self-profile</a><li><a href=#cargo-llvm-lines>cargo-llvm-lines</a><li><a href=#cargo-bloat>cargo-bloat</a></ul></ul></nav></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/optimizing-performance/>Optimizing Performance</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/optimizing-binary-size/>Optimizing Binary Size</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/libraries-for-bevy/>Creating libraries for Bevy</a></div></ul></ul></div></div><div class=page-with-menu__content><div class=docs-page><div class=docs-content><h1>Profiling</h1><div class=media-content><h2 id=cpu-runtime>CPU runtime <a class=anchor-link href=#cpu-runtime>#</a></h2><h3 id=overview>Overview <a class=anchor-link href=#overview>#</a></h3><p>Bevy has built-in <a href=https://github.com/tokio-rs/tracing>tracing</a> spans to make it cheap and easy to profile Bevy ECS systems, render logic, engine internals, and user app code. Enable the <code>trace</code> cargo feature to enable Bevy's built-in spans.<p>If you also want to include <code>wgpu</code> tracing spans when profiling, they are emitted at the <code>tracing</code> <code>info</code> level so you will need to make sure they are not filtered out by the <code>LogSettings</code> resource's <code>filter</code> member which defaults to <code>wgpu=error</code>. You can do this by setting the <code>RUST_LOG=info</code> environment variable when running your application.<p>You also need to select a <code>tracing</code> backend using one of the cargo features described in the below sections.<blockquote><p>[!NOTE] When your app is bottlenecked by the GPU, you may encounter frames that have multiple prepare-set systems all taking an unusually long time to complete, and all finishing at about the same time.<p>See the section on GPU profiling for determining what GPU work is the bottleneck.<p>You can find more details in the docs for <a href=https://docs.rs/bevy/latest/bevy/render/view/fn.prepare_windows.html><code>prepare_windows</code></a>.</blockquote><p><img alt="prepare_windows span bug" src=https://github.com/bevyengine/bevy/assets/2771466/15c0819b-0e07-4665-aa1e-579caa24fece><h3 id=adding-your-own-spans>Adding your own spans <a class=anchor-link href=#adding-your-own-spans>#</a></h3><p>Add spans to your app like this (these are in <code>bevy::prelude::*</code> and <code>bevy::log::*</code>, just like the normal logging macros).<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">  <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> creates a span and starts the timer
</span></span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">  <span class="z-storage z-type z-rust">let</span> my_span <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-support z-macro z-rust">info_span!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>span_name<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span><span class="z-punctuation z-separator z-rust">,</span> name <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>span_name<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">entered</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">  <span class="z-support z-function z-rust">do_something_here</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span> <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> my_span is dropped here ... this stops the timer
</span></span><span class="z-source z-rust">
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> You can also "manually" enter the span if you need more control over when the timer starts
</span></span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Prefer the previous, simpler syntax unless you need the extra control.
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> my_span <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-support z-macro z-rust">info_span!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>span_name<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span><span class="z-punctuation z-separator z-rust">,</span> name <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>span_name<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">  <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> starts the span's timer
</span></span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">  <span class="z-storage z-type z-rust">let</span> guard <span class="z-keyword z-operator z-assignment z-rust">=</span> my_span<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">enter</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">  <span class="z-support z-function z-rust">do_something_here</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span> <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> guard is dropped here ... this stops the timer
</span></span></code></pre><p>Search for <code>info_span!</code> in this repo for some real-world examples.<p>For more details, check out the <a href=https://docs.rs/tracing/*/tracing/span/index.html>tracing span docs</a>.<h3 id=tracy-profiler>Tracy profiler <a class=anchor-link href=#tracy-profiler>#</a></h3><p>The <a href=https://github.com/wolfpld/tracy>Tracy profiling tool</a> is:<blockquote><p>A real time, nanosecond resolution, remote telemetry, hybrid frame and sampling profiler for games and other applications.</blockquote><p>There are binaries available for Windows, and installation / build instructions for other operating systems can be found in the <a href=https://github.com/wolfpld/tracy/releases/latest/download/tracy.pdf>Tracy documentation PDF</a>.<p>It has a command line capture tool that can record the execution of graphical applications, saving it as a profile file. Tracy has a GUI to inspect these profile files. The GUI app also supports live capture, showing you in real time the trace of your app. The version of tracy must be matched to the version of tracing-tracy used in bevy. A compatibility table can be found on <a href=https://crates.io/crates/tracing-tracy>crates.io</a> and the version used can be found <a href=https://github.com/bevyengine/bevy/blob/latest/crates/bevy_log/Cargo.toml>here</a>.<p>On macOS, Tracy can be installed through Homebrew by running <code>brew install tracy</code>, and the GUI client can be launched by running <code>tracy</code>.<p>In one terminal, run: <code>./capture-release -o my_capture.tracy</code> This will sit and wait for a tracy-instrumented application to start, and when it does, it will automatically connect and start capturing.<p>The name and location of the Tracy command line tool will vary depending on how you installed it - the default executable names are <code>capture-release</code> on Linux, <code>tracy</code> on macOS and <code>capture.exe</code> on Windows. In one terminal, run this tool: <code>./capture-release -o my_capture.tracy</code>. This will sit and wait for a tracy-instrumented application to start, and when it does, it will automatically connect and start capturing.<p>Then run your application, enabling the <code>trace_tracy</code> feature: <code>cargo run --release --features bevy/trace_tracy</code>. If you also want to track memory allocations, at the cost of increased runtime overhead, then enable the <code>trace_tracy_memory</code> feature instead: <code>cargo run --release --features bevy/trace_tracy_memory</code>.<p>After running your app, you can open the captured profile file (<code>my_capture.tracy</code> in the example above) in the Tracy GUI application to see a timeline of the executed spans.<p>Alternatively, directly run the tracy GUI and then run your application, for live capture. However, beware that running the live capture on the same machine will be a competing graphical application, which may impact results. Pre-recording the profile data through the CLI tool is recommended for more accurate traces.<p>In any case, you'll see your trace in the GUI window:<p><img alt="Tracy timeline demonstrating the performance breakdown of a Bevy app" src=https://user-images.githubusercontent.com/302146/163988636-25c017ab-64bc-4da7-a897-a80098b667ef.png><p>There is a button to display statistics of mean time per call (MTPC) for all systems:<p><img alt="A table in the Tracy GUI showing the MTPC (mean time per call) for all instrumented spans in the application" src=https://user-images.githubusercontent.com/302146/163988302-c21102d8-b7eb-476d-a741-a2c28d9bf8c1.png><p>Or you can select an individual system and inspect its statistics (available through the "statistics" button in the top menu) to see things like the distribution of execution times in a graph, or statistical aggregates such as mean, median, standard deviation, etc. It will look something like this:<p><img alt="A graph and statistics in the Tracy GUI showing the distribution of execution times of an instrumented span in the application" src=https://user-images.githubusercontent.com/302146/163988464-86e1a3ee-e97b-49ae-9f7e-4ff2b8b761ad.png><p>If you enabled memory tracing then the Zone Info window will also show the allocation events which occurred during a span:<p><img alt="A table in the Tracy GUI showing details of the allocations which occurred during a span" src=https://user-images.githubusercontent.com/8672791/228987498-77b26178-ef60-4e37-8356-dd07320ee159.png><p>Note that the <code>Bottom-up call stack tree</code> and <code>Top-down call stack tree</code> views reached by clicking the <code>Memory</code> button at the top of the UI will not show a usable backtrace even if memory tracking is enabled, as backtraces are not fully supported yet.<p>If you save more than one trace, you can compare the spans between both of them by clicking the <code>Compare</code> button at the top of the UI. This will open a dialog box asking to load a second trace. From there, it's possible to select any family of spans to more closely compare the timing and distribution of a particular span.<p><img alt="A graph and statistics in the Tracy GUI comparing the distribution of execution times of an instrumented span across two traces" src=https://user-images.githubusercontent.com/3137680/205834698-84405b2f-97b5-43a3-9dba-385167ac1db5.png><h3 id=chrome-tracing-format>Chrome tracing format <a class=anchor-link href=#chrome-tracing-format>#</a></h3><p><code>cargo run --release --features bevy/trace_chrome</code><p>After running your app a <code>json</code> file in the "chrome tracing format" will be produced. You can open this file in your browser using <a href=https://ui.perfetto.dev>https://ui.perfetto.dev</a>. It will look something like this:<p><img alt=image src=https://user-images.githubusercontent.com/2694663/141657409-6f4a3ad3-59b6-4378-95ba-66c0dafecd8e.png><h3 id=perf-flame-graph><code>perf</code> Flame Graph <a class=anchor-link href=#perf-flame-graph>#</a></h3><p>This approach requires no extra instrumentation and shows finer-grained flame graphs of actual code call trees. This is useful when you want to identify the specific function of a "hot spot". The downside is that it has higher overhead, so your app will run slower than it normally does.<p>Install <a href=https://github.com/flamegraph-rs/flamegraph>cargo-flamegraph</a>, <a href=https://github.com/flamegraph-rs/flamegraph#improving-output-when-running-with---release>enable debug symbols in your release build</a>, then run your app using one of the following commands. Note that <code>cargo-flamegraph</code> forwards arguments to cargo. You should treat the <code>cargo-flamegraph</code> command as a replacement for <code>cargo run --release</code>. The commands below include <code>--example EXAMPLE_NAME</code> to illustrate, but you can remove those arguments in favor of whatever you use to run your app:<ul><li>Graph-Like Flame Graph: <code>RUSTFLAGS='-C force-frame-pointers=y' cargo flamegraph -c "record -g" --example EXAMPLE_NAME</code><li>Flat-ish Flame Graph: <code>RUSTFLAGS='-C force-frame-pointers=y' cargo flamegraph --example EXAMPLE_NAME</code></ul><p>After closing your app, an interactive <code>svg</code> file will be produced: <img alt=image src=https://user-images.githubusercontent.com/2694663/141657609-0089675d-fb6a-4dc4-9a59-871e95e31c8a.png><h2 id=gpu-runtime>GPU runtime <a class=anchor-link href=#gpu-runtime>#</a></h2><p>First, a quick note on how GPU programming works. GPUs are essentially separate computers with their own compiler, scheduler, memory (for discrete GPUs), etc. You do not simply call functions to have the GPU perform work - instead, you communicate with them by sending data back and forth over the PCIe bus, via the GPU driver.<p>Specifically, you record a list of tasks (commands) for the GPU to perform into a CommandBuffer, and then submit that on a Queue to the GPU. At some point in the future, the GPU will receive the commands and execute them.<p>In terms of where your app is spending time doing graphics work, it might manifest as a CPU bottleneck (extracting to the render world, wgpu resource tracking, recording commands to a CommandBuffer, or GPU driver code), as a GPU bottleneck (the GPU actually running your commands), or even as a data transfer bottleneck (uploading new assets or other data to the GPU over the PCIe bus).<p>Graphics related work is not all CPU work or all GPU work, but a mix of both, and you should find the bottleneck and profile using the appropriate tool for each case.<h3 id=vendor-tools>Vendor tools <a class=anchor-link href=#vendor-tools>#</a></h3><p>If CPU profiling has shown that GPU work is the bottleneck, it's time to profile the GPU.<p>For profiling GPU work, you should use the tool corresponding to your GPU's vendor:<ul><li>NVIDIA - <a href=https://developer.nvidia.com/nsight-graphics>Nsight Graphics</a><li>AMD - <a href=https://gpuopen.com/rgp>Radeon GPU Profiler</a><li>Intel - <a href=https://www.intel.com/content/www/us/en/developer/tools/graphics-performance-analyzers/graphics-frame-analyzer.html>Graphics Frame Analyzer</a><li>Apple - <a href=https://developer.apple.com/documentation/xcode/optimizing-gpu-performance>Xcode</a></ul><p>Note that while RenderDoc is a great debugging tool, it is <em>not</em> a profiler, and should not be used for this purpose.<h4 id=xcode-s-metal-debugger>Xcode's Metal debugger <a class=anchor-link href=#xcode-s-metal-debugger>#</a></h4><p>Follow the steps below to start GPU debugging on macOS. There is no need to create an Xcode project.<ol><li><p>In the menu bar click on Debug > Debug Executable…</p> <p><img alt="Xcode's menu bar open to Debug > Debug Executable..." src=https://github.com/user-attachments/assets/efdc5037-0957-4227-b29d-9a789ba17a0a></p><li><p>Select your executable from your project’s target folder.</p><li><p>The Scheme Editor will open. If your assets are not located next to your executable, you can go to the Arguments tab and set <code>BEVY_ASSET_ROOT</code> to the absolute path for your project (the parent of your assets folder). The rest of the defaults should be fine.</p> <p><img alt="Xcode's Schema Editor opened to an environment variable configuration" src=https://github.com/user-attachments/assets/29cafb05-0c49-4777-8d41-8643812e8f6a></p><li><p>Click the play button in the top left and this should start your bevy app.</p> <p><img alt="A cursor hovering over the play button in XCode" src=https://github.com/user-attachments/assets/859580e2-779b-4db8-8ea6-73cf4ef696c9></p><li><p>Go back to Xcode and click on the Metal icon in the bottom drawer and then Capture in the following the popup menu.</p> <p><img alt="A cursor hovering over the Capture button in the Metal debugging popup menu" src=https://github.com/user-attachments/assets/c0ce1591-0a53-499b-bd1b-4d89538ea248></p><li><p>Start debugging and profiling!</p></ol><p><img alt="Xcode open to the Performance tab in the Debug Navigator." src=https://github.com/user-attachments/assets/52732391-9306-44a9-ae01-dcf4573f77ab><p>These instructions were created for Xcode 16.4.<h3 id=tracy-renderqueue>Tracy RenderQueue <a class=anchor-link href=#tracy-renderqueue>#</a></h3><p>While it doesn't provide as much detail as vendor-specific tooling, Tracy can also be used to coarsely measure GPU performance.<p>When you compile with Bevy's <code>trace_tracy</code> feature, GPU spans will show up in a separate row at the top of Tracy, labeled as <code>RenderQueue</code>.<blockquote><p>[!NOTE] Due to dynamic clock speeds, GPU timings will have large frame-to-frame variance, unless you use an external tool to lock your GPU clocks to base speeds. When measuring GPU performance via Tracy, only look at the MTPC column of Tracy's statistics panel, or the span distribution/median, and not at any individual frame data.</blockquote><blockquote><p>[!NOTE] Unlike ECS systems, Bevy will not automatically add GPU profiling spans. You will need to add GPU timing spans yourself for any custom rendering work. See the <a href=https://docs.rs/bevy/latest/bevy/render/diagnostic/struct.RenderDiagnosticsPlugin.html><code>RenderDiagnosticsPlugin</code></a> docs for more details.</blockquote><h2 id=compile-time>Compile time <a class=anchor-link href=#compile-time>#</a></h2><h3 id=general-advice>General advice <a class=anchor-link href=#general-advice>#</a></h3><ul><li>Run <code>cargo clean</code> before timing a command.<li>If you are using a rustc wrapper (like <code>sccache</code>), disable it by setting <code>RUSTC_WRAPPER=""</code><li>To measure noise in duration, run commands more than once and take the average. <a href=https://github.com/sharkdp/hyperfine><code>hyperfine</code></a> can do that for you with a cleanup between each execution (<code>hyperfine --cleanup "sleep 1; cargo clean" "cargo build"</code>).<li>Avoid running benchmarks on a computer that can do power throttling or thermal throttling, like a laptop.<li>Avoid running benchmarks with a processor that has different types of cores (efficiency vs performance), unless you can force the processor to use only one type of core.</ul><h3 id=cargo-timings>Cargo timings <a class=anchor-link href=#cargo-timings>#</a></h3><p>Append <code>--timings</code> to your app's cargo command (ex: <code>cargo build --timings</code>). If you want a "full" profile, make sure you run <code>cargo clean</code> first (note: this will clear previously generated reports). The command will tell you where it saved the report, which will be in your target directory under <code>cargo-timings/</code>. The report is a <code>.html</code> file and can be opened and viewed in your browser. This will show how much time each crate in your app's dependency tree took to build.<p><img alt="Cargo timings" src=https://user-images.githubusercontent.com/2694663/141657811-f4e15e3b-c9fc-491b-9313-236fd8c01288.png><h3 id=rustc-self-profile>rustc self-profile <a class=anchor-link href=#rustc-self-profile>#</a></h3><p>Cargo can generate a self-profile when building a crate. This is an unstable feature, but it can be used on a stable toolchain with <code>RUSTC_BOOTSTRAP</code>.<p>The following command will generate a self-profile for the <code>bevy_render</code> crate:<pre class="language-sh z-code" data-lang=sh><code class=language-sh data-lang=sh><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">RUSTC_BOOTSTRAP</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">1</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">cargo</span></span><span class="z-meta z-function-call z-arguments z-shell"> rustc<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>package</span> bevy_render<span class="z-keyword z-operator z-end-of-options z-shell"> --</span></span><span class="z-meta z-function-call z-arguments z-shell">  -Z self-profile -Z self-profile-events=default,args</span>
</span></code></pre><p>This will generate a file named something like <code>bevy_render-&LTid>>.mm_profdata</code> in the current directory. You can convert this file to a Chrome profiler trace with <a href=https://github.com/rust-lang/measureme/blob/master/crox/README.md><code>crox</code></a> and view the resulting trace in <a href=https://ui.perfetto.dev/>perfetto</a>.<p><img alt="rustc self-profile" src=https://github.com/user-attachments/assets/12645add-c647-4611-b533-9145cbcbac1c><h3 id=cargo-llvm-lines>cargo-llvm-lines <a class=anchor-link href=#cargo-llvm-lines>#</a></h3><p><a href=https://github.com/dtolnay/cargo-llvm-lines><code>cargo-llvm-lines</code></a> can show the number of LLVM lines generated by generic functions in your code. This can show you how much code is generated by each function, which can help you identify potential build performance issues.<h3 id=cargo-bloat>cargo-bloat <a class=anchor-link href=#cargo-bloat>#</a></h3><p><a href=https://github.com/RazrFalcon/cargo-bloat><code>cargo-bloat</code></a> can show the size of each function in your code. This can help you identify large functions that ends up in the final binary.</div><div class="docs-footer print:hidden"><nav class=docs-footer__nav><a class="docs-footer__link docs-footer__link--next" data-docs-nav-next href=/learn/book/releasing-projects/optimizing-performance/> <div class=docs-footer__label><div class=docs-footer__dir>Next</div> Optimizing Performance</div> <i class="docs-footer__chevron icon icon--chevron-right"></i> </a><a class="docs-footer__link docs-footer__link--prev" data-docs-nav-previous href=/learn/book/releasing-projects/> <div class=docs-footer__label><div class=docs-footer__dir>Previous</div> Releasing Projects</div> <i class="docs-footer__chevron icon icon--chevron-left"></i> </a></nav><div class=docs-footer__edit-wrapper><a class=docs-footer__edit href=https://github.com/bevyengine/bevy-website/edit/main/content/learn/book/releasing-projects/profiling.md> <i class="icon icon--pencil"></i> Improve this page </a><a href="https://github.com/bevyengine/bevy-website/issues/new?template=docs.md&title=Issue%20on%20page%20Profiling" class=docs-footer__edit> <i class="icon icon--github"></i> Report issue </a></div></div></div></div></div></div></div></main><footer class=print:hidden><div class=footer__social-container><a class=footer__social href=https://github.com/bevyengine/bevy title=GitHub> <img alt="GitHub logo" height=24 src=/assets/github-mark-white.svg width=24> </a><a class=footer__social href=https://discord.gg/bevy title=Discord> <img alt="Discord logo" height=24 src=/assets/discord.svg width=24> </a><a class=footer__social href=https://bsky.app/profile/bevy.org title=Bluesky> <img alt="Bluesky logo" height=24 src=/assets/bluesky.svg width=24> </a><a class=footer__social href=https://mastodon.social/@bevy title=Mastodon> <img alt="Mastodon logo" height=24 src=/assets/mastodon-logo-purple.svg width=24> </a><a class=footer__social href=https://www.reddit.com/r/bevy/ title=Reddit> <img alt="Reddit logo" height=24 src=/assets/reddit.svg width=24> </a><a class=footer__social href=https://itch.io/games/tag-bevy title=itch.io> <img alt="itch.io logo" height=24 src=/assets/itchio-textless.svg width=24> </a><a title="Bevy news feed" class=footer__social href=/atom.xml> <img alt="Bevy news feed" height=24 src=/assets/feed.svg width=24> </a></div></footer></div><script>const search_params=new URLSearchParams(window.location.search);if(search_params.has(`show_drafts`)||document.cookie.indexOf(`show_drafts`)>=0){let a=`show_drafts`;if(search_params.get(a)===`0`){document.cookie=`show_drafts=;path=/;expires=Thu, 01 Jan 1970 00:00:00 UTC`}else{document.cookie=`show_drafts=1;path=/`;document.body.classList.add(a)}}</script>