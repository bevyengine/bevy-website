<!doctype html><html class=light-mode lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Bevy Book: Project Organization" property=og:title><meta content=website property=og:type><meta content=https://bevy.org//learn/book/modular-architecture/project-organization/ property=og:url><meta content=https://bevy.org/assets/bevy_logo_fill.png property=og:image><meta content="Bevy is a refreshingly simple data-driven game engine built in Rust. It is free and open-source forever!" property=og:description><link rel="shortcut icon" href=/assets/favicon.png type=image/png><link href=/site.css rel=stylesheet><link href=/atom.xml rel=alternate type=application/atom+xml><title>Bevy Book: Project Organization</title><script src=/optional-helpers.js></script><script defer src=/highlight-intrapage-link.js></script><body><div class=layout><input class=hidden id=mobile-menu-state type=checkbox><header class="layout__header header print:hidden" data-mobile-menu-state-container><div class=header__content><label class=main-menu-backdrop for=mobile-menu-state></label><label class="header__hamburger button-square button-square--header" for=mobile-menu-state><img alt="Three horizontal lines stacked on top of eachother" height=16 src=/assets/icon-hamburger.svg width=20></label><div class=header__left-block><a class=header__logo href=/> <picture class=logo><img alt="Bevy logo" class=logo height=130 src=/assets/bevy_logo_dark.svg width=520></picture> </a><div class=header__message>The Book</div></div><input checked class=hidden id=page-menu-switch-state type=checkbox><nav class="header__menu main-menu main-menu--with-page-menu" data-page-menu-switch-state-container role=navigation><div class=main-menu__header><a href=/> <picture class=logo><img alt="Bevy Engine" class=logo height=130 src=/assets/bevy_logo_dark.svg width=520></picture> </a><label class="button-square button-square--header" for=mobile-menu-state><img alt="A saltire or x-cross" height=16 src=/assets/icon-times.svg width=16></label></div><div class=main-menu__page-menu-switch><label class=menu-switch for=page-menu-switch-state><div class="menu-switch__option menu-switch__option--main-menu">Main Menu</div> <div class="menu-switch__option menu-switch__option--page-menu">The Book</div></label></div><div class=main-menu__content><div class=main-menu__page-menu><ul class=tree-menu><input class=tree-menu__state id=mobile-menu-learn-book-intro type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/intro/>Introduction</a><label class=tree-menu__toggle for=mobile-menu-learn-book-intro><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/what-is-bevy/>What is Bevy?</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/the-three-letters/>The E, the C, and the S</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/the-next-three-letters/>Resources, Queries, and Commands</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/apps-worlds/>Apps and Worlds</a></div></ul></li><input class=tree-menu__state id=mobile-menu-learn-book-storing-data type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/storing-data/>Storing Data</a><label class=tree-menu__toggle for=mobile-menu-learn-book-storing-data><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/entities-components/>Entities Have Components</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/required-components/>Required Components</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/world/>The World</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/queries/>Queries</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/resources/>Resources</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/relations/>Relations</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/local-system-param/>System-Local Data Storage</a></div></ul></li><input class=tree-menu__state id=mobile-menu-learn-book-control-flow type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/control-flow/>Control Flow</a><label class=tree-menu__toggle for=mobile-menu-learn-book-control-flow><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/systems/>Systems</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/run-conditions/>Skipping systems</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/states/>States</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/commands/>Commands</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/handling-errors/>Handling Errors</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/change-detection/>Change Detection</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/events/>Events</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/observers/>Observers</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/hooks/>Hooks</a></div></ul></li><input class=tree-menu__state id=mobile-menu-learn-book-the-game-loop type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/the-game-loop/>The Game Loop</a><label class=tree-menu__toggle for=mobile-menu-learn-book-the-game-loop><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/app/>App</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/schedules/>Schedules</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/rendering-frames/>Rendering frames</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/input-and-windowing/>Input and windowing</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/time-and-timers/>Time and Timers</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/custom-loops/>Custom Loops</a></div></ul></li><input checked class=tree-menu__state id=mobile-menu-learn-book-modular-architecture type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/modular-architecture/>Modular Architecture</a><label class=tree-menu__toggle for=mobile-menu-learn-book-modular-architecture><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/modular-architecture/plugins/>Plugins</a></div><li class="tree-menu__item tree-menu__item--active"><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/modular-architecture/project-organization/>Project Organization</a><nav aria-label="On This Page" class="on-this-page tree-menu__toc" data-highlight-intrapage-link><ul><li><a href=#modules>Modules</a><li><a href=#crates>Crates</a><li><a href=#item-visibility>Item Visibility</a><li><a href=#project-organization-by-example>Project organization by example</a></ul></nav></div></ul></li><input class=tree-menu__state id=mobile-menu-learn-book-development-practices type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/development-practices/>Development Practices</a><label class=tree-menu__toggle for=mobile-menu-learn-book-development-practices><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/fast-compiles/>Fast Compiles</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/hot-reloading/>Hot Reloading Code and Assets</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/debugging/>Debugging</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/testing/>Testing Bevy apps</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/linting/>Linting</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/dev-tools/>Dev tools</a></div></ul></li><input class=tree-menu__state id=mobile-menu-learn-book-releasing-projects type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/releasing-projects/>Releasing Projects</a><label class=tree-menu__toggle for=mobile-menu-learn-book-releasing-projects><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/profiling/>Profiling</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/optimizing-performance/>Optimizing Performance</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/optimizing-binary-size/>Optimizing Binary Size</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/libraries-for-bevy/>Creating libraries for Bevy</a></div></ul></ul></div><ul class=main-menu__menu><li class="main-menu__entry main-menu__entry--getting-started"><a class=main-menu__link href=/learn/quick-start/getting-started/> <span>Getting Started</span> </a><li class=main-menu__entry><a class="main-menu__link main-menu__link--active" href=/learn/> <span>Learn</span> </a><li class=main-menu__entry><a class=main-menu__link href=/news/> <span>News</span> </a><li class=main-menu__entry><a class=main-menu__link href=/community/> <span>Community</span> </a><li class=main-menu__entry><a class=main-menu__link href=/foundation/> <span>Foundation</span> </a><li class=main-menu__entry><a class=main-menu__link href=/assets/> <span>Assets</span> </a><li class=main-menu__entry><a class=main-menu__link href=/examples/> <span>Examples</span> </a></ul></div></nav><div class=header__cta-container><a class="button button--pink header__cta" href=/donate>Donate <img alt="heart icon" class=button__icon height=512 src=/assets/heart.svg width=512> </a><a class="header__cta header__cta--github" href=https://github.com/bevyengine/bevy> <img alt="GitHub repo" height=96 src=/assets/github-mark-white.svg width=98> </a></div></div></header><main class=layout__content><div class=container><h1 class=warning>This page is hidden because an ancestor is hidden</h1><div class=page-with-menu><div class="page-with-menu__menu-wrapper print:hidden"><div class=page-with-menu__menu><ul class=tree-menu><input class=tree-menu__state id=page-menu-learn-book-intro type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/intro/>Introduction</a><label class=tree-menu__toggle for=page-menu-learn-book-intro><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/what-is-bevy/>What is Bevy?</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/the-three-letters/>The E, the C, and the S</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/the-next-three-letters/>Resources, Queries, and Commands</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/intro/apps-worlds/>Apps and Worlds</a></div></ul></li><input class=tree-menu__state id=page-menu-learn-book-storing-data type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/storing-data/>Storing Data</a><label class=tree-menu__toggle for=page-menu-learn-book-storing-data><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/entities-components/>Entities Have Components</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/required-components/>Required Components</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/world/>The World</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/queries/>Queries</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/resources/>Resources</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/relations/>Relations</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/storing-data/local-system-param/>System-Local Data Storage</a></div></ul></li><input class=tree-menu__state id=page-menu-learn-book-control-flow type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/control-flow/>Control Flow</a><label class=tree-menu__toggle for=page-menu-learn-book-control-flow><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/systems/>Systems</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/run-conditions/>Skipping systems</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/states/>States</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/commands/>Commands</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/handling-errors/>Handling Errors</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/change-detection/>Change Detection</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/events/>Events</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/observers/>Observers</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/control-flow/hooks/>Hooks</a></div></ul></li><input class=tree-menu__state id=page-menu-learn-book-the-game-loop type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/the-game-loop/>The Game Loop</a><label class=tree-menu__toggle for=page-menu-learn-book-the-game-loop><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/app/>App</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/schedules/>Schedules</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/rendering-frames/>Rendering frames</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/input-and-windowing/>Input and windowing</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/time-and-timers/>Time and Timers</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/the-game-loop/custom-loops/>Custom Loops</a></div></ul></li><input checked class=tree-menu__state id=page-menu-learn-book-modular-architecture type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/modular-architecture/>Modular Architecture</a><label class=tree-menu__toggle for=page-menu-learn-book-modular-architecture><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/modular-architecture/plugins/>Plugins</a></div><li class="tree-menu__item tree-menu__item--active"><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/modular-architecture/project-organization/>Project Organization</a><nav aria-label="On This Page" class="on-this-page tree-menu__toc" data-highlight-intrapage-link><ul><li><a href=#modules>Modules</a><li><a href=#crates>Crates</a><li><a href=#item-visibility>Item Visibility</a><li><a href=#project-organization-by-example>Project organization by example</a></ul></nav></div></ul></li><input class=tree-menu__state id=page-menu-learn-book-development-practices type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/development-practices/>Development Practices</a><label class=tree-menu__toggle for=page-menu-learn-book-development-practices><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/fast-compiles/>Fast Compiles</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/hot-reloading/>Hot Reloading Code and Assets</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/debugging/>Debugging</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/testing/>Testing Bevy apps</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/linting/>Linting</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/development-practices/dev-tools/>Dev tools</a></div></ul></li><input class=tree-menu__state id=page-menu-learn-book-releasing-projects type=checkbox><li class=tree-menu__item><div class="tree-menu__label tree-menu__label--with-chevron"><a class=tree-menu__link href=/learn/book/releasing-projects/>Releasing Projects</a><label class=tree-menu__toggle for=page-menu-learn-book-releasing-projects><img alt="A chevron, or V-shaped symbol" class=tree-menu__chevron height=24 src=/assets/icon-chevron-down.svg width=15></label></div> <ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/profiling/>Profiling</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/optimizing-performance/>Optimizing Performance</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/optimizing-binary-size/>Optimizing Binary Size</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/book/releasing-projects/libraries-for-bevy/>Creating libraries for Bevy</a></div></ul></ul></div></div><div class=page-with-menu__content><div class=docs-page><div class=docs-content><h1>Project Organization</h1><div class=media-content><p>As your Bevy project grows, storing it all in a single <code>main.rs</code> file will become frustrating! But how should you split it apart, and what are your tools for doing so?<p>Thankfully, the Bevy community has answers to these questions:<ul><li>split your code based on the "domain" it covers <ul><li>think about where you might want to reuse, or selectively disable bits of functionality<li>code that changes together should live together<li>don't try to group together objects by "kind", like "components" and "systems"</ul><li>don't try to get it right from the very start <ul><li>split things up gradually, as areas become complex and unwieldy<li>you'll have a much better idea of the shape of your program then<li>and it stops you from wasting time at the start of your project</ul><li>take advantage of Rust's modules, crates and visibility to organize your code <ul><li>be mindful of <a href=https://doc.rust-lang.org/reference/items/implementations.html#orphan-rules>orphan rules</a> when architecting multi-crate projects</ul><li>one <a href=https://bevy.org/learn/book/modular-architecture/project-organization/./plugins.md>plugin</a> per module, and one plugin per crate (which may nest multiple plugins) is a good default <ul><li>placing these at the top of your files can act as a simple, consistent "table of contents"</ul></ul><h2 id=modules>Modules <a class=anchor-link href=#modules>#</a></h2><p>Rust's <a href=https://doc.rust-lang.org/book/ch07-02-defining-modules-to-control-scope-and-privacy.html>module system</a> is flexible and easy to use, allowing you to split code across files.<p>Generally, we find that splitting files that are beyond about 1000 lines is about the right size for Rust and Bevy projects. Too small and you'll end up constantly swapping between files, and too large and finding code within a file becomes frustrating.<p>Modules within files aren't particularly useful, but they can be used to control visibility, enable code folding, and are commonly used for tests.<h2 id=crates>Crates <a class=anchor-link href=#crates>#</a></h2><p>As your project grows even further, you should consider splitting it into multiple <a href=https://doc.rust-lang.org/book/ch07-01-packages-and-crates.html>crates</a> using <a href=https://doc.rust-lang.org/cargo/reference/workspaces.html>workspaces</a>.<p>Using crates is helpful when reusing code between projects, formalizing APIs for specific domains, or <a href=../releasing-projects/libraries-for-bevy.md>creating libraries</a> to share with other Bevy users. Game code generally looks a lot like library code in Bevy, so gradually pulling out stable chunks of your game's infrastructure is a sensible and natural thing to do.<p>But even within the context of a single game, splitting your projects into crates can be worth your time! Because <a href=https://www.feldera.com/blog/cutting-down-rust-compile-times-from-30-to-2-minutes-with-one-thousand-crates>Rust parallelizes compilation at the crate level</a>, splitting your code into crates can make a big difference to compile times on large projects, above and beyond our <a href=../development-practices/fast-compiles.md>setup tips for faster compilations</a>.<p><a href=https://doc.rust-lang.org/cargo/reference/timings.html><code>cargo build --timings</code></a> is an incredibly helpful tool for measuring and optimizing this. Try to reduce bottlenecks by being mindful about inter-crate dependencies, but be mindful that when developing games incremental compilation times are much more important than clean compile times.<p>This is a key reason why splitting your code into crates is so helpful for working with Bevy in particular: it allows the compiler to localize the changes to only the crates you've touched, and use the cached compilation results for everything else.<h2 id=item-visibility>Item Visibility <a class=anchor-link href=#item-visibility>#</a></h2><p>Rust allows you to carefully restrict which code can see various items and structs. This is known as <a href=https://doc.rust-lang.org/reference/visibility-and-privacy.html>visibility</a>, and the details are explained well in the linked reference.<p>For a game, thinking about visibility may feel like overkill. We want to iterate fast! Mess about! Find the fun! You might even be the only person on your team!<p>And that's largely right: game programming often warrants a more fluid, permissive approach. But there's still a few good reasons to take advantage of Rust's visibility system:<ul><li>carefully maintaining invariants <ul><li>simple validated getter/setter patterns are very effective<li>more complex patterns can often benefit from custom commands or system params to ensure a single blessed workflow<li>clean encapsulation ensures that you can update how something works in a single place</ul><li>dead code detection <ul><li>if your types/methods/functions are <code>pub</code>, Rust won't known if they're dead code<li>dead code slows down compile times, confuses the reader and slowly rots</ul><li>keeping your code <em>reasonably</em> untangled <ul><li>iterating quickly is important, and Rust will help you refactor, so you should be careful not to get too tangled up<li>forcing consumers to do things the right way makes it easier to change the internals later</ul></ul><p>At the end of the day, <code>pub(crate)</code> is a good default visibility level for items in larger projects. Internal methods, invariants, and implementation details should be private, which is the Rust language default behavior. Finally, fully <code>pub</code> items should be reserved for deliberate shared interfaces, central components / resources like <code>Player</code> or <code>TileMapIndex</code>, and the plugins that you add to your <code>main.rs</code> to actually add the final functionality.<p>The fields of your structs should match the visibility of the struct that holds them: skip the getter/setter methods unless you're performing validation.<h2 id=project-organization-by-example>Project organization by example <a class=anchor-link href=#project-organization-by-example>#</a></h2><p>Now that we have a handle on the tools available, let's talk over how a hypothetical project might change and grow. Our small studio is building a Wild West single player first-person shooter!<p>The very first step is to create a new project. Our folder structure will look something like:<ul><li>src/ <ul><li>main.rs</ul><li>Cargo.toml</ul><p>Simple enough! We get to Hello World with some <a href=https://docs.rs/bevy/latest/bevy/struct.DefaultPlugins.html><code>DefaultPlugins</code></a>, and add some third-party plugins that we know we'll want, and stick it all in <code>main.rs</code>.<p>Next up, we're going to need a first-person shooter character controller. We hunt around online, find a permissively licensed template or example, and copy-paste it into our project under a new <code>player.rs</code> file, declaring this file as a module under <code>main.rs</code>. We create a <code>PlayerPlugin</code>, add it to our <code>fn main</code>, and make sure we can hop around and aim. We <em>don't</em> pull in a library for this, because we know that we're going to need to heavily customize the exact behavior.<p>We also need some placeholder assets, so we look on <a href=https://itch.io/>itch.io</a> and grab something with about the right proportions. Our project now looks like this:<ul><li>assets/ <ul><li>main_character.gltf</ul><li>src/ <ul><li>main.rs<li>player.rs</ul><li>Cargo.toml</ul><p>With a bit of basic gameplay working, it's time to tackle some infrastructure that we know we'll need: menus and loading screens. We look at what we've done in previous projects and copy-paste liberally into a new <code>ui</code> folder, with multiple sub-files. We setup a basic <code>GameState</code> here, to allow us to pause and restart the game and handle opening and closing menus, sticking it in our <code>main.rs</code> because it's used throughout the project. Now, our project looks like this:<ul><li>assets/ <ul><li>main_character.gltf</ul><li>src/ <ul><li>ui/ <ul><li>mod.rs<li>main_menu.rs<li>pause_menu.rs<li>settings_menu.rs</ul><li>main.rs<li>player.rs</ul><li>Cargo.toml</ul><p>We're off to a good start, and it's time to add some more features! Let's get some basic enemies going. Wait, hang on, we want to share our character controller between our players and our enemies. After a quick refactor:<ul><li>assets/ <ul><li>main_character.gltf</ul><li>src/ <ul><li>characters/ <ul><li>mod.rs<li>controller.rs<li>player.rs</ul><li>ui/ <ul><li>mod.rs<li>main_menu.rs<li>pause_menu.rs<li>settings_menu.rs</ul><li>main.rs</ul><li>Cargo.toml</ul><p>With the help of Rust's compiler, that wasn't too bad. And now, we can finally add enemies!<ul><li>assets/ <ul><li>main_character.gltf<li>enemy.gltf</ul><li>src/ <ul><li>characters/ <ul><li>mod.rs<li>controller.rs<li>enemies.rs<li>player.rs</ul><li>ui/ <ul><li>mod.rs<li>main_menu.rs<li>pause_menu.rs<li>settings_menu.rs</ul><li>main.rs</ul><li>Cargo.toml</ul><p>Let's add some combat mechanics. After a few commits, our project has a brand new folder with plenty of game logic, and our enemies have some actual behavior:<ul><li>assets/ <ul><li>main_character.gltf<li>enemy.gltf</ul><li>src/ <ul><li>characters/ <ul><li>mod.rs<li>ai.rs<li>controller.rs<li>enemies.rs<li>player.rs</ul><li>combat/ <ul><li>mod.rs<li>life_and_damage.rs<li>weapons.rs</ul><li>ui/ <ul><li>mod.rs<li>main_menu.rs<li>pause_menu.rs<li>settings_menu.rs</ul><li>main.rs</ul><li>Cargo.toml</ul><p>Our enemy logic and behavior keeps growing in a messy way. Let's do some research, and swap over to a more sophisticated <a href=https://goap.crashkonijn.com/readme/theory>Goal Oriented Action Planning</a> solution. Now:<ul><li>assets/ <ul><li>main_character.gltf<li>enemy.gltf</ul><li>src/ <ul><li>characters/ <ul><li>ai/ <ul><li>mod.rs<li>goals.rs<li>actions.rs<li>planning.rs</ul><li>mod.rs<li>controller.rs<li>enemies.rs<li>player.rs</ul><li>combat/ <ul><li>mod.rs<li>life_and_damage.rs<li>weapons.rs</ul><li>ui/ <ul><li>mod.rs<li>main_menu.rs<li>pause_menu.rs<li>settings_menu.rs</ul><li>main.rs</ul><li>Cargo.toml</ul><p>Ugh, the compile times are really starting to slow down, and things are getting complicated. Let's refactor this to be a workspace. One step at a time though: get the simple setup right first, then we'll spin out subcrates. We're just going to create a binary application and a single library, and dump everything but our main.rs contents into the library, which we'll depend on in our binary.<ul><li>assets/ <ul><li>main_character.gltf<li>enemy.gltf</ul><li>wild_west_game/ <ul><li>src/ <ul><li>main.rs</ul><li>Cargo.toml</ul><li>wild_west_lib/ <ul><li>src/ <ul><li>characters/ <ul><li>ai/ <ul><li>mod.rs<li>goals.rs<li>actions.rs<li>planning.rs</ul><li>mod.rs<li>controller.rs<li>enemies.rs<li>player.rs</ul><li>combat/ <ul><li>mod.rs<li>life_and_damage.rs<li>weapons.rs</ul><li>ui/ <ul><li>mod.rs<li>main_menu.rs<li>pause_menu.rs<li>settings_menu.rs</ul><li>lib.rs<li>Cargo.toml</ul></ul><li>Cargo.toml</ul><p>We've had to move our <code>GameState</code> into our <code>lib.rs</code> so we can rely on it in our plugins, but that wasn't too bad. Now that everything is working again, let's start splitting things up! We can split out our new AI library for sure though: that's something we might want to publish one day!<ul><li>assets/ <ul><li>main_character.gltf<li>enemy.gltf</ul><li>wild_west_game/ <ul><li>src/ <ul><li>main.rs</ul><li>Cargo.toml</ul><li>wild_west_lib/ <ul><li>src/ <ul><li>characters/ <ul><li>mod.rs<li>controller.rs<li>enemies.rs<li>player.rs</ul><li>combat/ <ul><li>mod.rs<li>life_and_damage.rs<li>weapons.rs</ul><li>ui/ <ul><li>mod.rs<li>main_menu.rs<li>pause_menu.rs<li>settings_menu.rs</ul><li>lib.rs</ul></ul><li>better_goap/ <ul><li>src/ <ul><li>lib.rs<li>goals.rs<li>actions.rs<li>planning.rs</ul><li>Cargo.toml</ul><li>Cargo.toml</ul><p>We're still not sure exactly how our combat is going to work, and it's going to need to interface closely with our character code. Let's leave that alone for now. However, we've been bitten before by spaghettti code with our UI: let's spin that out and reduce the temptation. We'll define the various settings for the UI in our <code>wild_west_lib</code> using resources, and have our new <code>wild_west_ui</code> simply read and write those resource values.<ul><li>assets/ <ul><li>main_character.gltf<li>enemy.gltf</ul><li>wild_west_game/ <ul><li>src/ <ul><li>main.rs</ul><li>Cargo.toml</ul><li>wild_west_lib/ <ul><li>src/ <ul><li>characters/ <ul><li>mod.rs<li>controller.rs<li>enemies.rs<li>player.rs</ul><li>combat/ <ul><li>mod.rs<li>life_and_damage.rs<li>weapons.rs</ul><li>lib.rs</ul></ul><li>wild_west_ui/ <ul><li>src/ <ul><li>lib.rs<li>main_menu.rs<li>pause_menu.rs<li>settings_menu.rs</ul><li>Cargo.toml</ul><li>better_goap/ <ul><li>src/ <ul><li>lib.rs<li>goals.rs<li>actions.rs<li>planning.rs</ul><li>Cargo.toml</ul><li>Cargo.toml</ul><p>Watching this hypothetical studio develop their hypothetical game, we can come to appreciate where the advice about "don't try and get it right from the start", and "organize your code by functionality" comes from.<p>As you build your project, your needs will shift, and over-architecting a beautiful file structure will waste time and slow you down. But that doesn't mean you should be completely blind to potential future needs! By grouping related code together, we can quickly and reliably split apart files, and spin off folders into their own crates as the need arises.<p>If you keep each of your refactors small, use version control and make sure your project always keeps running, experimenting with project structure and architecture is easy and safe!</div><div class="docs-footer print:hidden"><nav class=docs-footer__nav><a class="docs-footer__link docs-footer__link--next" data-docs-nav-next href=/learn/book/development-practices/> <div class=docs-footer__label><div class=docs-footer__dir>Next</div> Development Practices</div> <i class="docs-footer__chevron icon icon--chevron-right"></i> </a><a class="docs-footer__link docs-footer__link--prev" data-docs-nav-previous href=/learn/book/modular-architecture/plugins/> <div class=docs-footer__label><div class=docs-footer__dir>Previous</div> Plugins</div> <i class="docs-footer__chevron icon icon--chevron-left"></i> </a></nav><div class=docs-footer__edit-wrapper><a class=docs-footer__edit href=https://github.com/bevyengine/bevy-website/edit/main/content/learn/book/modular-architecture/project-organization.md> <i class="icon icon--pencil"></i> Improve this page </a><a href="https://github.com/bevyengine/bevy-website/issues/new?template=docs.md&title=Issue%20on%20page%20Project%20Organization" class=docs-footer__edit> <i class="icon icon--github"></i> Report issue </a></div></div></div></div></div></div></div></main><footer class=print:hidden><div class=footer__social-container><a class=footer__social href=https://github.com/bevyengine/bevy title=GitHub> <img alt="GitHub logo" height=24 src=/assets/github-mark-white.svg width=24> </a><a class=footer__social href=https://discord.gg/bevy title=Discord> <img alt="Discord logo" height=24 src=/assets/discord.svg width=24> </a><a class=footer__social href=https://bsky.app/profile/bevy.org title=Bluesky> <img alt="Bluesky logo" height=24 src=/assets/bluesky.svg width=24> </a><a class=footer__social href=https://mastodon.social/@bevy title=Mastodon> <img alt="Mastodon logo" height=24 src=/assets/mastodon-logo-purple.svg width=24> </a><a class=footer__social href=https://www.reddit.com/r/bevy/ title=Reddit> <img alt="Reddit logo" height=24 src=/assets/reddit.svg width=24> </a><a class=footer__social href=https://itch.io/games/tag-bevy title=itch.io> <img alt="itch.io logo" height=24 src=/assets/itchio-textless.svg width=24> </a><a title="Bevy news feed" class=footer__social href=/atom.xml> <img alt="Bevy news feed" height=24 src=/assets/feed.svg width=24> </a></div></footer></div><script>const search_params=new URLSearchParams(window.location.search);if(search_params.has(`show_drafts`)||document.cookie.indexOf(`show_drafts`)>=0){let a=`show_drafts`;if(search_params.get(a)===`0`){document.cookie=`show_drafts=;path=/;expires=Thu, 01 Jan 1970 00:00:00 UTC`}else{document.cookie=`show_drafts=1;path=/`;document.body.classList.add(a)}}</script>