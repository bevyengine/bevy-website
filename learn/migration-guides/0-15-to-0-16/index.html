<!doctype html><html class=light-mode lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="0.15 to 0.16" property=og:title><meta content=website property=og:type><meta content=https://bevy.org//learn/migration-guides/0-15-to-0-16/ property=og:url><meta content=https://bevy.org/assets/bevy_logo_fill.png property=og:image><meta content="The most important changes to be aware of this release are:

Bevy has reworked its error handling to make it easier to handle Results everywhere. As aâ€¦" property=og:description><link rel="shortcut icon" href=/assets/favicon.png type=image/png><link href=/site.css rel=stylesheet><link href=/atom.xml rel=alternate type=application/atom+xml><title>0.15 to 0.16</title><script src=/optional-helpers.js></script><script defer src=/highlight-intrapage-link.js></script><script defer src=/clipboard.js></script><body><div class=layout><input class=hidden id=mobile-menu-state type=checkbox><header class="layout__header header print:hidden" data-mobile-menu-state-container><div class=header__content><label class=main-menu-backdrop for=mobile-menu-state></label><label class="header__hamburger button-square button-square--header" for=mobile-menu-state><img alt="Three horizontal lines stacked on top of eachother" height=16 src=/assets/icon-hamburger.svg width=20></label><div class=header__left-block><a class=header__logo href=/> <picture class=logo><img alt="Bevy logo" class=logo height=130 src=/assets/bevy_logo_dark.svg width=520></picture> </a><div class=header__message>Migration Guides</div></div><input checked class=hidden id=page-menu-switch-state type=checkbox><nav class="header__menu main-menu main-menu--with-page-menu" data-page-menu-switch-state-container role=navigation><div class=main-menu__header><a href=/> <picture class=logo><img alt="Bevy Engine" class=logo height=130 src=/assets/bevy_logo_dark.svg width=520></picture> </a><label class="button-square button-square--header" for=mobile-menu-state><img alt="A saltire or x-cross" height=16 src=/assets/icon-times.svg width=16></label></div><div class=main-menu__page-menu-switch><label class=menu-switch for=page-menu-switch-state><div class="menu-switch__option menu-switch__option--main-menu">Main Menu</div> <div class="menu-switch__option menu-switch__option--page-menu">Migration Guides</div></label></div><div class=main-menu__content><div class=main-menu__page-menu><ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/introduction/>Introduction</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-17-to-0-18/>0.17 to 0.18</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-16-to-0-17/>0.16 to 0.17</a></div><li class="tree-menu__item tree-menu__item--active"><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-15-to-0-16/>0.15 to 0.16</a><nav aria-label="On This Page" class="on-this-page tree-menu__toc" data-highlight-intrapage-link><ul><li><a href=#accessibility>Accessibility</a> <ul><li><a href=#replace-bevy-a11y-focus-with-bevy-input-focus-inputfocus>Replace bevy::a11y::Focus with bevy::input_focus::InputFocus</a></ul><li><a href=#animation>Animation</a> <ul><li><a href=#configure-easingfunction-steps-jumping-with-jumpat>Configure EasingFunction::Steps jumping with JumpAt</a><li><a href=#fix-easefunction-exponential-to-be-continuous>Fix EaseFunction::Exponential* to be continuous</a></ul><li><a href=#assets>Assets</a> <ul><li><a href=#remove-meta-field-from-loadedasset-and-erasedloadedasset>Remove meta field from LoadedAsset and ErasedLoadedAsset</a><li><a href=#deprecate-handle-weak-from-u128>Deprecate Handle::weak_from_u128()</a><li><a href=#add-assetchanged-query-filter>Add AssetChanged query filter</a></ul><li><a href=#audio>Audio</a> <ul><li><a href=#add-ability-to-mute-audio-sinks>Add ability to mute audio sinks</a><li><a href=#rename-audiosinkplayback-toggle-to-toggle-playback>Rename AudioSinkPlayback::toggle() to toggle_playback()</a><li><a href=#support-decibels-in-volume>Support decibels in Volume</a></ul><li><a href=#cross-cutting>Cross-Cutting</a> <ul><li><a href=#add-no-std-support-to-bevy>Add no_std support to bevy</a><li><a href=#support-for-non-browser-wasm>Support for non-browser WASM</a><li><a href=#upgrade-to-rust-edition-2024>Upgrade to Rust Edition 2024</a></ul><li><a href=#dev-tools>Dev-Tools</a> <ul><li><a href=#add-strict-field-to-brp-bevy-query>Add strict field to BRP bevy/query</a><li><a href=#rename-track-change-detection-flag-to-track-location>Rename track_change_detection flag to track_location</a><li><a href=#draw-the-ui-debug-overlay-using-the-ui-renderer>Draw the UI debug overlay using the UI renderer</a></ul><li><a href=#diagnostics>Diagnostics</a> <ul><li><a href=#allow-users-to-customize-history-length-in-frametimediagnosticsplugin>Allow users to customize history length in FrameTimeDiagnosticsPlugin</a></ul><li><a href=#ecs>ECS</a> <ul><li><a href=#improve-required-component-syntax>Improve required component syntax</a><li><a href=#get-names-of-queued-components>Get names of queued components</a><li><a href=#return-entitydoesnotexisterror-on-error-for-several-methods>Return EntityDoesNotExistError on error for several methods</a><li><a href=#cache-systems-by-s-instead-of-s-system>Cache systems by S instead of S::System</a><li><a href=#change-world-try-despawn-and-world-try-insert-batch-to-return-result>Change World::try_despawn() and World::try_insert_batch() to return Result</a><li><a href=#remove-intosystemconfigs-implementation-for-boxedsystem>Remove IntoSystemConfigs implementation for BoxedSystem<(), ()></a><li><a href=#improve-ergonomics-of-nonsendmarker>Improve ergonomics of NonSendMarker</a><li><a href=#define-systemparam-validation-on-a-per-system-parameter-basis>Define SystemParam validation on a per-system parameter basis</a><li><a href=#deprecate-insert-or-spawn-function-family>Deprecate insert_or_spawn() function family</a><li><a href=#deprecate-query-many-and-query-many-mut>Deprecate Query::many() and Query::many_mut()</a><li><a href=#encapsulate-location-tracking-data-into-maybelocation>Encapsulate location tracking data into MaybeLocation</a><li><a href=#support-fallible-systems>Support fallible systems</a><li><a href=#fix-unsoundness-in-queryiter-sort-by>Fix unsoundness in QueryIter::sort_by()</a><li><a href=#flush-commands-after-every-mutation-in-worldentitymut>Flush commands after every mutation in WorldEntityMut</a><li><a href=#make-system-configuration-generic>Make system configuration generic</a><li><a href=#introduce-entityworldmut-and-move-entitycommand-with-entity>Introduce EntityWorldMut and move EntityCommand::with_entity()</a><li><a href=#add-bundle-effects>Add bundle effects</a><li><a href=#rename-query-to-readonly-to-query-as-readonly>Rename Query::to_readonly() to Query::as_readonly()</a><li><a href=#isolate-component-registration-from-storages>Isolate component registration from Storages</a><li><a href=#unified-error-handling>Unified error handling</a><li><a href=#make-system-parameter-validation-use-the-global-error-handler>Make system parameter validation use the GLOBAL_ERROR_HANDLER</a><li><a href=#move-item-and-fetch-from-worldquery-to-querydata>Move Item and fetch() from WorldQuery to QueryData</a><li><a href=#move-resource-trait-to-its-own-module>Move Resource trait to its own module</a><li><a href=#rename-entityfetcherror-and-introduce-entitydoesnotexist>Rename EntityFetchError and introduce EntityDoesNotExist</a><li><a href=#rename-parent-to-childof-and-change-how-the-parent-is-accessed>Rename Parent to ChildOf and change how the parent is accessed</a><li><a href=#queued-component-registration>Queued component registration</a><li><a href=#remove-various-structs-that-implemented-command>Remove various structs that implemented Command</a><li><a href=#refactor-componenthook-parameters-into-hookcontext>Refactor ComponentHook parameters into HookContext</a><li><a href=#use-new-relationship-system-for-parent-child-hierarchies>Use new relationship system for parent-child hierarchies</a><li><a href=#remove-event-component-trait-bound>Remove Event: Component trait bound</a><li><a href=#remove-petgraph-from-bevy-ecs>Remove petgraph from bevy::ecs</a><li><a href=#remove-deprecated-ecs-items>Remove deprecated ECS items</a><li><a href=#remove-deprecated-component-reads-and-writes-and-family>Remove deprecated component_reads_and_writes() and family</a><li><a href=#remove-flush-and-reserve-invalid-assuming-no-entities>Remove flush_and_reserve_invalid_assuming_no_entities()</a><li><a href=#remove-lifetime-from-queryentityerror>Remove lifetime from QueryEntityError</a><li><a href=#remove-unsound-clone-impl-for-entitymutexcept>Remove unsound Clone impl for EntityMutExcept</a><li><a href=#remove-unused-generic-in-deferredworld-trigger>Remove unused generic in DeferredWorld::trigger()</a><li><a href=#rename-eventwriter-send-methods-to-write>Rename EventWriter::send() methods to write()</a><li><a href=#replace-visitentities-with-mapentities>Replace VisitEntities with MapEntities</a><li><a href=#run-observers-before-hooks-for-on-replace-and-on-remove>Run observers before hooks for on_replace() and on_remove()</a><li><a href=#shorten-the-lifetime-returned-from-querylens-query>Shorten the lifetime returned from QueryLens::query()</a><li><a href=#split-component-register-component-hooks-into-individual-methods>Split Component::register_component_hooks() into individual methods</a><li><a href=#turn-apply-deferred-into-a-zst-system>Turn apply_deferred() into a ZST system</a><li><a href=#replace-register-dynamic-with-register-dynamic-with>Replace register_dynamic() with register_dynamic_with()</a><li><a href=#add-entity-default-to-the-entity-set-wrappers>add Entity default to the entity set wrappers</a><li><a href=#impl-entityborrow-for-more-types>impl EntityBorrow for more types</a><li><a href=#implement-entityset-and-iter-many-unique-methods>implement EntitySet and iter_many_unique methods</a><li><a href=#make-entityhashmap-and-entityhashset-proper-types>make EntityHashMap and EntityHashSet proper types</a><li><a href=#one-shot-system-cleanup>one shot system cleanup</a><li><a href=#make-componentticks-field-public>Make ComponentTicks field public</a><li><a href=#add-immutable-component-support>Add Immutable Component Support</a><li><a href=#faster-entity-cloning>Faster entity cloning</a><li><a href=#filteredresource-returns-a-result-instead-of-a-simple-option>FilteredResource returns a Result instead of a simple Option</a><li><a href=#reflectbundle-remove-improvement>ReflectBundle::remove improvement</a><li><a href=#improved-derive-event>Improved #[derive(Event)]</a></ul><li><a href=#input>Input</a> <ul><li><a href=#gamepad-improvements>Gamepad improvements</a><li><a href=#scale-input-to-account-for-deadzones>Scale input to account for deadzones</a><li><a href=#use-name-component-for-gamepad>Use Name component for gamepad</a><li><a href=#expose-text-field-from-winit-in-keyboardinput>Expose text field from winit in KeyboardInput</a></ul><li><a href=#math>Math</a> <ul><li><a href=#fix-atan2-docs>Fix atan2 docs</a><li><a href=#fix-rounding-in-steps-easing-function>Fix rounding in steps easing function</a><li><a href=#improve-cubic-segment-bezier-functionality>Improve cubic segment bezier functionality</a><li><a href=#refactor-non-core-curve-methods-into-extension-traits>Refactor non-core Curve methods into extension traits</a><li><a href=#rename-rot2-angle-between-to-rot2-angle-to>Rename Rot2::angle_between to Rot2::angle_to</a><li><a href=#reworked-segment-types-into-their-cartesian-forms>Reworked Segment types into their cartesian forms</a><li><a href=#use-intoiterator-instead-of-into-vec-in-cubic-splines-interfaces>Use IntoIterator instead of Into&LTVec<..>> in cubic splines interfaces</a><li><a href=#math-add-smoothstep-and-smootherstep-easing-functions>[math] Add SmoothStep and SmootherStep easing functions</a><li><a href=#make-bevy-reflect-feature-of-bevy-math-non-default>Make bevy_reflect feature of bevy_math non-default</a></ul><li><a href=#picking>Picking</a> <ul><li><a href=#add-flags-to-spriteplugin-and-uiplugin-to-allow-disabling-their-picking-backend-without-needing-to-disable-features>Add flags to SpritePlugin and UiPlugin to allow disabling their picking backend (without needing to disable features).</a><li><a href=#add-optional-transparency-passthrough-for-sprite-backend-with-bevy-picking>Add optional transparency passthrough for sprite backend with bevy_picking</a><li><a href=#allow-users-to-easily-use-bevy-sprite-and-bevy-ui-without-picking>Allow users to easily use bevy_sprite and bevy_ui without picking</a><li><a href=#fix-bevy-picking-plugin-suffixes>Fix bevy_picking plugin suffixes</a><li><a href=#flattened-pointeraction-pressed-into-press-and-release>Flattened PointerAction::Pressed into Press and Release.</a><li><a href=#if-there-is-no-movement-dragstart-is-not-triggered>If there is no movement, DragStart is not triggered.</a><li><a href=#make-raymap-map-public>Make RayMap map public</a><li><a href=#make-sprite-picking-opt-in>Make sprite picking opt-in</a><li><a href=#make-sprite-picking-opt-in-1>Make sprite picking opt-in</a><li><a href=#rename-focus-in-bevy-picking-to-hover>Rename "focus" in bevy_picking to "hover"</a><li><a href=#rename-pointer-down-up-to-pointer-pressed-released-in-bevy-picking>Rename Pointer&LTDown/Up> to Pointer&LTPressed/Released> in bevy_picking</a><li><a href=#rename-pickingbehavior-to-pickable>Rename PickingBehavior to Pickable</a><li><a href=#rename-raycastsettings-to-meshraycastsettings>Rename RayCastSettings to MeshRayCastSettings</a><li><a href=#unify-picking-backends>Unify picking backends</a></ul><li><a href=#reflection>Reflection</a> <ul><li><a href=#include-reflectfromreflect-in-all-dynamic-data-types>Include ReflectFromReflect in all dynamic data types.</a><li><a href=#make-bevy-remote-feature-enable-serialize-feature>Make bevy_remote feature enable serialize feature</a><li><a href=#rename-arglist-push-methods-to-with-and-add-new-push-methods-which-take-mut-self>Rename ArgList::push methods to with and add new push methods which take &mut self</a><li><a href=#bevy-reflect-deprecate-partialreflect-clone-value>bevy_reflect: Deprecate PartialReflect::clone_value</a><li><a href=#bevy-reflect-remove-partialreflect-serializable>bevy_reflect: Remove PartialReflect::serializable</a><li><a href=#remove-unnecessary-partialreflect-bound-on-deserializewithregistry>Remove unnecessary PartialReflect bound on DeserializeWithRegistry</a></ul><li><a href=#rendering>Rendering</a> <ul><li><a href=#add-uv-transform-to-colormaterial>Add uv_transform to ColorMaterial</a><li><a href=#add-a-bindless-mode-to-asbindgroup>Add a bindless mode to AsBindGroup.</a><li><a href=#add-bevy-anti-aliasing>Add bevy_anti_aliasing</a><li><a href=#adding-alpha-threshold-to-orderindependenttransparencysettings-for-user-level-optimization>Adding alpha_threshold to OrderIndependentTransparencySettings for user-level optimization</a><li><a href=#allowed-creating-uninitialized-images-for-use-as-storage-textures>Allowed creating uninitialized images (for use as storage textures)</a><li><a href=#bind-only-the-written-parts-of-storage-buffers>Bind only the written parts of storage buffers.</a><li><a href=#change-gpuimage-size-from-uvec2-to-extent3d>Change GpuImage::size from UVec2 to Extent3d</a><li><a href=#cold-specialization>Cold Specialization</a><li><a href=#expose-pipeline-compilation-zero-initialize-workgroup-memory-option>Expose Pipeline Compilation Zero Initialize Workgroup Memory Option</a><li><a href=#fix-sprite-performance-regression-since-retained-render-world>Fix sprite performance regression since retained render world</a><li><a href=#fix-the-texture-binding-array-specialized-mesh-pipeline-and-custom-shader-instancing-examples-after-the-bindless-change>Fix the texture_binding_array, specialized_mesh_pipeline, and custom_shader_instancing examples after the bindless change.</a><li><a href=#implement-bindless-lightmaps>Implement bindless lightmaps.</a><li><a href=#implement-experimental-gpu-two-phase-occlusion-culling-for-the-standard-3d-mesh-pipeline>Implement experimental GPU two-phase occlusion culling for the standard 3D mesh pipeline.</a><li><a href=#introduce-support-for-mixed-lighting-by-allowing-lights-to-opt-out-of-contributing-diffuse-light-to-lightmapped-objects>Introduce support for mixed lighting by allowing lights to opt out of contributing diffuse light to lightmapped objects.</a><li><a href=#introduce-two-level-bins-for-multidrawable-meshes>Introduce two-level bins for multidrawable meshes.</a><li><a href=#key-render-phases-off-the-main-world-view-entity-not-the-render-world-view-entity>Key render phases off the main world view entity, not the render world view entity.</a><li><a href=#make-indirect-drawing-opt-out-instead-of-opt-in-enabling-multidraw-by-default>Make indirect drawing opt-out instead of opt-in, enabling multidraw by default.</a><li><a href=#make-the-get-function-on-instanceinputuniformbuffer-less-error-prone>Make the get function on InstanceInputUniformBuffer less error prone</a><li><a href=#make-the-default-directional-light-shadow-cascade-settings-similar-to-those-of-other-engines>Make the default directional light shadow cascade settings similar to those of other engines.</a><li><a href=#mesh-merge-to-return-a-result>Mesh::merge to return a Result</a><li><a href=#move-textureatlas-and-friends-into-bevy-image>Move TextureAtlas and friends into bevy_image</a><li><a href=#move-non-generic-parts-of-the-prepasspipeline-to-internal-field>Move non-generic parts of the PrepassPipeline to internal field</a><li><a href=#native-unclipped-depth-on-supported-platforms>Native unclipped depth on supported platforms</a><li><a href=#newtype-anchor>Newtype Anchor</a><li><a href=#only-use-the-aabb-center-for-mesh-visibility-range-testing-if-specified>Only use the AABB center for mesh visibility range testing if specified.</a><li><a href=#reduce-the-clusterable-object-ubo-size-below-16384-for-webgl-2>Reduce the clusterable object UBO size below 16384 for WebGL 2.</a><li><a href=#refactor-and-simplify-custom-projections>Refactor and simplify custom projections</a><li><a href=#remove-the-type-parameter-from-check-visibility-and-visibleentities>Remove the type parameter from check_visibility and VisibleEntities</a><li><a href=#support-scale-factor-for-image-render-targets>Support scale factor for image render targets</a><li><a href=#upgrade-to-wgpu-v24>Upgrade to wgpu v24</a><li><a href=#use-multi-draw-indirect-count-where-available-in-preparation-for-two-phase-occlusion-culling>Use multi_draw_indirect_count where available, in preparation for two-phase occlusion culling.</a><li><a href=#use-unchecked-shaders-for-better-performance>Use unchecked shaders for better performance</a><li><a href=#cleanup-bevy-render-lib-rs>cleanup bevy_render/lib.rs</a><li><a href=#extractedsprites-slice-buffer>ExtractedSprites slice buffer</a><li><a href=#improved-uiimage-and-sprite-scaling-and-slicing-apis>Improved UiImage and Sprite scaling and slicing APIs</a><li><a href=#rename-defaultcameraview>Rename DefaultCameraView</a><li><a href=#rename-targetcamera-to-uitargetcamera>Rename TargetCamera to UiTargetCamera</a><li><a href=#borderrect-maintenance>BorderRect maintenance</a></ul><li><a href=#scenes>Scenes</a> <ul><li><a href=#only-despawn-scene-entities-still-in-the-hierarchy>Only despawn scene entities still in the hierarchy</a></ul><li><a href=#tasks>Tasks</a> <ul><li><a href=#support-on-thread-spawn-and-on-thread-destroy-for-taskpoolplugin>Support on_thread_spawn and on_thread_destroy for TaskPoolPlugin</a></ul><li><a href=#text>Text</a> <ul><li><a href=#add-byte-information-to-positionedglyph>Add byte information to PositionedGlyph</a><li><a href=#remove-the-atlas-scaling-field-from-extracteduiitem-glyphs>Remove the atlas_scaling field from ExtractedUiItem::Glyphs.</a><li><a href=#add-line-height-to-textfont>add line height to TextFont</a></ul><li><a href=#ui>UI</a> <ul><li><a href=#fixing-valarithmeticerror-typo-and-unused-variant>Fixing ValArithmeticError typo and unused variant</a><li><a href=#move-textureatlas-into-uiimage-and-remove-impl-component-for-textureatlas>Move TextureAtlas into UiImage and remove impl Component for TextureAtlas</a><li><a href=#multiple-box-shadow-support>Multiple box shadow support</a><li><a href=#only-use-physical-coords-internally-in-bevy-ui>Only use physical coords internally in bevy_ui</a><li><a href=#remove-custom-rounding>Remove custom rounding</a><li><a href=#remove-the-min-and-max-fields-from-layoutcontext>Remove the min and max fields from LayoutContext.</a><li><a href=#rename-uiboxshadowsamples-to-boxshadowsamples>Rename UiBoxShadowSamples to BoxShadowSamples.</a><li><a href=#uiimage-imagenode-uiimagesize-imagenodesize>UiImage -> ImageNode, UiImageSize -> ImageNodeSize</a></ul><li><a href=#windowing>Windowing</a> <ul><li><a href=#make-customcursor-variants-customcursorimage-customcursorurl-structs>Make CustomCursor variants CustomCursorImage/CustomCursorUrl structs</a><li><a href=#make-rawhandlewrapper-fields-private-to-save-users-from-themselves>Make RawHandleWrapper fields private to save users from themselves</a><li><a href=#rework-windowmode-fullscreen-api>Rework WindowMode::Fullscreen API</a><li><a href=#support-texture-atlases-in-customcursor-image>Support texture atlases in CustomCursor::Image</a></ul><li><a href=#utils>Utils</a> <ul><li><a href=#bevy-utils-refactor>bevy_utils Refactor</a></ul><li><a href=#without-area>Without area</a> <ul><li><a href=#link-ios-example-with-rustc-and-avoid-c-trampoline>Link iOS example with rustc, and avoid C trampoline</a><li><a href=#remove-image-from-buffer-name-argument-only-present-in-debug-dds-builds>Remove Image::from_buffer name argument (only present in debug "dds" builds)</a><li><a href=#remove-bevy-core>Remove bevy_core</a><li><a href=#rename-trigger-entity-to-trigger-target>Rename trigger.entity() to trigger.target()</a><li><a href=#use-target-abi-sim-instead-of-ios-simulator-feature>Use target_abi = "sim" instead of ios_simulator feature</a></ul></ul></nav></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-14-to-0-15/>0.14 to 0.15</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-13-to-0-14/>0.13 to 0.14</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-12-to-0-13/>0.12 to 0.13</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-11-to-0-12/>0.11 to 0.12</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-10-to-0-11/>0.10 to 0.11</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-9-to-0-10/>0.9 to 0.10</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-8-to-0-9/>0.8 to 0.9</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-7-to-0-8/>0.7 to 0.8</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-6-to-0-7/>0.6 to 0.7</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-5-to-0-6/>0.5 to 0.6</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-4-to-0-5/>0.4 to 0.5</a></div></ul></div><ul class=main-menu__menu><li class="main-menu__entry main-menu__entry--getting-started"><a class=main-menu__link href=/learn/quick-start/getting-started/> <span>Getting Started</span> </a><li class=main-menu__entry><a class="main-menu__link main-menu__link--active" href=/learn/> <span>Learn</span> </a><li class=main-menu__entry><a class=main-menu__link href=/news/> <span>News</span> </a><li class=main-menu__entry><a class=main-menu__link href=/community/> <span>Community</span> </a><li class=main-menu__entry><a class=main-menu__link href=/foundation/> <span>Foundation</span> </a><li class=main-menu__entry><a class=main-menu__link href=/assets/> <span>Assets</span> </a><li class=main-menu__entry><a class=main-menu__link href=/examples/> <span>Examples</span> </a></ul></div></nav><div class=header__cta-container><a class="button button--pink header__cta" href=/donate>Donate <img alt="heart icon" class=button__icon height=512 src=/assets/heart.svg width=512> </a><a class="header__cta header__cta--github" href=https://github.com/bevyengine/bevy> <img alt="GitHub repo" height=96 src=/assets/github-mark-white.svg width=98> </a></div></div></header><main class=layout__content><div class=container><div class=page-with-menu><div class="page-with-menu__menu-wrapper print:hidden"><div class=page-with-menu__menu><ul class=tree-menu><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/introduction/>Introduction</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-17-to-0-18/>0.17 to 0.18</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-16-to-0-17/>0.16 to 0.17</a></div><li class="tree-menu__item tree-menu__item--active"><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-15-to-0-16/>0.15 to 0.16</a><nav aria-label="On This Page" class="on-this-page tree-menu__toc" data-highlight-intrapage-link><ul><li><a href=#accessibility>Accessibility</a> <ul><li><a href=#replace-bevy-a11y-focus-with-bevy-input-focus-inputfocus>Replace bevy::a11y::Focus with bevy::input_focus::InputFocus</a></ul><li><a href=#animation>Animation</a> <ul><li><a href=#configure-easingfunction-steps-jumping-with-jumpat>Configure EasingFunction::Steps jumping with JumpAt</a><li><a href=#fix-easefunction-exponential-to-be-continuous>Fix EaseFunction::Exponential* to be continuous</a></ul><li><a href=#assets>Assets</a> <ul><li><a href=#remove-meta-field-from-loadedasset-and-erasedloadedasset>Remove meta field from LoadedAsset and ErasedLoadedAsset</a><li><a href=#deprecate-handle-weak-from-u128>Deprecate Handle::weak_from_u128()</a><li><a href=#add-assetchanged-query-filter>Add AssetChanged query filter</a></ul><li><a href=#audio>Audio</a> <ul><li><a href=#add-ability-to-mute-audio-sinks>Add ability to mute audio sinks</a><li><a href=#rename-audiosinkplayback-toggle-to-toggle-playback>Rename AudioSinkPlayback::toggle() to toggle_playback()</a><li><a href=#support-decibels-in-volume>Support decibels in Volume</a></ul><li><a href=#cross-cutting>Cross-Cutting</a> <ul><li><a href=#add-no-std-support-to-bevy>Add no_std support to bevy</a><li><a href=#support-for-non-browser-wasm>Support for non-browser WASM</a><li><a href=#upgrade-to-rust-edition-2024>Upgrade to Rust Edition 2024</a></ul><li><a href=#dev-tools>Dev-Tools</a> <ul><li><a href=#add-strict-field-to-brp-bevy-query>Add strict field to BRP bevy/query</a><li><a href=#rename-track-change-detection-flag-to-track-location>Rename track_change_detection flag to track_location</a><li><a href=#draw-the-ui-debug-overlay-using-the-ui-renderer>Draw the UI debug overlay using the UI renderer</a></ul><li><a href=#diagnostics>Diagnostics</a> <ul><li><a href=#allow-users-to-customize-history-length-in-frametimediagnosticsplugin>Allow users to customize history length in FrameTimeDiagnosticsPlugin</a></ul><li><a href=#ecs>ECS</a> <ul><li><a href=#improve-required-component-syntax>Improve required component syntax</a><li><a href=#get-names-of-queued-components>Get names of queued components</a><li><a href=#return-entitydoesnotexisterror-on-error-for-several-methods>Return EntityDoesNotExistError on error for several methods</a><li><a href=#cache-systems-by-s-instead-of-s-system>Cache systems by S instead of S::System</a><li><a href=#change-world-try-despawn-and-world-try-insert-batch-to-return-result>Change World::try_despawn() and World::try_insert_batch() to return Result</a><li><a href=#remove-intosystemconfigs-implementation-for-boxedsystem>Remove IntoSystemConfigs implementation for BoxedSystem<(), ()></a><li><a href=#improve-ergonomics-of-nonsendmarker>Improve ergonomics of NonSendMarker</a><li><a href=#define-systemparam-validation-on-a-per-system-parameter-basis>Define SystemParam validation on a per-system parameter basis</a><li><a href=#deprecate-insert-or-spawn-function-family>Deprecate insert_or_spawn() function family</a><li><a href=#deprecate-query-many-and-query-many-mut>Deprecate Query::many() and Query::many_mut()</a><li><a href=#encapsulate-location-tracking-data-into-maybelocation>Encapsulate location tracking data into MaybeLocation</a><li><a href=#support-fallible-systems>Support fallible systems</a><li><a href=#fix-unsoundness-in-queryiter-sort-by>Fix unsoundness in QueryIter::sort_by()</a><li><a href=#flush-commands-after-every-mutation-in-worldentitymut>Flush commands after every mutation in WorldEntityMut</a><li><a href=#make-system-configuration-generic>Make system configuration generic</a><li><a href=#introduce-entityworldmut-and-move-entitycommand-with-entity>Introduce EntityWorldMut and move EntityCommand::with_entity()</a><li><a href=#add-bundle-effects>Add bundle effects</a><li><a href=#rename-query-to-readonly-to-query-as-readonly>Rename Query::to_readonly() to Query::as_readonly()</a><li><a href=#isolate-component-registration-from-storages>Isolate component registration from Storages</a><li><a href=#unified-error-handling>Unified error handling</a><li><a href=#make-system-parameter-validation-use-the-global-error-handler>Make system parameter validation use the GLOBAL_ERROR_HANDLER</a><li><a href=#move-item-and-fetch-from-worldquery-to-querydata>Move Item and fetch() from WorldQuery to QueryData</a><li><a href=#move-resource-trait-to-its-own-module>Move Resource trait to its own module</a><li><a href=#rename-entityfetcherror-and-introduce-entitydoesnotexist>Rename EntityFetchError and introduce EntityDoesNotExist</a><li><a href=#rename-parent-to-childof-and-change-how-the-parent-is-accessed>Rename Parent to ChildOf and change how the parent is accessed</a><li><a href=#queued-component-registration>Queued component registration</a><li><a href=#remove-various-structs-that-implemented-command>Remove various structs that implemented Command</a><li><a href=#refactor-componenthook-parameters-into-hookcontext>Refactor ComponentHook parameters into HookContext</a><li><a href=#use-new-relationship-system-for-parent-child-hierarchies>Use new relationship system for parent-child hierarchies</a><li><a href=#remove-event-component-trait-bound>Remove Event: Component trait bound</a><li><a href=#remove-petgraph-from-bevy-ecs>Remove petgraph from bevy::ecs</a><li><a href=#remove-deprecated-ecs-items>Remove deprecated ECS items</a><li><a href=#remove-deprecated-component-reads-and-writes-and-family>Remove deprecated component_reads_and_writes() and family</a><li><a href=#remove-flush-and-reserve-invalid-assuming-no-entities>Remove flush_and_reserve_invalid_assuming_no_entities()</a><li><a href=#remove-lifetime-from-queryentityerror>Remove lifetime from QueryEntityError</a><li><a href=#remove-unsound-clone-impl-for-entitymutexcept>Remove unsound Clone impl for EntityMutExcept</a><li><a href=#remove-unused-generic-in-deferredworld-trigger>Remove unused generic in DeferredWorld::trigger()</a><li><a href=#rename-eventwriter-send-methods-to-write>Rename EventWriter::send() methods to write()</a><li><a href=#replace-visitentities-with-mapentities>Replace VisitEntities with MapEntities</a><li><a href=#run-observers-before-hooks-for-on-replace-and-on-remove>Run observers before hooks for on_replace() and on_remove()</a><li><a href=#shorten-the-lifetime-returned-from-querylens-query>Shorten the lifetime returned from QueryLens::query()</a><li><a href=#split-component-register-component-hooks-into-individual-methods>Split Component::register_component_hooks() into individual methods</a><li><a href=#turn-apply-deferred-into-a-zst-system>Turn apply_deferred() into a ZST system</a><li><a href=#replace-register-dynamic-with-register-dynamic-with>Replace register_dynamic() with register_dynamic_with()</a><li><a href=#add-entity-default-to-the-entity-set-wrappers>add Entity default to the entity set wrappers</a><li><a href=#impl-entityborrow-for-more-types>impl EntityBorrow for more types</a><li><a href=#implement-entityset-and-iter-many-unique-methods>implement EntitySet and iter_many_unique methods</a><li><a href=#make-entityhashmap-and-entityhashset-proper-types>make EntityHashMap and EntityHashSet proper types</a><li><a href=#one-shot-system-cleanup>one shot system cleanup</a><li><a href=#make-componentticks-field-public>Make ComponentTicks field public</a><li><a href=#add-immutable-component-support>Add Immutable Component Support</a><li><a href=#faster-entity-cloning>Faster entity cloning</a><li><a href=#filteredresource-returns-a-result-instead-of-a-simple-option>FilteredResource returns a Result instead of a simple Option</a><li><a href=#reflectbundle-remove-improvement>ReflectBundle::remove improvement</a><li><a href=#improved-derive-event>Improved #[derive(Event)]</a></ul><li><a href=#input>Input</a> <ul><li><a href=#gamepad-improvements>Gamepad improvements</a><li><a href=#scale-input-to-account-for-deadzones>Scale input to account for deadzones</a><li><a href=#use-name-component-for-gamepad>Use Name component for gamepad</a><li><a href=#expose-text-field-from-winit-in-keyboardinput>Expose text field from winit in KeyboardInput</a></ul><li><a href=#math>Math</a> <ul><li><a href=#fix-atan2-docs>Fix atan2 docs</a><li><a href=#fix-rounding-in-steps-easing-function>Fix rounding in steps easing function</a><li><a href=#improve-cubic-segment-bezier-functionality>Improve cubic segment bezier functionality</a><li><a href=#refactor-non-core-curve-methods-into-extension-traits>Refactor non-core Curve methods into extension traits</a><li><a href=#rename-rot2-angle-between-to-rot2-angle-to>Rename Rot2::angle_between to Rot2::angle_to</a><li><a href=#reworked-segment-types-into-their-cartesian-forms>Reworked Segment types into their cartesian forms</a><li><a href=#use-intoiterator-instead-of-into-vec-in-cubic-splines-interfaces>Use IntoIterator instead of Into&LTVec<..>> in cubic splines interfaces</a><li><a href=#math-add-smoothstep-and-smootherstep-easing-functions>[math] Add SmoothStep and SmootherStep easing functions</a><li><a href=#make-bevy-reflect-feature-of-bevy-math-non-default>Make bevy_reflect feature of bevy_math non-default</a></ul><li><a href=#picking>Picking</a> <ul><li><a href=#add-flags-to-spriteplugin-and-uiplugin-to-allow-disabling-their-picking-backend-without-needing-to-disable-features>Add flags to SpritePlugin and UiPlugin to allow disabling their picking backend (without needing to disable features).</a><li><a href=#add-optional-transparency-passthrough-for-sprite-backend-with-bevy-picking>Add optional transparency passthrough for sprite backend with bevy_picking</a><li><a href=#allow-users-to-easily-use-bevy-sprite-and-bevy-ui-without-picking>Allow users to easily use bevy_sprite and bevy_ui without picking</a><li><a href=#fix-bevy-picking-plugin-suffixes>Fix bevy_picking plugin suffixes</a><li><a href=#flattened-pointeraction-pressed-into-press-and-release>Flattened PointerAction::Pressed into Press and Release.</a><li><a href=#if-there-is-no-movement-dragstart-is-not-triggered>If there is no movement, DragStart is not triggered.</a><li><a href=#make-raymap-map-public>Make RayMap map public</a><li><a href=#make-sprite-picking-opt-in>Make sprite picking opt-in</a><li><a href=#make-sprite-picking-opt-in-1>Make sprite picking opt-in</a><li><a href=#rename-focus-in-bevy-picking-to-hover>Rename "focus" in bevy_picking to "hover"</a><li><a href=#rename-pointer-down-up-to-pointer-pressed-released-in-bevy-picking>Rename Pointer&LTDown/Up> to Pointer&LTPressed/Released> in bevy_picking</a><li><a href=#rename-pickingbehavior-to-pickable>Rename PickingBehavior to Pickable</a><li><a href=#rename-raycastsettings-to-meshraycastsettings>Rename RayCastSettings to MeshRayCastSettings</a><li><a href=#unify-picking-backends>Unify picking backends</a></ul><li><a href=#reflection>Reflection</a> <ul><li><a href=#include-reflectfromreflect-in-all-dynamic-data-types>Include ReflectFromReflect in all dynamic data types.</a><li><a href=#make-bevy-remote-feature-enable-serialize-feature>Make bevy_remote feature enable serialize feature</a><li><a href=#rename-arglist-push-methods-to-with-and-add-new-push-methods-which-take-mut-self>Rename ArgList::push methods to with and add new push methods which take &mut self</a><li><a href=#bevy-reflect-deprecate-partialreflect-clone-value>bevy_reflect: Deprecate PartialReflect::clone_value</a><li><a href=#bevy-reflect-remove-partialreflect-serializable>bevy_reflect: Remove PartialReflect::serializable</a><li><a href=#remove-unnecessary-partialreflect-bound-on-deserializewithregistry>Remove unnecessary PartialReflect bound on DeserializeWithRegistry</a></ul><li><a href=#rendering>Rendering</a> <ul><li><a href=#add-uv-transform-to-colormaterial>Add uv_transform to ColorMaterial</a><li><a href=#add-a-bindless-mode-to-asbindgroup>Add a bindless mode to AsBindGroup.</a><li><a href=#add-bevy-anti-aliasing>Add bevy_anti_aliasing</a><li><a href=#adding-alpha-threshold-to-orderindependenttransparencysettings-for-user-level-optimization>Adding alpha_threshold to OrderIndependentTransparencySettings for user-level optimization</a><li><a href=#allowed-creating-uninitialized-images-for-use-as-storage-textures>Allowed creating uninitialized images (for use as storage textures)</a><li><a href=#bind-only-the-written-parts-of-storage-buffers>Bind only the written parts of storage buffers.</a><li><a href=#change-gpuimage-size-from-uvec2-to-extent3d>Change GpuImage::size from UVec2 to Extent3d</a><li><a href=#cold-specialization>Cold Specialization</a><li><a href=#expose-pipeline-compilation-zero-initialize-workgroup-memory-option>Expose Pipeline Compilation Zero Initialize Workgroup Memory Option</a><li><a href=#fix-sprite-performance-regression-since-retained-render-world>Fix sprite performance regression since retained render world</a><li><a href=#fix-the-texture-binding-array-specialized-mesh-pipeline-and-custom-shader-instancing-examples-after-the-bindless-change>Fix the texture_binding_array, specialized_mesh_pipeline, and custom_shader_instancing examples after the bindless change.</a><li><a href=#implement-bindless-lightmaps>Implement bindless lightmaps.</a><li><a href=#implement-experimental-gpu-two-phase-occlusion-culling-for-the-standard-3d-mesh-pipeline>Implement experimental GPU two-phase occlusion culling for the standard 3D mesh pipeline.</a><li><a href=#introduce-support-for-mixed-lighting-by-allowing-lights-to-opt-out-of-contributing-diffuse-light-to-lightmapped-objects>Introduce support for mixed lighting by allowing lights to opt out of contributing diffuse light to lightmapped objects.</a><li><a href=#introduce-two-level-bins-for-multidrawable-meshes>Introduce two-level bins for multidrawable meshes.</a><li><a href=#key-render-phases-off-the-main-world-view-entity-not-the-render-world-view-entity>Key render phases off the main world view entity, not the render world view entity.</a><li><a href=#make-indirect-drawing-opt-out-instead-of-opt-in-enabling-multidraw-by-default>Make indirect drawing opt-out instead of opt-in, enabling multidraw by default.</a><li><a href=#make-the-get-function-on-instanceinputuniformbuffer-less-error-prone>Make the get function on InstanceInputUniformBuffer less error prone</a><li><a href=#make-the-default-directional-light-shadow-cascade-settings-similar-to-those-of-other-engines>Make the default directional light shadow cascade settings similar to those of other engines.</a><li><a href=#mesh-merge-to-return-a-result>Mesh::merge to return a Result</a><li><a href=#move-textureatlas-and-friends-into-bevy-image>Move TextureAtlas and friends into bevy_image</a><li><a href=#move-non-generic-parts-of-the-prepasspipeline-to-internal-field>Move non-generic parts of the PrepassPipeline to internal field</a><li><a href=#native-unclipped-depth-on-supported-platforms>Native unclipped depth on supported platforms</a><li><a href=#newtype-anchor>Newtype Anchor</a><li><a href=#only-use-the-aabb-center-for-mesh-visibility-range-testing-if-specified>Only use the AABB center for mesh visibility range testing if specified.</a><li><a href=#reduce-the-clusterable-object-ubo-size-below-16384-for-webgl-2>Reduce the clusterable object UBO size below 16384 for WebGL 2.</a><li><a href=#refactor-and-simplify-custom-projections>Refactor and simplify custom projections</a><li><a href=#remove-the-type-parameter-from-check-visibility-and-visibleentities>Remove the type parameter from check_visibility and VisibleEntities</a><li><a href=#support-scale-factor-for-image-render-targets>Support scale factor for image render targets</a><li><a href=#upgrade-to-wgpu-v24>Upgrade to wgpu v24</a><li><a href=#use-multi-draw-indirect-count-where-available-in-preparation-for-two-phase-occlusion-culling>Use multi_draw_indirect_count where available, in preparation for two-phase occlusion culling.</a><li><a href=#use-unchecked-shaders-for-better-performance>Use unchecked shaders for better performance</a><li><a href=#cleanup-bevy-render-lib-rs>cleanup bevy_render/lib.rs</a><li><a href=#extractedsprites-slice-buffer>ExtractedSprites slice buffer</a><li><a href=#improved-uiimage-and-sprite-scaling-and-slicing-apis>Improved UiImage and Sprite scaling and slicing APIs</a><li><a href=#rename-defaultcameraview>Rename DefaultCameraView</a><li><a href=#rename-targetcamera-to-uitargetcamera>Rename TargetCamera to UiTargetCamera</a><li><a href=#borderrect-maintenance>BorderRect maintenance</a></ul><li><a href=#scenes>Scenes</a> <ul><li><a href=#only-despawn-scene-entities-still-in-the-hierarchy>Only despawn scene entities still in the hierarchy</a></ul><li><a href=#tasks>Tasks</a> <ul><li><a href=#support-on-thread-spawn-and-on-thread-destroy-for-taskpoolplugin>Support on_thread_spawn and on_thread_destroy for TaskPoolPlugin</a></ul><li><a href=#text>Text</a> <ul><li><a href=#add-byte-information-to-positionedglyph>Add byte information to PositionedGlyph</a><li><a href=#remove-the-atlas-scaling-field-from-extracteduiitem-glyphs>Remove the atlas_scaling field from ExtractedUiItem::Glyphs.</a><li><a href=#add-line-height-to-textfont>add line height to TextFont</a></ul><li><a href=#ui>UI</a> <ul><li><a href=#fixing-valarithmeticerror-typo-and-unused-variant>Fixing ValArithmeticError typo and unused variant</a><li><a href=#move-textureatlas-into-uiimage-and-remove-impl-component-for-textureatlas>Move TextureAtlas into UiImage and remove impl Component for TextureAtlas</a><li><a href=#multiple-box-shadow-support>Multiple box shadow support</a><li><a href=#only-use-physical-coords-internally-in-bevy-ui>Only use physical coords internally in bevy_ui</a><li><a href=#remove-custom-rounding>Remove custom rounding</a><li><a href=#remove-the-min-and-max-fields-from-layoutcontext>Remove the min and max fields from LayoutContext.</a><li><a href=#rename-uiboxshadowsamples-to-boxshadowsamples>Rename UiBoxShadowSamples to BoxShadowSamples.</a><li><a href=#uiimage-imagenode-uiimagesize-imagenodesize>UiImage -> ImageNode, UiImageSize -> ImageNodeSize</a></ul><li><a href=#windowing>Windowing</a> <ul><li><a href=#make-customcursor-variants-customcursorimage-customcursorurl-structs>Make CustomCursor variants CustomCursorImage/CustomCursorUrl structs</a><li><a href=#make-rawhandlewrapper-fields-private-to-save-users-from-themselves>Make RawHandleWrapper fields private to save users from themselves</a><li><a href=#rework-windowmode-fullscreen-api>Rework WindowMode::Fullscreen API</a><li><a href=#support-texture-atlases-in-customcursor-image>Support texture atlases in CustomCursor::Image</a></ul><li><a href=#utils>Utils</a> <ul><li><a href=#bevy-utils-refactor>bevy_utils Refactor</a></ul><li><a href=#without-area>Without area</a> <ul><li><a href=#link-ios-example-with-rustc-and-avoid-c-trampoline>Link iOS example with rustc, and avoid C trampoline</a><li><a href=#remove-image-from-buffer-name-argument-only-present-in-debug-dds-builds>Remove Image::from_buffer name argument (only present in debug "dds" builds)</a><li><a href=#remove-bevy-core>Remove bevy_core</a><li><a href=#rename-trigger-entity-to-trigger-target>Rename trigger.entity() to trigger.target()</a><li><a href=#use-target-abi-sim-instead-of-ios-simulator-feature>Use target_abi = "sim" instead of ios_simulator feature</a></ul></ul></nav></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-14-to-0-15/>0.14 to 0.15</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-13-to-0-14/>0.13 to 0.14</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-12-to-0-13/>0.12 to 0.13</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-11-to-0-12/>0.11 to 0.12</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-10-to-0-11/>0.10 to 0.11</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-9-to-0-10/>0.9 to 0.10</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-8-to-0-9/>0.8 to 0.9</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-7-to-0-8/>0.7 to 0.8</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-6-to-0-7/>0.6 to 0.7</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-5-to-0-6/>0.5 to 0.6</a></div><li class=tree-menu__item><div class=tree-menu__label><a class=tree-menu__link href=/learn/migration-guides/0-4-to-0-5/>0.4 to 0.5</a></div></ul></div></div><div class=page-with-menu__content><div class=docs-page><div class=docs-content><h1>Migration Guide: 0.15 to 0.16</h1><div class=media-content><p>The most important changes to be aware of this release are:<ul><li>Bevy has reworked its error handling to make it easier to handle <code>Result</code>s everywhere. As a result, <code>Query::single</code> and friends now return results, rather than panicking.<li>Bevy's ECS now has built-in one-to-many entity relationships. The existing parent-child hierarchy system has been modified to use these relationships, causing minor breaking changes in entity despawning behavior and how children are added / replaced for a parent entity.<li>The <code>bevy</code> crate now supports <code>no_std</code> platforms. As part of this, many items (like <code>HashMap</code>) from <code>bevy_utils</code> have been moved into <code>bevy_platform</code>. If you are the author of an ecosystem crate, you may want to offer <code>no_std</code> support to your users as well: it's generally straightforward unless you're interfacing directly with the underlying operating system.</ul><aside class="callout callout--warning"><p>Bevy relies heavily on improvements in the Rust language and compiler. As a result, the Minimum Supported Rust Version (MSRV) is "the latest stable release" of Rust.</aside><div class=migration-guide><h2 id=accessibility>Accessibility <a class=anchor-link href=#accessibility>#</a></h2><h3 id=replace-bevy-a11y-focus-with-bevy-input-focus-inputfocus>Replace <code>bevy::a11y::Focus</code> with <code>bevy::input_focus::InputFocus</code> <a class=anchor-link href=#replace-bevy-a11y-focus-with-bevy-input-focus-inputfocus>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Accessibility</span>, <span class=heading-meta__item>Input</span>, <span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16863>#16863</a></div></div><p>Bevy now has first-class input handling, available in the <code>bevy::input_focus</code> module. As such, <code>bevy::a11y::Focus</code> has been replaced with <code>bevy::input_focus::InputFocus</code>. Please replace all references and imports.<h2 id=animation>Animation <a class=anchor-link href=#animation>#</a></h2><h3 id=configure-easingfunction-steps-jumping-with-jumpat>Configure <code>EasingFunction::Steps</code> jumping with <code>JumpAt</code> <a class=anchor-link href=#configure-easingfunction-steps-jumping-with-jumpat>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Animation</span>, <span class=heading-meta__item>Math</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17752>#17752</a></div></div><p><code>EaseFunction::Steps</code> now has a second parameter, <code>JumpAt</code>, which can customize jumping behavior. <code>JumpAt</code>'s default is <code>JumpAt::End</code>, which indicates that the last steps happens when the animation ends.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> ease_function <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">EaseFunction<span class="z-punctuation z-accessor z-rust">::</span></span>Steps<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">10</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> ease_function <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">EaseFunction<span class="z-punctuation z-accessor z-rust">::</span></span>Steps<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">10</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">JumpAt<span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><hr><h3 id=fix-easefunction-exponential-to-be-continuous>Fix <code>EaseFunction::Exponential*</code> to be continuous <a class=anchor-link href=#fix-easefunction-exponential-to-be-continuous>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Animation</span>, <span class=heading-meta__item>Math</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16910>#16910</a></div></div><p><code>EaseFunction::ExponentialIn</code>, <code>EaseFunction::ExponentialOut</code>, and <code>EaseFunction::ExponentialInOut</code> has slight discontinuities in 0.15, leading to <a href=https://github.com/bevyengine/bevy/issues/16676>jumping behavior at the start and end of the function</a>. In 0.16, these functions have been slightly adjusted so that they are continuous.<p>The new functions differ from the old by less than 0.001, so in most cases this change is not breaking. If, however, you depend on these easing functions for determinism, you will need to define custom curves using the previous functions.<h2 id=assets>Assets <a class=anchor-link href=#assets>#</a></h2><h3 id=remove-meta-field-from-loadedasset-and-erasedloadedasset>Remove <code>meta</code> field from <code>LoadedAsset</code> and <code>ErasedLoadedAsset</code> <a class=anchor-link href=#remove-meta-field-from-loadedasset-and-erasedloadedasset>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Assets</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/15487>#15487</a></div></div><p><code>LoadedAsset</code> used to have a <code>meta</code> field for storing metadata. This field was unused and inaccessible, however, so in 0.16 it has been removed. Due to this change, several method signatures have also changed:<ul><li><code>ErasedAssetLoader::load()</code> now takes <code>meta: &(dyn AssetMetaDyn + 'static)</code> instead of a <code>Box&LTdyn AssetMetaDyn></code>.<li><code>LoadedAsset::new_with_dependencies()</code> no longer requires a <code>meta</code> argument.<li><code>LoadContext::finish()</code> no longer requires a <code>meta</code> argument.</ul><hr><h3 id=deprecate-handle-weak-from-u128>Deprecate <code>Handle::weak_from_u128()</code> <a class=anchor-link href=#deprecate-handle-weak-from-u128>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Assets</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17695>#17695</a></div></div><p><code>Handle::weak_from_u128()</code> has been deprecated in favor of the new <code>weak_handle!</code> macro, which takes a UUID as a string instead of a <code>u128</code>. <code>weak_handle!</code> is preferred because it both makes the string form of the UUID visible and it verifies that the UUID is compliant with UUIDv4.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">const</span> <span class="z-constant z-other z-rust">SHADER</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Handle<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Shader<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">Handle<span class="z-punctuation z-accessor z-rust">::</span></span>weak_from_u128<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">314685653797097581405914117016993910609</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">const</span> <span class="z-constant z-other z-rust">SHADER</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Handle<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Shader<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-support z-macro z-rust">weak_handle!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>1347c9b7-c46a-48e7-b7b8-023a354b7cac<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><hr><h3 id=add-assetchanged-query-filter>Add <code>AssetChanged</code> query filter <a class=anchor-link href=#add-assetchanged-query-filter>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Assets</span>, <span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16810>#16810</a></div></div><p>The <code>Assets::asset_events()</code> system is no longer public. If you wish to order your systems relative to asset events, use the new <code>AssetEvents</code> system set instead.<h2 id=audio>Audio <a class=anchor-link href=#audio>#</a></h2><h3 id=add-ability-to-mute-audio-sinks>Add ability to mute audio sinks <a class=anchor-link href=#add-ability-to-mute-audio-sinks>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Audio</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16813>#16813</a></div></div><p>It is now possible to mute audio sinks. Several breaking changes have been introduced to implement this feature.<p>First, <code>AudioSinkPlayback::set_volume()</code> now takes a mutable <code>&mut AudioSinkPlayback</code> argument instead of an immutable one. This may require you to update your system parameters:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">increase_volume</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">sink</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Single<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span>AudioSink, <span class="z-meta z-generic z-rust">With<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Music<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    sink<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">set_volume</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>sink<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">volume</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-arithmetic z-rust">+</span> <span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">1</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">increase_volume</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">sink</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Single<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> AudioSink, <span class="z-meta z-generic z-rust">With<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Music<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> current_volume <span class="z-keyword z-operator z-assignment z-rust">=</span> sink<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">volume</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    sink<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">set_volume</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>current_volume <span class="z-keyword z-operator z-arithmetic z-rust">+</span> <span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">1</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>Secondly, <code>PlaybackSettings</code> has a new <code>muted</code> field to specify whether an entity should start muted. You may need to set this field when creating <code>PlaybackSettings</code> if you do not use function update syntax (<code>..default()</code>).<p>Finally, if you manually implemented audio muting using an audio sink's volume, you can switch over to using the new <code>AudioSinkPlayback</code> methods: <code>is_muted()</code>, <code>mute()</code>, <code>unmute()</code> and <code>toggle_mute()</code>.<hr><h3 id=rename-audiosinkplayback-toggle-to-toggle-playback>Rename <code>AudioSinkPlayback::toggle()</code> to <code>toggle_playback()</code> <a class=anchor-link href=#rename-audiosinkplayback-toggle-to-toggle-playback>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Audio</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16837>#16837</a></div></div><p><code>AudioSinkPlayback::toggle()</code> has been renamed to <code>toggle_playback()</code>. This was done to create consistency with the <code>toggle_mute()</code> method added in <a href=https://github.com/bevyengine/bevy/pull/16813>#16813</a>. Please update all references to use the new name.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">pause</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">keyboard_input</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-meta z-generic z-rust">ButtonInput<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>KeyCode<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>, <span class="z-variable z-parameter z-rust">sink</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Single<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span>AudioSink<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">if</span> keyboard_input<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">just_pressed</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">KeyCode<span class="z-punctuation z-accessor z-rust">::</span></span>Space</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        sink<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">toggle</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">pause</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">keyboard_input</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-meta z-generic z-rust">ButtonInput<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>KeyCode<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>, <span class="z-variable z-parameter z-rust">sink</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Single<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span>AudioSink<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">if</span> keyboard_input<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">just_pressed</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">KeyCode<span class="z-punctuation z-accessor z-rust">::</span></span>Space</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        sink<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">toggle_playback</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><hr><h3 id=support-decibels-in-volume>Support decibels in <code>Volume</code> <a class=anchor-link href=#support-decibels-in-volume>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Audio</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17605>#17605</a></div></div><p>Audio volume can now be configured using decibel values, as well as using linear scale values. To enable this, some types and functions in <code>bevy::audio</code> have changed. First, <code>Volume</code> is now an enum with <code>Linear</code> and <code>Decibels</code> variants:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> v <span class="z-keyword z-operator z-assignment z-rust">=</span> Volume<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-float z-rust">1.</span><span class="z-constant z-numeric z-float z-rust">0</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> volume <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">Volume<span class="z-punctuation z-accessor z-rust">::</span></span>Linear<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-float z-rust">1.</span><span class="z-constant z-numeric z-float z-rust">0</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Alternatively, you can use decibels instead.
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> volume <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">Volume<span class="z-punctuation z-accessor z-rust">::</span></span>Decibels<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">0</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p><code>Volume::Linear</code> is equivalent to the old <code>f32</code> volume.<p>With this change, <code>AudioSinkPlayback</code>'s volume-related methods (<code>volume()</code> and <code>set_volume()</code>) and <code>GlobalVolume</code> now deal in <code>Volume</code>s rather than <code>f32</code>s.<p>Finally, <code>Volume::ZERO</code> has been renamed to the more semantically correct <code>Volume::SILENT</code>. This is because 0 decibels is equivalent to "normal volume", which could lead to confusion with the old naming.<h2 id=cross-cutting>Cross-Cutting <a class=anchor-link href=#cross-cutting>#</a></h2><h3 id=add-no-std-support-to-bevy>Add <code>no_std</code> support to <code>bevy</code> <a class=anchor-link href=#add-no-std-support-to-bevy>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Cross-Cutting</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17955>#17955</a></div></div><p>The main <code>bevy</code> crate now officially supports <code>no_std</code>. As part of this change, some functionality that used to always be included in <code>bevy</code> is now behind feature flags. The features of note are:<ul><li><code>default_no_std</code><li><code>bevy_log</code><li><code>bevy_input_focus</code><li><code>async_executor</code><li><code>std</code><li><code>critical-section</code><li><code>libm</code></ul><p>Additionally, if you depend on <code>bevy_reflect</code> directly, its <code>bevy</code> feature flag has been split into two separate flags: <code>smallvec</code> and <code>smol_str</code> for their corresponding types.<h4 id=for-application-authors>For application authors <a class=anchor-link href=#for-application-authors>#</a></h4><p>If your application has default features enabled, congratulations! You don't need to do anything extra! If your application has <code>default-features = false</code>, however, you may need to enabled the <code>std</code> and <code>async_executor</code> features:<pre class="language-toml z-code" data-lang=toml><code class=language-toml data-lang=toml><span class="z-source z-toml"><span class="z-comment z-line z-number-sign z-toml"><span class="z-punctuation z-definition z-comment z-toml">#</span> 0.15</span>
</span><span class="z-source z-toml"><span class="z-punctuation z-definition z-table z-begin z-toml">[</span><span class="z-meta z-tag z-table z-toml"><span class="z-entity z-name z-table z-toml">dependencies</span></span><span class="z-punctuation z-definition z-table z-end z-toml">]</span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">bevy</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-inline-table z-begin z-toml">{</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">version</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>0.15<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-separator z-inline-table z-toml">,</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">default-features</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-constant z-language z-toml">false</span> <span class="z-punctuation z-definition z-inline-table z-end z-toml">}</span>
</span><span class="z-source z-toml">
</span><span class="z-source z-toml"><span class="z-comment z-line z-number-sign z-toml"><span class="z-punctuation z-definition z-comment z-toml">#</span> 0.16</span>
</span><span class="z-source z-toml"><span class="z-punctuation z-definition z-table z-begin z-toml">[</span><span class="z-meta z-tag z-table z-toml"><span class="z-entity z-name z-table z-toml">dependencies</span></span><span class="z-punctuation z-definition z-table z-end z-toml">]</span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">bevy</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-inline-table z-begin z-toml">{</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">version</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>0.16<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-separator z-inline-table z-toml">,</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">default-features</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-constant z-language z-toml">false</span><span class="z-punctuation z-separator z-inline-table z-toml">,</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">features</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-array z-begin z-toml">[</span><span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>std<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-separator z-array z-toml">,</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>async_executor<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-definition z-array z-end z-toml">]</span> <span class="z-punctuation z-definition z-inline-table z-end z-toml">}</span>
</span></code></pre><h4 id=for-library-authors>For library authors <a class=anchor-link href=#for-library-authors>#</a></h4><p>It is recommended for libraries to depend on Bevy with <code>default-features = false</code> to give developers more control over what features are enabled. Here are some recommended features that a library crate may want to expose:<pre class="language-toml z-code" data-lang=toml><code class=language-toml data-lang=toml><span class="z-source z-toml"><span class="z-punctuation z-definition z-table z-begin z-toml">[</span><span class="z-meta z-tag z-table z-toml"><span class="z-entity z-name z-table z-toml">features</span></span><span class="z-punctuation z-definition z-table z-end z-toml">]</span>
</span><span class="z-source z-toml"><span class="z-comment z-line z-number-sign z-toml"><span class="z-punctuation z-definition z-comment z-toml">#</span> Most users will be on a platform which has `std` and can use the more-powerful `async_executor`.</span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">default</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-array z-begin z-toml">[</span><span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>std<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-separator z-array z-toml">,</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>async_executor<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-definition z-array z-end z-toml">]</span>
</span><span class="z-source z-toml">
</span><span class="z-source z-toml"><span class="z-comment z-line z-number-sign z-toml"><span class="z-punctuation z-definition z-comment z-toml">#</span> Features for typical platforms.</span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">std</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-array z-begin z-toml">[</span><span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>bevy/std<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-definition z-array z-end z-toml">]</span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">async_executor</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-array z-begin z-toml">[</span><span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>bevy/async_executor<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-definition z-array z-end z-toml">]</span>
</span><span class="z-source z-toml">
</span><span class="z-source z-toml"><span class="z-comment z-line z-number-sign z-toml"><span class="z-punctuation z-definition z-comment z-toml">#</span> Features for `no_std` platforms.</span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">libm</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-array z-begin z-toml">[</span><span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>bevy/libm<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-definition z-array z-end z-toml">]</span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">critical-section</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-array z-begin z-toml">[</span><span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>bevy/critical-section<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-definition z-array z-end z-toml">]</span>
</span><span class="z-source z-toml">
</span><span class="z-source z-toml"><span class="z-punctuation z-definition z-table z-begin z-toml">[</span><span class="z-meta z-tag z-table z-toml"><span class="z-entity z-name z-table z-toml">dependencies</span></span><span class="z-punctuation z-definition z-table z-end z-toml">]</span>
</span><span class="z-source z-toml"><span class="z-comment z-line z-number-sign z-toml"><span class="z-punctuation z-definition z-comment z-toml">#</span> We disable default features to ensure we don't accidentally enable `std` on `no_std` targets, for</span>
</span><span class="z-source z-toml"><span class="z-comment z-line z-number-sign z-toml"><span class="z-punctuation z-definition z-comment z-toml">#</span> example. </span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">bevy</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-inline-table z-begin z-toml">{</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">version</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>0.16<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-separator z-inline-table z-toml">,</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">default-features</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-constant z-language z-toml">false</span> <span class="z-punctuation z-definition z-inline-table z-end z-toml">}</span>
</span></code></pre><hr><h3 id=support-for-non-browser-wasm>Support for non-browser WASM <a class=anchor-link href=#support-for-non-browser-wasm>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Cross-Cutting</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17499>#17499</a></div></div><p>Bevy now has support for the <a href=https://doc.rust-lang.org/rustc/platform-support/wasm32v1-none.html><code>wasm32v1-none</code> target</a>, which is a barebones <code>no_std</code> version of <code>wasm32-unknown-unknown</code> that disables all features past the original <a href=https://www.w3.org/TR/wasm-core-1/>W3C WebAssembly Core 1.0 spec</a>. As part of this change, Bevy's browser-specific WASM features have been put behind of the <code>web</code> feature flag, which is enabled by default. If you have <code>default-features = false</code> and wish to build Bevy to run on a browser, you will need to re-enable this flag:<pre class="language-toml z-code" data-lang=toml><code class=language-toml data-lang=toml><span class="z-source z-toml"><span class="z-comment z-line z-number-sign z-toml"><span class="z-punctuation z-definition z-comment z-toml">#</span> 0.15</span>
</span><span class="z-source z-toml"><span class="z-punctuation z-definition z-table z-begin z-toml">[</span><span class="z-meta z-tag z-table z-toml"><span class="z-entity z-name z-table z-toml">dependencies</span></span><span class="z-punctuation z-definition z-table z-end z-toml">]</span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">bevy</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-inline-table z-begin z-toml">{</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">version</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>0.15<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-separator z-inline-table z-toml">,</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">default-features</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-constant z-language z-toml">false</span> <span class="z-punctuation z-definition z-inline-table z-end z-toml">}</span>
</span><span class="z-source z-toml">
</span><span class="z-source z-toml"><span class="z-comment z-line z-number-sign z-toml"><span class="z-punctuation z-definition z-comment z-toml">#</span> 0.16</span>
</span><span class="z-source z-toml"><span class="z-punctuation z-definition z-table z-begin z-toml">[</span><span class="z-meta z-tag z-table z-toml"><span class="z-entity z-name z-table z-toml">dependencies</span></span><span class="z-punctuation z-definition z-table z-end z-toml">]</span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">bevy</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-inline-table z-begin z-toml">{</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">version</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>0.16<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-separator z-inline-table z-toml">,</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">default-features</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-constant z-language z-toml">false</span><span class="z-punctuation z-separator z-inline-table z-toml">,</span> <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">features</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-punctuation z-definition z-array z-begin z-toml">[</span><span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">"</span>web<span class="z-punctuation z-definition z-string z-end z-toml">"</span></span><span class="z-punctuation z-definition z-array z-end z-toml">]</span> <span class="z-punctuation z-definition z-inline-table z-end z-toml">}</span>
</span></code></pre><hr><h3 id=upgrade-to-rust-edition-2024>Upgrade to Rust Edition 2024 <a class=anchor-link href=#upgrade-to-rust-edition-2024>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Cross-Cutting</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17967>#17967</a></div></div><p>As part of Bevy's migration to <a href=https://blog.rust-lang.org/2025/02/20/Rust-1.85.0.html#rust-2024>Rust 2024</a>, the lifetimes of several functions that use return-position impl-trait (RPIT) syntax may have been changed to be slightly more conservative. If you run into lifetime issues with functions that return <code>impl Trait</code>, please <a href=https://github.com/bevyengine/bevy/issues>create a new issue</a>.<h2 id=dev-tools>Dev-Tools <a class=anchor-link href=#dev-tools>#</a></h2><h3 id=add-strict-field-to-brp-bevy-query>Add <code>strict</code> field to BRP <code>bevy/query</code> <a class=anchor-link href=#add-strict-field-to-brp-bevy-query>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Dev-Tools</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16725>#16725</a></div></div><p>Bevy Remote Protocol's <code>bevy/query</code> request now skips missing or invalid components by default instead of returning an error. This can be configured with <code>BrpQueryParams</code>'s new <code>strict</code> boolean field.<p>If you wish <code>bevy/query</code> to return to its previous behavior of erroring on missing / invalid components, set <code>"strict": true</code>:<pre class="language-json z-code" data-lang=json><code class=language-json data-lang=json><span class="z-source z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-json">    </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>method<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>bevy/query<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json">    </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>id<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-numeric z-integer z-decimal z-json">0</span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json">    </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>params<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>data<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json"><span class="z-punctuation z-section z-mapping z-begin z-json">{</span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-json">            </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>components<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-sequence z-json"><span class="z-punctuation z-section z-sequence z-begin z-json">[</span><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>foo::bar::MyComponent<span class="z-punctuation z-definition z-string z-end z-json">"</span></span><span class="z-punctuation z-section z-sequence z-end z-json">]</span></span>
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span><span class="z-punctuation z-separator z-mapping z-pair z-json">,</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        <span class="z-comment z-line z-double-slash z-js"><span class="z-punctuation z-definition z-comment z-json">//</span> Error if `foo::bar::MyComponent` doesn't exist.
</span></span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">        </span><span class="z-meta z-mapping z-key z-json"><span class="z-string z-quoted z-double z-json"><span class="z-punctuation z-definition z-string z-begin z-json">"</span>strict<span class="z-punctuation z-definition z-string z-end z-json">"</span></span></span><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-separator z-mapping z-key-value z-json">:</span> </span><span class="z-meta z-mapping z-value z-json"><span class="z-constant z-language z-json">true</span>
</span></span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-meta z-mapping z-value z-json">    <span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span></span><span class="z-source z-json"><span class="z-meta z-mapping z-value z-json"><span class="z-punctuation z-section z-mapping z-end z-json">}</span></span>
</span></code></pre><hr><h3 id=rename-track-change-detection-flag-to-track-location>Rename <code>track_change_detection</code> flag to <code>track_location</code> <a class=anchor-link href=#rename-track-change-detection-flag-to-track-location>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Dev-Tools</span>, <span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17075>#17075</a></div></div><p>The <code>track_change_detection</code> feature flag no longer just tracks the source code location for change detection, but also where entities are spawned and despawned. As such, the feature flag has been renamed to <code>track_location</code> to better reflect its extended capabilities.<hr><h3 id=draw-the-ui-debug-overlay-using-the-ui-renderer>Draw the UI debug overlay using the UI renderer <a class=anchor-link href=#draw-the-ui-debug-overlay-using-the-ui-renderer>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Dev-Tools</span>, <span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16693>#16693</a></div></div><p>The <code>bevy_dev_tools::ui_debug_overlay</code> module has been replaced with a new debug overlay implemented using <code>bevy_ui</code>'s renderer. The new debug UI overlay still requires the <code>bevy_ui_debug</code> feature flag, but this flag is now available through <code>bevy</code> and <code>bevy_ui</code> instead of <code>bevy_dev_tools</code>. <code>UiDebugOptions</code> has been moved to <code>bevy_ui</code> as well, and now has several new options.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-path z-rust">App<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_plugins</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>DefaultPlugins<span class="z-punctuation z-separator z-rust">,</span> DebugUiPlugin</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">insert_resource</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>UiDebugOptions <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">        enabled<span class="z-punctuation z-separator z-rust">:</span> <span class="z-constant z-language z-rust">true</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">run</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-path z-rust">App<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> You no longer need `DebugUiPlugin`; enabling the `bevy_ui_debug` feature handles this for
</span></span><span class="z-source z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> you.
</span></span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_plugins</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>DefaultPlugins</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">insert_resource</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>UiDebugOptions <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">        enabled<span class="z-punctuation z-separator z-rust">:</span> <span class="z-constant z-language z-rust">true</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">        <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> `UiDebugOptions` has a few new options, but for now we'll leave the defaults.
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">        <span class="z-keyword z-operator z-range z-rust">..</span><span class="z-support z-function z-rust">default</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">run</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><h2 id=diagnostics>Diagnostics <a class=anchor-link href=#diagnostics>#</a></h2><h3 id=allow-users-to-customize-history-length-in-frametimediagnosticsplugin>Allow users to customize history length in <code>FrameTimeDiagnosticsPlugin</code> <a class=anchor-link href=#allow-users-to-customize-history-length-in-frametimediagnosticsplugin>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Diagnostics</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17259>#17259</a></div></div><p><code>FrameTimeDiagnosticsPlugin</code> now contains two fields: <code>max_history_length</code> and <code>smoothing_factor</code>. If you manually construct this plugin and wish to retain 0.15 behavior, simply call <code>FrameTimeDiagnosticsPlugin::default()</code>. If you wish to configure the maximum history length, you may use <code>FrameTimeDiagnosticsPlugin::new()</code> instead.<h2 id=ecs>ECS <a class=anchor-link href=#ecs>#</a></h2><h3 id=improve-required-component-syntax>Improve required component syntax <a class=anchor-link href=#improve-required-component-syntax>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18555>#18555</a></div></div><p>Required component syntax has been reworked to be more intuitive with Rust's syntax. Custom-constructor requires should use the new expression-style syntax:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Component</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">require</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function-call z-rust"><span class="z-variable z-function z-rust">A</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-function-call z-rust">returns_a</span><span class="z-meta z-function-call z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Foo</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Component</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">require</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">A <span class="z-keyword z-operator z-rust">=</span> <span class="z-meta z-function-call z-rust"><span class="z-variable z-function z-rust">returns_a</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-function-call z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Foo</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>Inline-closure-constructor requires should use the inline value syntax where possible:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Component</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">require</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function-call z-rust"><span class="z-variable z-function z-rust">A</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-function-call z-rust">|| <span class="z-meta z-function-call z-rust"><span class="z-variable z-function z-rust">A</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-function-call z-rust">10</span><span class="z-meta z-function-call z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span></span><span class="z-meta z-function-call z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Foo</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Component</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">require</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function-call z-rust"><span class="z-variable z-function z-rust">A</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-function-call z-rust">10</span><span class="z-meta z-function-call z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Foo</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>In cases where that is not possible, use the expression-style syntax:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Component</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">require</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function-call z-rust"><span class="z-variable z-function z-rust">A</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-function-call z-rust">|| <span class="z-meta z-function-call z-rust"><span class="z-variable z-function z-rust">A</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-function-call z-rust">10</span><span class="z-meta z-function-call z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span></span><span class="z-meta z-function-call z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Foo</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Component</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">require</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">A <span class="z-keyword z-operator z-rust">=</span> <span class="z-meta z-function-call z-rust"><span class="z-variable z-function z-rust">A</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-function-call z-rust">10</span><span class="z-meta z-function-call z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Foo</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><hr><h3 id=get-names-of-queued-components>Get names of queued components <a class=anchor-link href=#get-names-of-queued-components>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18451>#18451</a></div></div><p>Bevy now supports queueing components to be registered with read only world access, as opposed to registering them directly with mutable access. For now, that's an implementation detail, but it opens up some exciting possibilities for the future. Today, however, it causes a breaking change.<p>In order to support getting the names of components that are queued but not registered (important for debugging), <code>Components::get_name</code> now returns <code>Option&LTCow<'_, str></code> instead of <code>Option<&str></code>. If that behavior is not desired, or you know the component is not queued, you can use <code>components.get_info().map(ComponentInfo::name)</code> instead. Similarly, <code>ScheduleGraph::conflicts_to_string</code> now returns <code>impl Iterator&LTItem = (String, String, Vec&LTCow&LTstr>>)></code> instead of <code>impl Iterator&LTItem = (String, String, Vec<&str>)></code>.<p>Because <code>Cow&LTstr></code> derefs to <code>&str</code>, most use cases can remain unchanged. If you're curious about queued registration, check out the original pr <a href=https://github.com/bevyengine/bevy/pull/18173>here</a>.<hr><h3 id=return-entitydoesnotexisterror-on-error-for-several-methods>Return <code>EntityDoesNotExistError</code> on error for several methods <a class=anchor-link href=#return-entitydoesnotexisterror-on-error-for-several-methods>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17855>#17855</a></div></div><p>The return types of several <code>World</code> and <code>UnsafeWorldCell</code> methods have been modified to return a <code>Result&LTT, EntityDoesNotExist></code>.<ul><li><code>World::inspect_entity()</code> now returns <code>Result&LTimpl Iterator&LTItem = &ComponentInfo>, EntityDoesNotExistError></code> instead of <code>impl Iterator&LTItem = &ComponentInfo></code>. As such, this method no longer panics if the entity does not exist.<li><code>World::get_entity()</code> now returns <code>EntityDoesNotExistError</code> as an error instead of <code>Entity</code>. You can still access the entity's ID through <code>EntityDoesNotExistErrorentity::entity</code>, however.<li><code>UnsafeWorldCell::get_entity()</code> now returns <code>Result&LTUnsafeEntityCell, EntityDoesNotExistError></code> instead of <code>Option&LTUnsafeEntityCell></code>, giving you access to the entity's ID and other details on the error.</ul><hr><h3 id=cache-systems-by-s-instead-of-s-system>Cache systems by <code>S</code> instead of <code>S::System</code> <a class=anchor-link href=#cache-systems-by-s-instead-of-s-system>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16694>#16694</a></div></div><p>As part of a bug fix for system caching, the <code>CachedSystemId</code> resource has been changed to store an <code>Entity</code> instead of a <code>SystemId</code>. <code>CachedSystemId</code> construction has also been changed to use the <code>new()</code> method.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> cached_id <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">CachedSystemId<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-meta z-path z-rust"><span class="z-storage z-type z-rust"><span class="z-storage z-type z-rust">S</span><span class="z-punctuation z-accessor z-rust">::</span></span></span>System<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-separator z-rust">:</span><span class="z-punctuation z-separator z-rust">:</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>id</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-support z-macro z-rust">assert!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>id <span class="z-keyword z-operator z-comparison z-rust">==</span> cached_id<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-constant z-numeric z-integer z-decimal z-rust">0</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> cached_id <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">CachedSystemId<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>S<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>id</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> You can convert a valid `Entity` into a `Systemid` with `SystemId::from_entity()`.
</span></span><span class="z-source z-rust"><span class="z-support z-macro z-rust">assert!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>id <span class="z-keyword z-operator z-comparison z-rust">==</span> <span class="z-meta z-path z-rust">SystemId<span class="z-punctuation z-accessor z-rust">::</span></span>from_entity<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>cached_id<span class="z-punctuation z-accessor z-dot z-rust">.</span>entity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><hr><h3 id=change-world-try-despawn-and-world-try-insert-batch-to-return-result>Change <code>World::try_despawn()</code> and <code>World::try_insert_batch()</code> to return <code>Result</code> <a class=anchor-link href=#change-world-try-despawn-and-world-try-insert-batch-to-return-result>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17376>#17376</a></div></div><p><code>World::try_despawn()</code> now returns a <code>Result</code> rather than a <code>bool</code>. Additionally, <code>World::try_insert_batch()</code> and <code>World::try_insert_batch_if_new()</code> now return a <code>Result</code> instead of silently failing.<hr><h3 id=remove-intosystemconfigs-implementation-for-boxedsystem>Remove <code>IntoSystemConfigs</code> implementation for <code>BoxedSystem<(), ()></code> <a class=anchor-link href=#remove-intosystemconfigs-implementation-for-boxedsystem>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17051>#17051</a></div></div><p><code>bevy::ecs::IntoSystemConfigs</code>, now known as <code>IntoScheduleConfigs</code>, is no longer implemented for <code>BoxedSystem<(), ()></code>. This can lead to convoluted trait errors when you try to add a <code>BoxedSystem<(), ()></code> to a schedule or app:<pre class=z-code><code><span class="z-text z-plain">error[E0277]: `std::boxed::Box&LTdyn bevy::prelude::System&LTIn = (), Out = ()>>` does not describe a valid system configuration
</span></code></pre><p>In order to avoid this error, either wrap your system in an <code>InfallibleSystemWrapper</code> before boxing it or make the system return a <code>Result<(), BevyError></code>.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">my_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-support z-macro z-rust">println!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>Hello, world!<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Convert the function into a boxed system, which is a `Box&LTdyn System&LTIn = (), Out = ()>>`.
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> system <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-support z-type z-rust">Box</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">IntoSystem<span class="z-punctuation z-accessor z-rust">::</span></span>into_system<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>my_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">as</span> BoxedSystem<span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-path z-rust">App<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_systems</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>Startup<span class="z-punctuation z-separator z-rust">,</span> system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">run</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16 (Using `InfallibleSystemWrapper`)
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">my_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-support z-macro z-rust">println!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>Hello, world!<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Use `InfallibleSystemWrapper::new()` to make a system unconditionally return `Result::Ok`. The
</span></span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> boxed system is now a `Box&LTdyn System&LTIn = (), Out = Result<(), BevyError>>>`.
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> system <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-support z-type z-rust">Box</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">InfallibleSystemWrapper<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">IntoSystem<span class="z-punctuation z-accessor z-rust">::</span></span>into_system<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>my_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">as</span> <span class="z-meta z-generic z-rust">BoxedSystem<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">_</span>, <span class="z-keyword z-operator z-rust">_</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-path z-rust">App<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_systems</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>Startup<span class="z-punctuation z-separator z-rust">,</span> system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">run</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16 (Returning `Result<(), BevyError>`)
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">my_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-></span> Result</span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-support z-macro z-rust">println!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>Hello, world!<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-support z-type z-rust">Ok</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> The boxed system is now a `Box&LTdyn System&LTIn = (), Out = Result<(), BevyError>>>`.
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> system <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-support z-type z-rust">Box</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">IntoSystem<span class="z-punctuation z-accessor z-rust">::</span></span>into_system<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>my_system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">as</span> <span class="z-meta z-generic z-rust">BoxedSystem<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">_</span>, <span class="z-keyword z-operator z-rust">_</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-path z-rust">App<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Add the boxed system to the app.
</span></span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_systems</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>Startup<span class="z-punctuation z-separator z-rust">,</span> system</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">run</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>Note that in several cases you do not need to box your systems before adding them, such as with <code>App::add_systems()</code>, which lets you avoid this issue.<hr><h3 id=improve-ergonomics-of-nonsendmarker>Improve ergonomics of <code>NonSendMarker</code> <a class=anchor-link href=#improve-ergonomics-of-nonsendmarker>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18301>#18301</a></div></div><p><code>NonSendMarker</code>, a type used to force systems to run on the main thread, is now a system parameter. This means that it no longer needs to be wrapped in <code>Option&LTNonSend<_>></code>. Furthermore, <code>NonSendMarker</code> has been moved from <code>bevy::core</code> to <code>bevy::ecs::system</code>, so please update your imports accordingly.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-keyword z-other z-rust">use</span> <span class="z-meta z-path z-rust">bevy<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">core<span class="z-punctuation z-accessor z-rust">::</span></span>NonSendMarker<span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">my_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">_</span>: <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Option</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-meta z-generic z-rust">NonSend<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>NonSendMarker<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-keyword z-other z-rust">use</span> <span class="z-meta z-path z-rust">bevy<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">ecs<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">system<span class="z-punctuation z-accessor z-rust">::</span></span>NonSendMarker<span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">my_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">_</span>: NonSendMarker</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><hr><h3 id=define-systemparam-validation-on-a-per-system-parameter-basis>Define <code>SystemParam</code> validation on a per-system parameter basis <a class=anchor-link href=#define-systemparam-validation-on-a-per-system-parameter-basis>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18504>#18504</a></div></div><p>Various system and system parameter validation methods (<code>SystemParam::validate_param</code>, <code>System::validate_param</code> and <code>System::validate_param_unsafe</code>) now return and accept a <code>ValidationOutcome</code> enum, rather than a <code>bool</code>. The previous <code>true</code> values map to <code>ValidationOutcome::Valid</code>, while <code>false</code> maps to <code>ValidationOutcome::Invalid</code>.<p>However, if you wrote a custom schedule executor, you should now respect the new <code>ValidationOutcome::Skipped</code> parameter, skipping any systems whose validation was skipped. By contrast, <code>ValidationOutcome::Invalid</code> systems should also be skipped, but you should call the <code>default_error_handler</code> on them first, which by default will result in a panic.<p>If you are implementing a custom <code>SystemParam</code>, you should consider whether failing system param validation is an error or an expected state, and choose between <code>Invalid</code> and <code>Skipped</code> accordingly. In Bevy itself, <code>Single</code> and <code>Populated</code> now once again skip the system when their conditions are not met. This is the 0.15.0 behavior, but stands in contrast to the 0.15.1 behavior, where they would panic.<hr><h3 id=deprecate-insert-or-spawn-function-family>Deprecate <code>insert_or_spawn()</code> function family <a class=anchor-link href=#deprecate-insert-or-spawn-function-family>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18147>#18147</a></div></div><p>The following functions have been deprecated:<ul><li><code>Commands::insert_or_spawn_batch()</code><li><code>World::insert_or_spawn_batch()</code><li><code>World::insert_or_spawn_batch_with_caller()</code><li><code>Entities::alloc_at()</code></ul><p>These methods, when used incorrectly, can cause major performance problems and are generally viewed as anti-patterns and foot guns. These are planned to be removed altogether in 0.17.<p>Instead of the above functions, consider doing one of the following:<ol><li>Use the new <code>Disabled</code> component. Instead of despawning entities, simply disable them until you need them again. You can even use <code>Commands::try_insert_batch()</code> and <code>EntityCommands::remove()</code> to adjust what components an entity has.<li>Instead of despawning and respawning entities with the same <code>Entity</code> ID, simply use <code>spawn_batch()</code> and update the IDs to the new values.</ol><hr><h3 id=deprecate-query-many-and-query-many-mut>Deprecate <code>Query::many()</code> and <code>Query::many_mut()</code> <a class=anchor-link href=#deprecate-query-many-and-query-many-mut>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18183>#18183</a></div></div><p>Due to improvements in <strong>Bevy 0.16</strong>'s error handling capabilities, <code>Query::many()</code> and <code>Query::many_mut()</code> have been deprecated in favor of their non-panicking variants: <code>Query::get_many()</code> and <code>Query::get_many_mut()</code>.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Resource</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Player1</span></span><span class="z-meta z-struct z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>Entity</span><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Resource</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Player2</span></span><span class="z-meta z-struct z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>Entity</span><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">my_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">player1</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Player1<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>, <span class="z-variable z-parameter z-rust">player2</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Player2<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>, <span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span>Transform<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>transform1<span class="z-punctuation z-separator z-rust">,</span> transform2<span class="z-punctuation z-section z-group z-end z-rust">]</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">many</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>player1<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-constant z-numeric z-integer z-decimal z-rust">0</span><span class="z-punctuation z-separator z-rust">,</span> player2<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-constant z-numeric z-integer z-decimal z-rust">0</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Make the system return a `Result`, which is automatically imported in Bevy's prelude.
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">my_system</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">player1</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Player1<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>, <span class="z-variable z-parameter z-rust">player2</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Res<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Player2<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>, <span class="z-variable z-parameter z-rust">query</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust">Query<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span>Transform<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-></span> Result</span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Use `get_many()` and the `?` operator to return early on an error.
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>transform1<span class="z-punctuation z-separator z-rust">,</span> transform2<span class="z-punctuation z-section z-group z-end z-rust">]</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get_many</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>player1<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-constant z-numeric z-integer z-decimal z-rust">0</span><span class="z-punctuation z-separator z-rust">,</span> player2<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-constant z-numeric z-integer z-decimal z-rust">0</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-keyword z-operator z-rust">?</span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-support z-type z-rust">Ok</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>Please note that <code>Query::get_many()</code> is very similar to <code>Query::get()</code>. To increase the consistency between the two methods, the name <code>get_many()</code> was kept over plain <code>many()</code>. Although in 0.15 <code>Query::many()</code> seemed similar to <code>Query::single()</code> due to their naming, they are quite distinct. This change is meant to reinforce this distinction.<hr><h3 id=encapsulate-location-tracking-data-into-maybelocation>Encapsulate location tracking data into <code>MaybeLocation</code> <a class=anchor-link href=#encapsulate-location-tracking-data-into-maybelocation>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17602>#17602</a></div></div><p>Methods like <code>Ref::changed_by()</code> that used to return a <code>&'static Location<'static></code> will now be available even when the <code>track_location</code> feature is disabled, but they will now return the new <code>MaybeLocation</code> type. <code>MaybeLocation</code> wraps a <code>&'static Location<'static></code> when the feature is enabled, and is a ZST when the feature is disabled.<p>Existing code that needs a <code>&Location</code> can call <code>MaybeLocation::into_option()</code> to recover it. Many trait impls are forwarded, so if you only need <code>Display</code> then no changes will be necessary.<p>If that code was conditionally compiled, you may instead want to use the methods on <code>MaybeLocation</code> to remove the need for conditional compilation.<p>Code that constructs a <code>Ref</code>, <code>Mut</code>, <code>Res</code>, or <code>ResMut</code> will now need to provide location information unconditionally. If you are creating them from existing Bevy types, you can obtain a <code>MaybeLocation</code> from methods like <code>Table::get_changed_by_slice_for()</code> or <code>ComponentSparseSet::get_with_ticks</code>. Otherwise, you will need to store a <code>MaybeLocation</code> next to your data and use methods like <code>as_ref()</code> or <code>as_mut()</code> to obtain wrapped references.<hr><h3 id=support-fallible-systems>Support fallible systems <a class=anchor-link href=#support-fallible-systems>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16589>#16589</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18541>#18541</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18666>#18666</a></div></div><p>If you've written a custom executor, there are a few changes you will need to make in order to support fallible systems.<ol><li>Many uses of <code>BoxedSystem<(), ()></code> have been replaced with <code>ScheduleSystem</code>, which is a type alias to <code>BoxedSystem<(), Result></code>.<li>Executors should obey the <code>SystemParamValidationError</code> returned by <code>SystemParam::validate_param()</code> in order to determine whether to raise an error or skip the system.<li>When an executor encounters an error, it should pass that error to <code>default_error_handler()</code>, whose behavior can be configured with the <code>GLOBAL_ERROR_HANDLER</code> static.</ol><p>For more information on fallible systems, please read the module docs for <code>bevy::ecs::error</code>.<hr><h3 id=fix-unsoundness-in-queryiter-sort-by>Fix unsoundness in <code>QueryIter::sort_by()</code> <a class=anchor-link href=#fix-unsoundness-in-queryiter-sort-by>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17826>#17826</a></div></div><p>The <code>sort()</code> family of methods on <code>QueryIter</code> unsoundly gave access <code>L::Item<'w></code> with the full world <code>'w</code> lifetime, meaning it was possible to smuggle items out of the compare closure. This has been fixed by shortening the lifetime so that items cannot escape the closure on the following methods on <code>QueryIter</code> and <code>QueryManyIter</code>:<ul><li><code>sort()</code><li><code>sort_unstable()</code><li><code>sort_by()</code><li><code>sort_unstable_by()</code><li><code>sort_by_key()</code><li><code>sort_unstable_by_key()</code><li><code>sort_by_cached_key()</code></ul><p>This fix may cause your code to get lifetimes errors, such as:<pre class=z-code><code><span class="z-text z-plain">error: implementation of `FnMut` is not general enough
</span></code></pre><p>To fix this, you will need to make the comparer generic over the new lifetime. Often this can be done by replacing named <code>'w</code> with <code>'_</code>, or by replacing the use of a function item with a closure:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust">query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">sort_by<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span>C<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-support z-type z-rust">Ord</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>cmp</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust">query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">sort_by<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span>C<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">|</span></span></span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-variable z-parameter z-rust">l</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-variable z-parameter z-rust">r</span><span class="z-punctuation z-section z-parameters z-end z-rust">|</span></span> </span><span class="z-meta z-function z-closure z-rust"><span class="z-support z-type z-rust">Ord</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>cmp<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>l<span class="z-punctuation z-separator z-rust">,</span> r</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">comparer</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">left</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-lifetime z-rust">'w</span> C, <span class="z-variable z-parameter z-rust">right</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span><span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-lifetime z-rust">'w</span> C</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-></span> Ordering</span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust">query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">sort_by<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span>C<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>comparer</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">comparer</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">left</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span><span class="z-keyword z-operator z-rust">&</span>C, <span class="z-variable z-parameter z-rust">right</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span><span class="z-keyword z-operator z-rust">&</span>C</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-></span> Ordering</span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust">query<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">iter</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">sort_by<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-keyword z-operator z-rust">&</span>C<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>comparer</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><hr><h3 id=flush-commands-after-every-mutation-in-worldentitymut>Flush commands after every mutation in <code>WorldEntityMut</code> <a class=anchor-link href=#flush-commands-after-every-mutation-in-worldentitymut>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16219>#16219</a></div></div><p>Previously, <code>EntityWorldMut</code> triggered command queue flushes in unpredictable places, which could interfere with hooks and observers. Now the command queue is always flushed immediately after <code>EntityWorldMut</code> spawns or despawns an entity, or adds, removes, or replaces a component.<p>As a side effect of this change, there is a new possibility that a hook or observer may despawn an entity that is being referred to by <code>EntityWorldMut</code>. If any of <code>EntityWorldMut</code>'s methods detect that the entity is despawned, they will panic. If you know this is a possibility and wish to avoid panicking, you may check that the entity is despawned with <code>EntityWorldMut::is_despawned()</code>.<hr><h3 id=make-system-configuration-generic>Make system configuration generic <a class=anchor-link href=#make-system-configuration-generic>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17962>#17962</a></div></div><p>In order to reduce internal duplication between scheduling systems and system sets, the new generic <code>ScheduleConfigs&LTT></code> type and <code>IntoScheduleConfigs&LTT></code> trait have been added. These take a generic parameter, <code>T</code>, that may be <code>ScheduleSystem</code> (for systems) or <code>InternedSystemSet</code> (for system sets).<table><thead><tr><th>0.15 Item<th>0.16 Item<tbody><tr><td><code>SystemConfigs</code><td><code>ScheduleConfigs&LTScheduleSystem></code><tr><td><code>SystemSetConfigs</code><td><code>ScheduleConfigs&LTInternedSystemSet></code><tr><td><code>IntoSystemConfigs</code><td><code>IntoScheduleConfigs&LTScheduleSystem, M></code><tr><td><code>IntoSystemSetConfigs</code><td><code>IntoScheduleConfigs&LTInternedSystemSet, M></code></table><hr><h3 id=introduce-entityworldmut-and-move-entitycommand-with-entity>Introduce <code>EntityWorldMut</code> and move <code>EntityCommand::with_entity()</code> <a class=anchor-link href=#introduce-entityworldmut-and-move-entitycommand-with-entity>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17215>#17215</a></div></div><p>The <code>EntityCommands::apply()</code> method now takes a <code>EntityWorldMut</code>, which is an optimized version of the previous <code>Entity</code> and <code>&mut World</code> pair. <code>EntityWorldMut</code> has several existing methods for working with entities, although you may use <code>EntityWorldMut::id()</code> to access the <code>Entity</code> and <code>EntityWorldMut::world_scope()</code> to access the <code>&mut World</code>.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">MyCommand</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">print_entity</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span>In<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-variable z-parameter z-rust">entity</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>: <span class="z-meta z-generic z-rust">In<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Entity<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-support z-macro z-rust">info!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>Entity: {entity}<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-storage z-type z-impl z-rust">impl</span> </span><span class="z-meta z-impl z-rust">EntityCommand <span class="z-keyword z-other z-rust">for</span></span><span class="z-meta z-impl z-rust"> <span class="z-entity z-name z-impl z-rust">MyCommand</span> </span><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">apply</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">self</span>, <span class="z-variable z-parameter z-rust">entity</span><span class="z-punctuation z-separator z-rust">:</span> Entity, <span class="z-variable z-parameter z-rust">world</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> World</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        world
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">            <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">run_system_cached_with</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>print_entity<span class="z-punctuation z-separator z-rust">,</span> entity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">            <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-storage z-type z-impl z-rust">impl</span> </span><span class="z-meta z-impl z-rust">EntityCommand <span class="z-keyword z-other z-rust">for</span></span><span class="z-meta z-impl z-rust"> <span class="z-entity z-name z-impl z-rust">MyCommand</span> </span><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">apply</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">self</span>, <span class="z-variable z-parameter z-rust">entity_world</span><span class="z-punctuation z-separator z-rust">:</span> EntityWorldMut</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-storage z-type z-rust">let</span> entity <span class="z-keyword z-operator z-assignment z-rust">=</span> entity_world<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">id</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        entity_world<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">world_scope</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">move</span> <span class="z-keyword z-operator z-bitwise z-rust">|</span>world<span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-bitwise z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> World<span class="z-keyword z-operator z-bitwise z-rust">|</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">            world<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">run_system_cached_with</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>print_entity<span class="z-punctuation z-separator z-rust">,</span> entity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">unwrap</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">        </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>Additionally, the method <code>EntityCommand::with_entity()</code> has been moved to a separate trait, <code>CommandWithEntity</code>, so that it can be generic over commands that return <code>Result</code>s.<hr><h3 id=add-bundle-effects>Add bundle effects <a class=anchor-link href=#add-bundle-effects>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17521>#17521</a></div></div><p>As part of improvements to the bundle spawning API, the <code>DynamicBundle</code> trait now has a new <code>Effect</code> associated type. If you manually implemented <code>DynamicBundle</code>, you likely want to set <code>Effect = ()</code>, which retains the same behavior as 0.15 bundles:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-storage z-type z-impl z-rust">impl</span> </span><span class="z-meta z-impl z-rust">DynamicBundle <span class="z-keyword z-other z-rust">for</span></span><span class="z-meta z-impl z-rust"> <span class="z-entity z-name z-impl z-rust">MyBundle</span> </span><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-storage z-type z-impl z-rust">impl</span> </span><span class="z-meta z-impl z-rust">DynamicBundle <span class="z-keyword z-other z-rust">for</span></span><span class="z-meta z-impl z-rust"> <span class="z-entity z-name z-impl z-rust">MyBundle</span> </span><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-type z-rust">type</span> <span class="z-entity z-name z-type z-rust">Effect</span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><hr><h3 id=rename-query-to-readonly-to-query-as-readonly>Rename <code>Query::to_readonly()</code> to <code>Query::as_readonly()</code> <a class=anchor-link href=#rename-query-to-readonly-to-query-as-readonly>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/15858>#15858</a></div></div><p><code>Query::to_readonly()</code> has been renamed to <code>Query::as_readonly()</code> to reflect that it is cheap to call.<hr><h3 id=isolate-component-registration-from-storages>Isolate component registration from <code>Storages</code> <a class=anchor-link href=#isolate-component-registration-from-storages>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17671>#17671</a></div></div><p>In order to decouple <code>Storages</code> from <code>Components</code>, the following methods no longer take a <code>&mut Storages</code> argument:<ul><li><code>Components::register_component()</code><li><code>Components::register_component_with_descriptor()</code><li><code>Bundle::register_required_components()</code><li><code>Component::register_required_components()</code></ul><p>With this change, note that <code>SparseSets</code> will no longer be created when components are registered. Instead, they will only be constructed when those components are spawned.<hr><h3 id=unified-error-handling>Unified error handling <a class=anchor-link href=#unified-error-handling>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18082>#18082</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18144>#18144</a></div></div><p><code>Query::single()</code>, <code>Query::single_mut()</code> and their <code>QueryState</code> equivalents now return a <code>Result</code>. Generally, you'll want to:<ul><li>Use <strong>Bevy 0.16</strong>'s system error handling to return a <code>Result</code> using the <code>?</code> operator.<li>Use a <code>let Ok(data) = result else {}</code> block to early return if there's an expected failure.<li>Use <code>unwrap()</code> or <code>Ok</code> destructuring inside of tests.</ul><p>The old <code>Query::get_single()</code> and related methods have been deprecated.<p>If you are using <code>anyhow</code>, you will experience namespace clashes between Bevy's catch-all <code>Result</code> and <code>anyhow::Result</code>. Within Bevy-specific projects, you should migrate to use the new <code>bevy::ecs::error::Result</code> due to its improved backtraces. (If you discover missing functionality, please feel free to open a pull request adding it!) For projects that support both Bevy and non-Bevy users, you should define a feature-gated type alias and avoid glob-importing <code>bevy::prelude</code>:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">cfg</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">feature <span class="z-keyword z-operator z-rust">=</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>bevy<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-storage z-type z-type z-rust">type</span> <span class="z-entity z-name z-type z-rust">Result</span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">bevy<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">ecs<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">error<span class="z-punctuation z-accessor z-rust">::</span></span>Result<span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">cfg</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function-call z-rust"><span class="z-variable z-function z-rust">not</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-function-call z-rust">feature <span class="z-keyword z-operator z-rust">=</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>bevy<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-function-call z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-storage z-type z-type z-rust">type</span> <span class="z-entity z-name z-type z-rust">Result</span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">anyhow<span class="z-punctuation z-accessor z-rust">::</span></span>Result<span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><hr><h3 id=make-system-parameter-validation-use-the-global-error-handler>Make system parameter validation use the <code>GLOBAL_ERROR_HANDLER</code> <a class=anchor-link href=#make-system-parameter-validation-use-the-global-error-handler>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18454>#18454</a></div></div><p><code>ParamWarnPolicy</code> and the <code>WithParamWarnPolicy</code> have been removed completely. Failures during system param validation are now handled via the <code>GLOBAL_ERROR_HANDLER</code>. Please see the <code>bevy_ecs::error</code> module docs for more information.<hr><h3 id=move-item-and-fetch-from-worldquery-to-querydata>Move <code>Item</code> and <code>fetch()</code> from <code>WorldQuery</code> to <code>QueryData</code> <a class=anchor-link href=#move-item-and-fetch-from-worldquery-to-querydata>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17679>#17679</a></div></div><p>The <code>WorldQuery::Item</code> associated type and <code>WorldQuery::fetch()</code> method have been moved to <code>QueryData</code>, as they were not useful for <code>QueryFilter</code>-based types.<hr><h3 id=move-resource-trait-to-its-own-module>Move <code>Resource</code> trait to its own module <a class=anchor-link href=#move-resource-trait-to-its-own-module>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17469>#17469</a></div></div><p>The <code>Resource</code> trait has been moved from <code>bevy::ecs::system::Resource</code> to <code>bevy::ecs::resource::Resource</code>. Please update your imports accordingly.<hr><h3 id=rename-entityfetcherror-and-introduce-entitydoesnotexist>Rename <code>EntityFetchError</code> and introduce <code>EntityDoesNotExist</code> <a class=anchor-link href=#rename-entityfetcherror-and-introduce-entitydoesnotexist>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17115>#17115</a></div></div><p><code>EntityFetchError</code> enum has been renamed to <code>EntityMutableFetchError</code>, and its <code>NoSuchEntity</code> variant has been renamed to <code>EntityDoesNotExist</code>. Furthermore, the <code>EntityDoesNotExist</code> variant now contains an <code>EntityDoesNotExistError</code> type, which provides further details on the entity that does not exist.<hr><h3 id=rename-parent-to-childof-and-change-how-the-parent-is-accessed>Rename <code>Parent</code> to <code>ChildOf</code> and change how the parent is accessed <a class=anchor-link href=#rename-parent-to-childof-and-change-how-the-parent-is-accessed>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17427>#17427</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18080>#18080</a></div></div><p>The <code>Parent</code> component has been renamed to <code>ChildOf</code> to make it more clear that entities with a <code>ChildOf</code> component are children, not parents.<p>Furthermore, it is now only possible to access the parent <code>Entity</code> from <code>ChildOf::parent()</code>. The <code>Deref</code> implementation has been removed and the <code>get()</code> method deprecated.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> parent <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-keyword z-operator z-arithmetic z-rust">*</span>child_of
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> parent <span class="z-keyword z-operator z-assignment z-rust">=</span> child_of<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> parent <span class="z-keyword z-operator z-assignment z-rust">=</span> child_of<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> parent <span class="z-keyword z-operator z-assignment z-rust">=</span> child_of<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre><hr><h3 id=queued-component-registration>Queued component registration <a class=anchor-link href=#queued-component-registration>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18173>#18173</a></div></div><p>Component registration can now be queued with shared access to <code>World</code>, instead of requiring mutable access (<code>&mut World</code>). To facilitate this, a few APIs have been moved around.<p>The following functions have moved from <code>Components</code> to <code>ComponentsRegistrator</code>:<ul><li><code>register_component()</code><li><code>register_component_with_descriptor()</code><li><code>register_resource_with_descriptor()</code><li><code>register_non_send()</code><li><code>register_resource()</code><li><code>register_required_components_manual()</code></ul><p>Accordingly, functions in <code>Bundle</code> and <code>Component</code> now take <code>ComponentsRegistrator</code> instead of <code>Components</code>. You can obtain <code>ComponentsRegistrator</code> from the new <code>World::components_registrator()</code> method. You can obtain <code>ComponentsQueuedRegistrator</code> from the new <code>World::components_queue()</code>, and use it to stage component registration if desired.<hr><h3 id=remove-various-structs-that-implemented-command>Remove various structs that implemented <code>Command</code> <a class=anchor-link href=#remove-various-structs-that-implemented-command>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16999>#16999</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17029>#17029</a></div></div><p>Several commands have been refactored to internally use closures instead of individual structs, and their structs have been removed.<p>If you were queuing the structs of hierarchy-related commands directly, you will need to change them to methods implemented on <code>EntityCommands</code>:<table><thead><tr><th>Struct<th>Method<tbody><tr><td><code>commands.queue(AddChild { child, parent })</code><td><code>commands.entity(parent).add_child(child)</code> OR <code>commands.entity(child).insert(ChildOf(parent))</code><tr><td><code>commands.queue(AddChildren { children, parent })</code><td><code>commands.entity(parent).add_children(children)</code><tr><td><code>commands.queue(InsertChildren { children, parent, index })</code><td><code>commands.entity(parent).insert_children(index, children)</code><tr><td><code>commands.queue(RemoveChildren { children, parent })</code><td><code>commands.entity(parent).remove_children(children)</code><tr><td><code>commands.queue(ReplaceChildren { children, parent })</code><td><code>commands.entity(parent).replace_children(children)</code><tr><td><code>commands.queue(ClearChildren { parent })</code><td><code>commands.entity(parent).remove::&LTChildren>()</code><tr><td><code>commands.queue(RemoveParent { child })</code><td><code>commands.entity(child).remove::&LTChildOf>()</code><tr><td><code>commands.queue(DespawnRecursive { entity, warn: true })</code><td><code>commands.entity(entity).despawn()</code><tr><td><code>commands.queue(DespawnRecursive { entity, warn: false })</code><td><code>commands.entity(entity).try_despawn()</code><tr><td><code>commands.queue(DespawnChildrenRecursive { entity, warn })</code><td><code>commands.entity(entity).despawn_related::&LTChildren>()</code></table><p>If you were queuing the structs of event-related commands directly, you will need to change them to methods implemented on <code>Commands</code>:<table><thead><tr><th>Struct<th>Method<tbody><tr><td><code>commands.queue(SendEvent { event })</code><td><code>commands.send_event(event)</code><tr><td><code>commands.queue(TriggerEvent { event, targets })</code><td><code>commands.trigger_targets(event, targets)</code></table><hr><h3 id=refactor-componenthook-parameters-into-hookcontext>Refactor <code>ComponentHook</code> parameters into <code>HookContext</code> <a class=anchor-link href=#refactor-componenthook-parameters-into-hookcontext>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17503>#17503</a></div></div><p>The function signature of component hooks (<code>ComponentHook</code>) has been simplified so that all arguments beyond the <code>DeferredWorld</code> is passed in a <code>HookContext</code>. Note that because <code>HookContext</code> is plain data with all public fields, you can use de-structuring to simplify migration.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">my_hook</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    <span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">world</span><span class="z-punctuation z-separator z-rust">:</span> DeferredWorld,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    <span class="z-variable z-parameter z-rust">entity</span><span class="z-punctuation z-separator z-rust">:</span> Entity,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    <span class="z-variable z-parameter z-rust">component_id</span><span class="z-punctuation z-separator z-rust">:</span> ComponentId,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">my_hook</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    <span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">world</span><span class="z-punctuation z-separator z-rust">:</span> DeferredWorld,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    HookContext { entity, component_id, caller }: HookContext,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>Likewise, if you were discarding certain parameters, you can use <code>..</code> in the de-structuring:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">my_hook</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    <span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">world</span><span class="z-punctuation z-separator z-rust">:</span> DeferredWorld,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    <span class="z-variable z-parameter z-rust">entity</span><span class="z-punctuation z-separator z-rust">:</span> Entity,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    <span class="z-keyword z-operator z-rust">_</span>: ComponentId,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">my_hook</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    <span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">world</span><span class="z-punctuation z-separator z-rust">:</span> DeferredWorld,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust">    HookContext { entity, .. }: HookContext,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><hr><h3 id=use-new-relationship-system-for-parent-child-hierarchies>Use new relationship system for parent-child hierarchies <a class=anchor-link href=#use-new-relationship-system-for-parent-child-hierarchies>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17398>#17398</a></div></div><p>Entity relationships are now built-in to the ECS, providing significant performance and user-experience improvements. There are several changes you may need in order to update your existing code.<p>First, when adding children to an entity with <code>EntityCommands::with_children()</code>, the method now passes a <code>ChildSpawnerCommands</code> type to the closure instead of a <code>ChildBuilder</code>. <code>ChildSpawnerCommands</code> is slightly different from <code>ChildBuilder</code>, but is still able to accomplish the same things as before.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn_empty</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_children</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">|</span></span></span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-variable z-parameter z-rust">builder</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-meta z-generic z-rust">ChildBuilder<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>'<span class="z-keyword z-operator z-rust">_</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-section z-parameters z-end z-rust">|</span></span> </span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Spawn a child of the parent entity;
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">    builder<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>MyComponent<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">255</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Get the `Entity` ID of the parent.
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> parent <span class="z-keyword z-operator z-assignment z-rust">=</span> builder<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">parent_entity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Queue a new `Command` to be executed.
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">    builder<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">enqueue_command</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">MyCommand<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn_empty</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_children</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">|</span></span></span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-variable z-parameter z-rust">spawner</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-meta z-generic z-rust">ChildSpawnerCommands<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>'<span class="z-keyword z-operator z-rust">_</span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-section z-parameters z-end z-rust">|</span></span> </span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">    spawner<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>MyComponent<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">255</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> `parent_entity()` is now `target_entity()`.
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> parent <span class="z-keyword z-operator z-assignment z-rust">=</span> spawner<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">target_entity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> You can now access the `Commands` struct directly, which you can then use to queue commands.
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">    spawner<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">commands</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">queue</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-support z-function z-rust">my_command</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>Furthermore, the new relationship system encourages working with the relationship components (<code>ChildOf</code>, <code>Children</code>) directly. For example, setting the parent of an entity is as simple as inserting a <code>ChildOf</code> component:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn_empty</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">set_parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn_empty</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">insert</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>ChildOf<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>Replacing the children of a parent now requires removing the <code>Children</code> component and re-adding children individually:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">entity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">replace_children</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-bitwise z-rust">&</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>child1<span class="z-punctuation z-separator z-rust">,</span> child2<span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">entity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">remove<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Children<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span><span class="z-source z-rust">    <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_children</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-bitwise z-rust">&</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>child1<span class="z-punctuation z-separator z-rust">,</span> child2<span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>Despawning has also been changed to remove the complexities of <code>despawn_recursive()</code> and <code>despawn_descendants()</code> from <code>EntityCommands</code>:<table><thead><tr><th>Action<th>0.15<th>0.16<tbody><tr><td>Despawn parent and children<td><code>despawn_recursive()</code><td><code>despawn()</code><tr><td>Despawn children<td><code>despawn_descendants()</code><td><code>despawn_related::&LTChildren>()</code><tr><td>Despawn parent<td><code>despawn()</code><td><code>remove::&LTChildren>()</code>, then <code>despawn()</code></table><pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">entity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">despawn_recursive</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">entity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">despawn_descendants</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">entity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">despawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">entity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">despawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">entity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">despawn_related<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Children<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">entity</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>parent</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">remove<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Children<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">despawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>Because relationships are now part of <code>bevy_ecs</code> itself, all methods from the previous <code>HierarchyQueryExt</code> extension trait are now inherent methods on <code>Query</code>. While these have mostly been migrated unchanged, <code>parent</code> is now <code>related</code> and <code>children</code> now <code>relationship_sources</code>, as these methods work for any relationship, not just parent-child ones.<hr><h3 id=remove-event-component-trait-bound>Remove <code>Event: Component</code> trait bound <a class=anchor-link href=#remove-event-component-trait-bound>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17380>#17380</a></div></div><p>In 0.15 the <code>Event</code> trait required the <code>Component</code> trait. This bound has been removed, as it was deemed confusing for users (events aren't typically attached to entities or queried in systems).<p>If you require an event to implement <code>Component</code> (which usually isn't the case), you may manually derive it and update your trait bounds.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Event</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">MyEvent</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">handle_event_component</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>T<span class="z-punctuation z-separator z-rust">:</span> Event<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">event_component</span><span class="z-punctuation z-separator z-rust">:</span> T</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Access some `Component`-specific property of the event.
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> storage_type <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">T<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">STORAGE_TYPE</span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Event<span class="z-punctuation z-separator z-rust">,</span> Component</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">MyEvent</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">handle_event_component</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>T<span class="z-punctuation z-separator z-rust">:</span> Event <span class="z-keyword z-operator z-rust">+</span> Component<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">event_component</span><span class="z-punctuation z-separator z-rust">:</span> T</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Access some `Component`-specific property of the event.
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">let</span> storage_type <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">T<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">STORAGE_TYPE</span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><hr><h3 id=remove-petgraph-from-bevy-ecs>Remove <code>petgraph</code> from <code>bevy::ecs</code> <a class=anchor-link href=#remove-petgraph-from-bevy-ecs>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/15519>#15519</a></div></div><p>Bevy's ECS no longer depends on the <code>petgraph</code> crate. As such, usage of <code>petgraph::graph::DiGraph</code> has been replaced with <code>bevy::ecs::schedule::graph::DiGraph</code>. This mainly affects code that uses the <code>Dag::graph()</code> method.<p>If you require the <code>petgraph</code> version of <code>DiGraph</code>, you can manually construct it by iterating over all edges and nodes in Bevy's <code>DiGraph</code>.<hr><h3 id=remove-deprecated-ecs-items>Remove deprecated ECS items <a class=anchor-link href=#remove-deprecated-ecs-items>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16853>#16853</a></div></div><p>The following <code>bevy::ecs</code> items that were deprecated in 0.15 have been removed:<ul><li><code>Events::get_reader()</code><li><code>Events::get_reader_current()</code><li><code>ManualEventReader</code><li><code>Condition::and_then()</code><li><code>Condition::or_else()</code><li><code>World::many_entities()</code><li><code>World::many_entities_mut()</code><li><code>World::get_many_entities()</code><li><code>World::get_many_entities_dynamic()</code><li><code>World::get_many_entities_mut()</code><li><code>World::get_many_entities_dynamic_mut()</code><li><code>World::get_many_entities_from_set_mut()</code></ul><hr><h3 id=remove-deprecated-component-reads-and-writes-and-family>Remove deprecated <code>component_reads_and_writes()</code> and family <a class=anchor-link href=#remove-deprecated-component-reads-and-writes-and-family>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16348>#16348</a></div></div><p>The following methods are now replaced by <code>Access::try_iter_component_access()</code>:<ul><li><code>Access::component_reads_and_writes()</code><li><code>Access::component_reads()</code><li><code>Access::component_writes()</code></ul><p>As <code>try_iter_component_access()</code> returns a <code>Result</code>, youâ€™ll now need to handle the failing case (e.g. return early from a system). There is currently a single failure mode, <code>UnboundedAccess</code>, which occurs when the <code>Access</code> is for all <code>Components</code> <em>except</em> certain exclusions. Since this list is infinite, there is no meaningful way for <code>Access</code> to provide an iterator. Instead, get a list of components (e.g. from the <code>Components</code> structure) and iterate over that instead, filtering using <code>Access::has_component_read()</code>, <code>Access::has_component_write()</code>, etc.<p>Additionally, youâ€™ll need to <code>filter_map()</code> the accesses based on which method youâ€™re attempting to replace:<table><thead><tr><th>0.15<th>0.16<tbody><tr><td><code>Access::component_reads_and_writes()</code><td><code>Exclusive(_) | Shared(_)</code><tr><td><code>Access::component_reads()</code><td><code>Shared(_)</code><tr><td><code>Access::component_writes()</code><td><code>Exclusive(_)</code></table><p>To ease migration, please consider the below extension trait which you can include in your project:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-trait z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-trait z-rust">trait</span> <span class="z-entity z-name z-trait z-rust">AccessCompatibilityExt</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-trait z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">///</span> Returns the indices of the components this has access to.
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-trait z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">component_reads_and_writes</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span><span class="z-variable z-parameter z-rust">self</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-></span> impl <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Iterator</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Item = T<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span> </span></span><span class="z-keyword z-operator z-arithmetic z-rust">+</span> <span class="z-keyword z-operator z-rust">'</span><span class="z-keyword z-operator z-rust">_</span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-trait z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-trait z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">///</span> Returns the indices of the components this has non-exclusive access to.
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-trait z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">component_reads</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span><span class="z-variable z-parameter z-rust">self</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-></span> impl <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Iterator</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Item = T<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span> </span></span><span class="z-keyword z-operator z-arithmetic z-rust">+</span> <span class="z-keyword z-operator z-rust">'</span><span class="z-keyword z-operator z-rust">_</span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-trait z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-trait z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">///</span> Returns the indices of the components this has exclusive access to.
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-trait z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">component_writes</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span><span class="z-variable z-parameter z-rust">self</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-></span> impl <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Iterator</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Item = T<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span> </span></span><span class="z-keyword z-operator z-arithmetic z-rust">+</span> <span class="z-keyword z-operator z-rust">'</span><span class="z-keyword z-operator z-rust">_</span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-trait z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-storage z-type z-impl z-rust">impl</span></span><span class="z-meta z-impl z-rust"><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>T<span class="z-punctuation z-separator z-rust">:</span> SparseSetIndex<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-impl z-rust"> AccessCompatibilityExt <span class="z-keyword z-other z-rust">for</span></span><span class="z-meta z-impl z-rust"> <span class="z-entity z-name z-impl z-rust">Access</span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>T<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span> </span><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">component_reads_and_writes</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span><span class="z-variable z-parameter z-rust">self</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-></span> impl <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Iterator</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Item = T<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span> </span></span><span class="z-keyword z-operator z-arithmetic z-rust">+</span> <span class="z-keyword z-operator z-rust">'</span><span class="z-keyword z-operator z-rust">_</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-variable z-language z-rust">self</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">            <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">try_iter_component_access</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">            <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">expect</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>Access is unbounded. Please refactor the usage of this method to directly use try_iter_component_access<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">            <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">filter_map</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">|</span></span></span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-variable z-parameter z-rust">component_access</span><span class="z-punctuation z-section z-parameters z-end z-rust">|</span></span> </span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">                <span class="z-storage z-type z-rust">let</span> index <span class="z-keyword z-operator z-assignment z-rust">=</span> component_access<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">index</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">sparse_set_index</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">                <span class="z-keyword z-control z-rust">match</span> component_access <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                    <span class="z-meta z-path z-rust">ComponentAccessKind<span class="z-punctuation z-accessor z-rust">::</span></span>Archetypal<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">_</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">=></span> <span class="z-support z-type z-rust">None</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                    <span class="z-meta z-path z-rust">ComponentAccessKind<span class="z-punctuation z-accessor z-rust">::</span></span>Shared<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">_</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">=></span> <span class="z-support z-type z-rust">Some</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>index</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                    <span class="z-meta z-path z-rust">ComponentAccessKind<span class="z-punctuation z-accessor z-rust">::</span></span>Exclusive<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">_</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">=></span> <span class="z-support z-type z-rust">Some</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>index</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">            </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">component_reads</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span><span class="z-variable z-parameter z-rust">self</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-></span> impl <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Iterator</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Item = T<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span> </span></span><span class="z-keyword z-operator z-arithmetic z-rust">+</span> <span class="z-keyword z-operator z-rust">'</span><span class="z-keyword z-operator z-rust">_</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-variable z-language z-rust">self</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">            <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">try_iter_component_access</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">            <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">expect</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>Access is unbounded. Please refactor the usage of this method to directly use try_iter_component_access<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">            <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">filter_map</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">|</span></span></span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-variable z-parameter z-rust">component_access</span><span class="z-punctuation z-section z-parameters z-end z-rust">|</span></span> </span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">                <span class="z-storage z-type z-rust">let</span> index <span class="z-keyword z-operator z-assignment z-rust">=</span> component_access<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">index</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">sparse_set_index</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">                <span class="z-keyword z-control z-rust">match</span> component_access <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                    <span class="z-meta z-path z-rust">ComponentAccessKind<span class="z-punctuation z-accessor z-rust">::</span></span>Archetypal<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">_</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">=></span> <span class="z-support z-type z-rust">None</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                    <span class="z-meta z-path z-rust">ComponentAccessKind<span class="z-punctuation z-accessor z-rust">::</span></span>Shared<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">_</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">=></span> <span class="z-support z-type z-rust">Some</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>index</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                    <span class="z-meta z-path z-rust">ComponentAccessKind<span class="z-punctuation z-accessor z-rust">::</span></span>Exclusive<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">_</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">=></span> <span class="z-support z-type z-rust">None</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">            </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">component_writes</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">&</span><span class="z-variable z-parameter z-rust">self</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-></span> impl <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Iterator</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Item = T<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span> </span></span><span class="z-keyword z-operator z-arithmetic z-rust">+</span> <span class="z-keyword z-operator z-rust">'</span><span class="z-keyword z-operator z-rust">_</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-variable z-language z-rust">self</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">            <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">try_iter_component_access</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">            <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">expect</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>Access is unbounded. Please refactor the usage of this method to directly use try_iter_component_access<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">            <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">filter_map</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">|</span></span></span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-variable z-parameter z-rust">component_access</span><span class="z-punctuation z-section z-parameters z-end z-rust">|</span></span> </span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">                <span class="z-storage z-type z-rust">let</span> index <span class="z-keyword z-operator z-assignment z-rust">=</span> component_access<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">index</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">sparse_set_index</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">                <span class="z-keyword z-control z-rust">match</span> component_access <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                    <span class="z-meta z-path z-rust">ComponentAccessKind<span class="z-punctuation z-accessor z-rust">::</span></span>Archetypal<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">_</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">=></span> <span class="z-support z-type z-rust">None</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                    <span class="z-meta z-path z-rust">ComponentAccessKind<span class="z-punctuation z-accessor z-rust">::</span></span>Shared<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">_</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">=></span> <span class="z-support z-type z-rust">None</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                    <span class="z-meta z-path z-rust">ComponentAccessKind<span class="z-punctuation z-accessor z-rust">::</span></span>Exclusive<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">_</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">=></span> <span class="z-support z-type z-rust">Some</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>index</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">                </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-block z-rust">            </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>Please take note of the use of <code>expect()</code> in this code. You should consider using this as a starting point for a more appropriate migration based on your specific needs.<hr><h3 id=remove-flush-and-reserve-invalid-assuming-no-entities>Remove <code>flush_and_reserve_invalid_assuming_no_entities()</code> <a class=anchor-link href=#remove-flush-and-reserve-invalid-assuming-no-entities>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16460>#16460</a></div></div><p><code>Entities::flush_and_reserve_invalid_assuming_no_entities()</code> was a specialized method primarily used in 0.14 and earlier's rendering world design. With 0.15, <code>flush_and_reserve_invalid_assuming_no_entities()</code> went unused, so it now has been removed. If you previously required this method, you should switch to calling <code>Entities::reserve_entities()</code> and <code>Entities::flush_as_invalid()</code>.<hr><h3 id=remove-lifetime-from-queryentityerror>Remove lifetime from <code>QueryEntityError</code> <a class=anchor-link href=#remove-lifetime-from-queryentityerror>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18157>#18157</a></div></div><p><code>QueryEntityError::QueryDoesNotMatch</code> now stores an <code>ArchetypeId</code> instead of an <code>UnsafeWorldCell</code>. As such, <code>QueryEntityError</code>'s lifetime parameter has been removed.<hr><h3 id=remove-unsound-clone-impl-for-entitymutexcept>Remove unsound <code>Clone</code> impl for <code>EntityMutExcept</code> <a class=anchor-link href=#remove-unsound-clone-impl-for-entitymutexcept>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17032>#17032</a></div></div><p><code>EntityMutExcept</code> can no-longer be cloned, as doing so violates Rust's memory safety rules.<hr><h3 id=remove-unused-generic-in-deferredworld-trigger>Remove unused generic in <code>DeferredWorld::trigger()</code> <a class=anchor-link href=#remove-unused-generic-in-deferredworld-trigger>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16911>#16911</a></div></div><p>In 0.15 <code>DeferredWorld::trigger()</code> had an unused generic parameter that did not affect the type of the trigger event, so it has been removed.<hr><h3 id=rename-eventwriter-send-methods-to-write>Rename <code>EventWriter::send()</code> methods to <code>write()</code> <a class=anchor-link href=#rename-eventwriter-send-methods-to-write>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17977>#17977</a></div></div><p><code>EventWriter::send()</code> and its family of methods have been renamed to <code>EventWriter::write()</code> in order to reduce confusion and increase consistency. The old methods have been deprecated.<table><thead><tr><th>0.15<th>0.16<tbody><tr><td><code>EventWriter::send()</code><td><code>EventWriter::write()</code><tr><td><code>EventWriter::send_batch()</code><td><code>EventWriter::write_batch()</code><tr><td><code>EventWriter::send_default()</code><td><code>EventWriter::write_default()</code></table><hr><h3 id=replace-visitentities-with-mapentities>Replace <code>VisitEntities</code> with <code>MapEntities</code> <a class=anchor-link href=#replace-visitentities-with-mapentities>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18432>#18432</a></div></div><p><code>VisitEntities</code> and <code>VisitEntitiesMut</code> have been removed in favor of <code>MapEntities</code>, as the prior is less generally applicable (doesn't work on collections like <code>HashSet</code>s). If you previously derived <code>VisitEntities</code> and family, you can now derive <code>MapEntities</code> and use the <code>#[entities]</code> attribute to annotate the list of <code>Entity</code>s.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">VisitEntities<span class="z-punctuation z-separator z-rust">,</span> VisitEntitiesMut</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Inventory</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">items</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Vec</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Entity<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Opt-out of mapping this field, as its a string.
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">visit_entities</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">ignore</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">label</span><span class="z-punctuation z-separator z-type z-rust">:</span> String,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">MapEntities</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Inventory</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Opt-in to mapping this field.
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">entities</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">items</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Vec</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Entity<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">label</span><span class="z-punctuation z-separator z-type z-rust">:</span> String,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>Note <code>Component::visit_entities()</code> and <code>Component::visit_entities_mut()</code> have also been removed in favor of the new <code>Component::map_entities()</code> method. When deriving <code>Component</code>, you may also use <code>#[entities]</code> to specify which <code>Entity</code>s may be mapped.<p>Finally, entity mapping is no longer implemented for all types that implement <code>IntoIterator&LTItem = &Entity></code>. If you previously depended on a custom data type to support the <code>#[entities]</code> attribute, please manually derive / implement <code>MapEntities</code> for it.<hr><h3 id=run-observers-before-hooks-for-on-replace-and-on-remove>Run observers before hooks for <code>on_replace()</code> and <code>on_remove()</code> <a class=anchor-link href=#run-observers-before-hooks-for-on-replace-and-on-remove>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16499>#16499</a></div></div><p>The order of hooks and observers for <code>on_replace()</code> and <code>on_remove()</code> has been swapped, so now observers are run before hooks. As hooks are more primitive, they are designated as the first and last thing run when a component is added and removed. The total order for component removal can now be seen in the following table:<table><thead><tr><th>0.15<th>0.16<tbody><tr><td><code>on_replace()</code> hook<td><code>on_replace()</code> observer<tr><td><code>on_replace()</code> observer<td><code>on_replace()</code> hook<tr><td><code>on_remove()</code> hook<td><code>on_remove()</code> observer<tr><td><code>on_remove()</code> observer<td><code>on_remove()</code> hook</table><hr><h3 id=shorten-the-lifetime-returned-from-querylens-query>Shorten the lifetime returned from <code>QueryLens::query()</code> <a class=anchor-link href=#shorten-the-lifetime-returned-from-querylens-query>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17694>#17694</a></div></div><p>There was a lifetime issue found with <code>QueryLens::query()</code> where calling <code>get_inner()</code> on the returned value would allow for multiple mutable references to the same entity. This has been fixed by shrinking the lifetime of <code>QueryLens::query()</code>'s result, however it may break existing code.<p>If you run into lifetime issues while calling <code>get_inner()</code> or <code>iter_inner()</code> on <code>QueryLens::query()</code>'s result, you may need to switch to the new <code>QueryLens::query_inner()</code> method that only works on immutable queries.<hr><h3 id=split-component-register-component-hooks-into-individual-methods>Split <code>Component::register_component_hooks()</code> into individual methods <a class=anchor-link href=#split-component-register-component-hooks-into-individual-methods>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17685>#17685</a></div></div><p>Component hook registration is now split out into individual methods of <code>Component</code>. The original <code>Component::register_component_hooks()</code> has been deprecated, so please switch to the new <code>Component::on_add()</code>, <code>Component::on_remove()</code>, and related methods.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-storage z-type z-impl z-rust">impl</span> </span><span class="z-meta z-impl z-rust">Component <span class="z-keyword z-other z-rust">for</span></span><span class="z-meta z-impl z-rust"> <span class="z-entity z-name z-impl z-rust">Foo</span> </span><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">register_component_hooks</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">hooks</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&</span><span class="z-storage z-modifier z-rust">mut</span> ComponentHooks</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        hooks<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">on_add</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>foo_on_add</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-storage z-type z-impl z-rust">impl</span> </span><span class="z-meta z-impl z-rust">Component <span class="z-keyword z-other z-rust">for</span></span><span class="z-meta z-impl z-rust"> <span class="z-entity z-name z-impl z-rust">Foo</span> </span><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">on_add</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-></span> <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Option</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>ComponentHook<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-support z-type z-rust">Some</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>foo_on_add</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><hr><h3 id=turn-apply-deferred-into-a-zst-system>Turn <code>apply_deferred()</code> into a ZST system <a class=anchor-link href=#turn-apply-deferred-into-a-zst-system>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16642>#16642</a></div></div><p>The special <code>apply_deferred()</code> system has been converted into the zero-sized <code>ApplyDeferred</code> type that implements <code>System</code> for performance reasons. If you manually schedule <code>apply_deferred()</code>, which usually isn't the case, you will need to use the new <code>ApplyDeferred</code> type instead. If you manually called <code>apply_deferred()</code> without your code, you may delete it, as that function did nothing.<hr><h3 id=replace-register-dynamic-with-register-dynamic-with>Replace <code>register_dynamic()</code> with <code>register_dynamic_with()</code> <a class=anchor-link href=#replace-register-dynamic-with-register-dynamic-with>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18028>#18028</a></div></div><p><code>RequiredComponents::register_dynamic()</code> has been replaced by <code>RequiredComponents::register_dynamic_with()</code>, which avoids unnecessary cloning.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust">required_components<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">register_dynamic</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    component_id<span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    component_constructor<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">clone</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    requirement_inheritance_depth<span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust">required_components<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">register_dynamic_with</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    component_id<span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    requirement_inheritance_depth<span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    <span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">|</span></span></span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">|</span></span> </span><span class="z-meta z-function z-closure z-rust">component_constructor<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">clone</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-function z-closure z-rust"></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><hr><h3 id=add-entity-default-to-the-entity-set-wrappers>add Entity default to the entity set wrappers <a class=anchor-link href=#add-entity-default-to-the-entity-set-wrappers>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18319>#18319</a></div></div><p>Switch type parameter order for the relevant wrapper types/aliases.<hr><h3 id=impl-entityborrow-for-more-types>impl EntityBorrow for more types <a class=anchor-link href=#impl-entityborrow-for-more-types>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16917>#16917</a></div></div><p><code>NormalizedWindowRef::entity</code> has been replaced with an <code>EntityBorrow::entity</code> impl.<hr><h3 id=implement-entityset-and-iter-many-unique-methods>implement EntitySet and iter_many_unique methods <a class=anchor-link href=#implement-entityset-and-iter-many-unique-methods>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16547>#16547</a></div></div><p>Any custom type used as a <code>Borrow&LTEntity></code> entity list item for an <code>iter_many</code> method now has to implement <code>EntityBorrow</code> instead. Any type that implements <code>Borrow&LTEntity></code> can trivially implement <code>EntityBorrow</code>.<hr><h3 id=make-entityhashmap-and-entityhashset-proper-types>make EntityHashMap and EntityHashSet proper types <a class=anchor-link href=#make-entityhashmap-and-entityhashset-proper-types>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16912>#16912</a></div></div><p>Users of <code>with_hasher</code> and <code>with_capacity_and_hasher</code> on <code>EntityHashMap</code>/<code>Set</code> must now use <code>new</code> and <code>with_capacity</code> respectively. If the non-newtyped versions are required, they can be obtained via <code>Deref</code>, <code>DerefMut</code> or <code>into_inner</code> calls.<hr><h3 id=one-shot-system-cleanup>one shot system cleanup <a class=anchor-link href=#one-shot-system-cleanup>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16516>#16516</a></div></div><ul><li>Change all occurrences of <code>World::run_system_with_input</code> to <code>World::run_system_with</code>.<li>swap the order of input parameters for <code>World::run_system_once_with</code> such that the system comes before the input.</ul><hr><h3 id=make-componentticks-field-public>Make <code>ComponentTicks</code> field public <a class=anchor-link href=#make-componentticks-field-public>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>, <span class=heading-meta__item>Networking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16269>#16269</a></div></div><ul><li>Instead of using <code>ComponentTicks::last_changed_tick</code> and <code>ComponentTicks::added_tick</code> methods, access fields directly.</ul><hr><h3 id=add-immutable-component-support>Add Immutable <code>Component</code> Support <a class=anchor-link href=#add-immutable-component-support>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>, <span class=heading-meta__item>Reflection</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16372>#16372</a></div></div><ul><li>When implementing <code>Component</code> manually, you must now provide a type for <code>Mutability</code>. The type <code>Mutable</code> provides equivalent behaviour to earlier versions of <code>Component</code>:</ul><pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-storage z-type z-impl z-rust">impl</span> </span><span class="z-meta z-impl z-rust">Component <span class="z-keyword z-other z-rust">for</span></span><span class="z-meta z-impl z-rust"> <span class="z-entity z-name z-impl z-rust">Foo</span> </span><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-type z-rust">type</span> <span class="z-entity z-name z-type z-rust">Mutability</span> <span class="z-keyword z-operator z-assignment z-rust">=</span> Mutable<span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> ...
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><ul><li>When working with generic components, you may need to specify that your generic parameter implements <code>Component&LTMutability = Mutable></code> rather than <code>Component</code> if you require mutable access to said component.<li>The entity entry API has had to have some changes made to minimise friction when working with immutable components. Methods which previously returned a <code>Mut&LTT></code> will now typically return an <code>OccupiedEntry&LTT></code> instead, requiring you to add an <code>into_mut()</code> to get the <code>Mut&LTT></code> item again.</ul><hr><h3 id=faster-entity-cloning>Faster entity cloning <a class=anchor-link href=#faster-entity-cloning>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>, <span class=heading-meta__item>Reflection</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16717>#16717</a></div></div><ul><li><code>&EntityCloner</code> in component clone handlers is changed to <code>&mut ComponentCloneCtx</code> to better separate data.<li>Changed <code>EntityCloneHandler</code> from enum to struct and added convenience functions to add default clone and reflect handler more easily.</ul><hr><h3 id=filteredresource-returns-a-result-instead-of-a-simple-option>FilteredResource returns a Result instead of a simple Option <a class=anchor-link href=#filteredresource-returns-a-result-instead-of-a-simple-option>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>, <span class=heading-meta__item>Reflection</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18265>#18265</a></div></div><p>Users will need to handle the different return type on FilteredResource::get, FilteredResource::get_id, FilteredResource::get_mut as it is now a Result not an Option.<hr><h3 id=reflectbundle-remove-improvement><code>ReflectBundle::remove</code> improvement <a class=anchor-link href=#reflectbundle-remove-improvement>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>, <span class=heading-meta__item>Reflection</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16139>#16139</a></div></div><p>If you donâ€™t need the returned value from <code>remove</code>, discard it.<hr><h3 id=improved-derive-event>Improved <code>#[derive(Event)]</code> <a class=anchor-link href=#improved-derive-event>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>ECS</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18083>#18083</a></div></div><p>In <strong>Bevy 0.16</strong> you can now use <code>#[derive(Event)]</code> for more specialized implementations.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.15
</span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">MyEvent</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-storage z-type z-impl z-rust">impl</span> </span><span class="z-meta z-impl z-rust">Event <span class="z-keyword z-other z-rust">for</span></span><span class="z-meta z-impl z-rust"> <span class="z-entity z-name z-impl z-rust">MyEvent</span> </span><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-rust">const</span> <span class="z-constant z-other z-rust">AUTO_PROPAGATE</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-storage z-type z-rust">bool</span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-constant z-language z-rust">true</span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-type z-type z-rust">type</span> <span class="z-entity z-name z-type z-rust">Traversal</span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-keyword z-operator z-bitwise z-rust">&</span><span class="z-storage z-modifier z-lifetime z-rust">'static</span> ChildOf
</span></span></span><span class="z-source z-rust"><span class="z-meta z-impl z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> 0.16
</span></span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Event</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">event</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">traversal <span class="z-keyword z-operator z-rust">=</span> &'static ChildOf<span class="z-punctuation z-separator z-rust">,</span> auto_propagate</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">MyEvent</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><h2 id=input>Input <a class=anchor-link href=#input>#</a></h2><h3 id=gamepad-improvements>Gamepad improvements <a class=anchor-link href=#gamepad-improvements>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Input</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16222>#16222</a></div></div><ul><li><code>Gamepad</code> fields are now public.<li>Instead of using <code>Gamepad</code> delegates like <code>Gamepad::just_pressed</code>, call these methods directly on the fields.</ul><hr><h3 id=scale-input-to-account-for-deadzones>Scale input to account for deadzones <a class=anchor-link href=#scale-input-to-account-for-deadzones>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Input</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17015>#17015</a></div></div><p><code>GamepadButtonChangedEvent.value</code> is now linearly rescaled to be from <code>0.0..=1.0</code> (instead of <code>low..=high</code>) and <code>GamepadAxisChangedEvent.value</code> is now linearly rescaled to be from <code>-1.0..=0.0</code>/<code>0.0..=1.0</code> (accounting for the deadzone).<hr><h3 id=use-name-component-for-gamepad>Use <code>Name</code> component for gamepad <a class=anchor-link href=#use-name-component-for-gamepad>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Input</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16233>#16233</a></div></div><ul><li><code>GamepadInfo</code> no longer exists: <ul><li>Name now accessible via <code>Name</code> component.<li>Other information available on <code>Gamepad</code> component directly.<li><code>GamepadConnection::Connected</code> now stores all info fields directly.</ul></ul><hr><h3 id=expose-text-field-from-winit-in-keyboardinput>Expose <code>text</code> field from winit in <code>KeyboardInput</code> <a class=anchor-link href=#expose-text-field-from-winit-in-keyboardinput>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Input</span>, <span class=heading-meta__item>Text</span>, <span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16864>#16864</a></div></div><p>The <code>KeyboardInput</code> event now has a new <code>text</code> field.<h2 id=math>Math <a class=anchor-link href=#math>#</a></h2><h3 id=fix-atan2-docs>Fix atan2 docs <a class=anchor-link href=#fix-atan2-docs>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Math</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16673>#16673</a></div></div><p>Iâ€™m not sure if this counts as a breaking change, since the implementation clearly meant to use <code>f32::atan2</code> directly, so it was really just the parameter names that were wrong.<hr><h3 id=fix-rounding-in-steps-easing-function>Fix rounding in steps easing function <a class=anchor-link href=#fix-rounding-in-steps-easing-function>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Math</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17743>#17743</a></div></div><p><code>EaseFunction::Steps</code> now behaves like cssâ€™s default, â€œjump-end.â€ If you were relying on the old behavior, we plan on providing it. See <a href=https://github.com/bevyengine/bevy/issues/17744>https://github.com/bevyengine/bevy/issues/17744</a>.<hr><h3 id=improve-cubic-segment-bezier-functionality>Improve cubic segment bezier functionality <a class=anchor-link href=#improve-cubic-segment-bezier-functionality>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Math</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17645>#17645</a></div></div><p>Replace <code>CubicCurve::new_bezier</code> with <code>CubicCurve::new_bezier_easing</code>.<hr><h3 id=refactor-non-core-curve-methods-into-extension-traits>Refactor non-core Curve methods into extension traits <a class=anchor-link href=#refactor-non-core-curve-methods-into-extension-traits>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Math</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16930>#16930</a></div></div><p><code>Curve</code> has been refactored so that much of its functionality is now in extension traits. Adaptors such as <code>map</code>, <code>reparametrize</code>, <code>reverse</code>, and so on now require importing <code>CurveExt</code>, while the resampling methods <code>resample_*</code> require importing <code>CurveResampleExt</code>. Both of these new traits are exported through <code>bevy::math::curve</code> and through <code>bevy::math::prelude</code>.<hr><h3 id=rename-rot2-angle-between-to-rot2-angle-to>Rename <code>Rot2::angle_between</code> to <code>Rot2::angle_to</code> <a class=anchor-link href=#rename-rot2-angle-between-to-rot2-angle-to>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Math</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16327>#16327</a></div></div><p><code>Rot2::angle_between</code> has been deprecated, use <code>Rot2::angle_to</code> instead, the semantics of <code>Rot2::angle_between</code> will change in the future.<hr><h3 id=reworked-segment-types-into-their-cartesian-forms>Reworked Segment types into their cartesian forms <a class=anchor-link href=#reworked-segment-types-into-their-cartesian-forms>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Math</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17404>#17404</a></div></div><p>The segment type constructors changed so if someone previously created a Segment2d with a direction and length they would now need to use the <code>from_direction</code> constructor<hr><h3 id=use-intoiterator-instead-of-into-vec-in-cubic-splines-interfaces>Use <code>IntoIterator</code> instead of <code>Into&LTVec<..>></code> in cubic splines interfaces <a class=anchor-link href=#use-intoiterator-instead-of-into-vec-in-cubic-splines-interfaces>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Math</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16402>#16402</a></div></div><p>The cubic splines API now uses <code>IntoIterator</code> in places where it used <code>Into&LTVec<..>></code>. For most users, this will have little to no effect (it is largely more permissive). However, in case you were using some unusual input type that implements <code>Into&LTVec<..>></code> without implementing <code>IntoIterator</code>, you can migrate by converting the input to a <code>Vec<..></code> before passing it into the interface.<hr><h3 id=math-add-smoothstep-and-smootherstep-easing-functions>[math] Add <code>SmoothStep</code> and <code>SmootherStep</code> easing functions <a class=anchor-link href=#math-add-smoothstep-and-smootherstep-easing-functions>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Math</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16957>#16957</a></div></div><p>This version of bevy marks <code>EaseFunction</code> as <code>#[non_exhaustive]</code> to that future changes to add more easing functions will be non-breaking. If you were exhaustively matching that enum â€“ which you probably werenâ€™t â€“ youâ€™ll need to add a catch-all (<code>_ =></code>) arm to cover unknown easing functions.<hr><h3 id=make-bevy-reflect-feature-of-bevy-math-non-default>Make <code>bevy_reflect</code> feature of <code>bevy_math</code> non-default <a class=anchor-link href=#make-bevy-reflect-feature-of-bevy-math-non-default>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Math</span>, <span class=heading-meta__item>Reflection</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16938>#16938</a></div></div><p><code>bevy_reflect</code> has been made a non-default feature of <code>bevy_math</code>. (It is still enabled when <code>bevy_math</code> is used through <code>bevy</code>.) You may need to enable this feature if you are using <code>bevy_math</code> on its own and desire for the types it exports to implement <code>Reflect</code> and other reflection traits.<h2 id=picking>Picking <a class=anchor-link href=#picking>#</a></h2><h3 id=add-flags-to-spriteplugin-and-uiplugin-to-allow-disabling-their-picking-backend-without-needing-to-disable-features>Add flags to <code>SpritePlugin</code> and <code>UiPlugin</code> to allow disabling their picking backend (without needing to disable features). <a class=anchor-link href=#add-flags-to-spriteplugin-and-uiplugin-to-allow-disabling-their-picking-backend-without-needing-to-disable-features>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16473>#16473</a></div></div><ul><li><code>UiPlugin</code> now contains an extra <code>add_picking</code> field if <code>bevy_ui_picking_backend</code> is enabled.<li><code>SpritePlugin</code> is no longer a unit struct, and has one field if <code>bevy_sprite_picking_backend</code> is enabled (otherwise no fields).</ul><hr><h3 id=add-optional-transparency-passthrough-for-sprite-backend-with-bevy-picking>Add optional transparency passthrough for sprite backend with bevy_picking <a class=anchor-link href=#add-optional-transparency-passthrough-for-sprite-backend-with-bevy-picking>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16388>#16388</a></div></div><p>Sprite picking now ignores transparent regions (with an alpha value less than or equal to 0.1). To configure this, modify the <code>SpriteBackendSettings</code> resource.<hr><h3 id=allow-users-to-easily-use-bevy-sprite-and-bevy-ui-without-picking>Allow users to easily use <code>bevy_sprite</code> and <code>bevy_ui</code> without picking <a class=anchor-link href=#allow-users-to-easily-use-bevy-sprite-and-bevy-ui-without-picking>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17175>#17175</a></div></div><p><code>bevy_sprite_picking_backend</code> is no longer included by default when using the <code>bevy_sprite</code> feature. If you are using Bevy without default features and relied on sprite picking, add this feature to your <code>Cargo.toml</code>.<p><code>bevy_ui_picking_backend</code> is no longer included by default when using the <code>bevy_ui</code> feature. If you are using Bevy without default features and relied on sprite picking, add this feature to your <code>Cargo.toml</code>.<hr><h3 id=fix-bevy-picking-plugin-suffixes>Fix <code>bevy_picking</code> plugin suffixes <a class=anchor-link href=#fix-bevy-picking-plugin-suffixes>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16082>#16082</a></div></div><ul><li><code>MeshPickingBackend</code> is now named <code>MeshPickingPlugin</code>.<li><code>MeshPickingBackendSettings</code> is now named <code>MeshPickingSettings</code>.<li><code>SpritePickingBackend</code> is now named <code>SpritePickingPlugin</code>.<li><code>UiPickingBackendPlugin</code> is now named <code>UiPickingPlugin</code>.<li><code>DefaultPickingPlugins</code> is now a a <code>PluginGroup</code> instead of a <code>Plugin</code>.</ul><hr><h3 id=flattened-pointeraction-pressed-into-press-and-release>Flattened <code>PointerAction::Pressed</code> into <code>Press</code> and <code>Release</code>. <a class=anchor-link href=#flattened-pointeraction-pressed-into-press-and-release>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17424>#17424</a></div></div><ul><li><code>PointerAction::Pressed</code> has been separated into two variants, <code>PointerAction::Press</code> and <code>PointerAction::Release</code>.<li><code>PointerAction::Moved</code> has been renamed to <code>PointerAction::Move</code>.<li><code>PointerAction::Canceled</code> has been renamed to <code>PointerAction::Cancel</code>.</ul><hr><h3 id=if-there-is-no-movement-dragstart-is-not-triggered>If there is no movement, DragStart is not triggered. <a class=anchor-link href=#if-there-is-no-movement-dragstart-is-not-triggered>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17233>#17233</a></div></div><p>Fix the missing part of Drag <a href=https://github.com/bevyengine/bevy/pull/16950>https://github.com/bevyengine/bevy/pull/16950</a><hr><h3 id=make-raymap-map-public>Make RayMap map public <a class=anchor-link href=#make-raymap-map-public>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18544>#18544</a></div></div><p>The <code>bevy_picking::backend::ray::RayMap::map</code> method is removed as redundant, In systems using <code>Res&LTRayMap></code> replace <code>ray_map.map()</code> with <code>&ray_map.map</code><hr><h3 id=make-sprite-picking-opt-in>Make sprite picking opt-in <a class=anchor-link href=#make-sprite-picking-opt-in>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17225>#17225</a></div></div><p>The sprite picking backend is now strictly opt-in using the <code>SpritePickingCamera</code> and <code>Pickable</code> components. You should add the <code>Pickable</code> component any entities that you want sprite picking to be enabled for, and mark their respective cameras with <code>SpritePickingCamera</code>.<hr><h3 id=make-sprite-picking-opt-in-1>Make sprite picking opt-in <a class=anchor-link href=#make-sprite-picking-opt-in-1>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17842>#17842</a></div></div><ul><li>Sprite picking are now opt-in, make sure you insert <code>Pickable</code> component when using sprite picking.</ul><pre class="language-diff z-code" data-lang=diff><code class=language-diff data-lang=diff><span class="z-source z-diff"><span class="z-markup z-deleted z-diff"><span class="z-punctuation z-definition z-deleted z-diff">-</span>commands.spawn(Sprite { .. } );
</span></span><span class="z-source z-diff"><span class="z-markup z-inserted z-diff"><span class="z-punctuation z-definition z-inserted z-diff">+</span>commands.spawn((Sprite { .. }, Pickable::default());
</span></span></code></pre><hr><h3 id=rename-focus-in-bevy-picking-to-hover>Rename "focus" in <code>bevy_picking</code> to "hover" <a class=anchor-link href=#rename-focus-in-bevy-picking-to-hover>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16872>#16872</a></div></div><p>Various terms related to â€œfocusâ€ in <code>bevy_picking</code> have been renamed to refer to â€œhoverâ€ to avoid confusion with <code>bevy_input_focus</code>. In particular:<ul><li>The <code>update_focus</code> system has been renamed to <code>generate_hovermap</code><li><code>PickSet::Focus</code> and <code>PostFocus</code> have been renamed to <code>Hover</code> and <code>PostHover</code><li>The <code>bevy_picking::focus</code> module has been renamed to <code>bevy_picking::hover</code><li>The <code>is_focus_enabled</code> field on <code>PickingPlugin</code> has been renamed to <code>is_hover_enabled</code><li>The <code>focus_should_run</code> run condition has been renamed to <code>hover_should_run</code></ul><hr><h3 id=rename-pointer-down-up-to-pointer-pressed-released-in-bevy-picking>Rename <code>Pointer&LTDown/Up></code> to <code>Pointer&LTPressed/Released></code> in <code>bevy_picking</code> <a class=anchor-link href=#rename-pointer-down-up-to-pointer-pressed-released-in-bevy-picking>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16331>#16331</a></div></div><h4 id=bevy-picking-src-pointer-rs><code>bevy_picking/src/pointer.rs</code> <a class=anchor-link href=#bevy-picking-src-pointer-rs>#</a></h4><p><strong><code>enum PressDirection</code>:</strong><ul><li><code>PressDirection::Down</code> changes to <code>PressDirection::Pressed</code>.<li><code>PressDirection::Up</code> changes to <code>PressDirection::Released</code>.</ul><p>These changes are also relevant when working with <code>enum PointerAction</code><h4 id=bevy-picking-src-events-rs><code>bevy_picking/src/events.rs</code> <a class=anchor-link href=#bevy-picking-src-events-rs>#</a></h4><p>Clicking and pressing Events in events.rs categories change from [Down], [Up], [Click] to [Pressed], [Released], [Click].<ul><li><code>struct Down</code> changes to <code>struct Pressed</code> - fires when a pointer button is pressed over the â€˜targetâ€™ entity.<li><code>struct Up</code> changes to <code>struct Released</code> - fires when a pointer button is released over the â€˜targetâ€™ entity.<li><code>struct Click</code> now fires when a pointer sends a Pressed event followed by a Released event on the same â€˜targetâ€™.<li><code>struct DragStart</code> now fires when the â€˜targetâ€™ entity receives a pointer Pressed event followed by a pointer Move event.<li><code>struct DragEnd</code> now fires when the â€˜targetâ€™ entity is being dragged and receives a pointer Released event.<li><code>PickingEventWriters<'w>::down_events: EventWriter<'w, Pointer&LTDown>></code> changes to <code>PickingEventWriters<'w>::pressed_events: EventWriter<'w, Pointer&LTPressed>></code>.<li><code>PickingEventWriters<'w>::up_events changes to PickingEventWriters<'w>::released_events</code>.</ul><hr><h3 id=rename-pickingbehavior-to-pickable>Rename <code>PickingBehavior</code> to <code>Pickable</code> <a class=anchor-link href=#rename-pickingbehavior-to-pickable>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17266>#17266</a></div></div><p>Change all instances of <code>PickingBehavior</code> to <code>Pickable</code>.<hr><h3 id=rename-raycastsettings-to-meshraycastsettings>Rename <code>RayCastSettings</code> to <code>MeshRayCastSettings</code> <a class=anchor-link href=#rename-raycastsettings-to-meshraycastsettings>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16703>#16703</a></div></div><p><code>RayCastSettings</code> has been renamed to <code>MeshRayCastSettings</code> to avoid naming conflicts with other ray casting backends and types.<hr><h3 id=unify-picking-backends>Unify picking backends <a class=anchor-link href=#unify-picking-backends>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Picking</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17348>#17348</a></div></div><p><code>UiPickingPlugin</code> and <code>SpritePickingPlugin</code> are no longer included in <code>DefaultPlugins</code>. They must be explicitly added.<p><code>RayCastPickable</code> has been replaced in favor of the <code>MeshPickingCamera</code> and <code>Pickable</code> components. You should add them to cameras and entities, respectively, if you have <code>MeshPickingSettings::require_markers</code> set to <code>true</code>.<h2 id=reflection>Reflection <a class=anchor-link href=#reflection>#</a></h2><h3 id=include-reflectfromreflect-in-all-dynamic-data-types>Include ReflectFromReflect in all dynamic data types. <a class=anchor-link href=#include-reflectfromreflect-in-all-dynamic-data-types>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Reflection</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17453>#17453</a></div></div><p>The hasher in reflected <code>HashMap</code>s and <code>HashSet</code>s now have to implement <code>Default</code>. This is the case for the ones provided by Bevy already, and is generally a sensible thing to do.<hr><h3 id=make-bevy-remote-feature-enable-serialize-feature>Make <code>bevy_remote</code> feature enable <code>serialize</code> feature <a class=anchor-link href=#make-bevy-remote-feature-enable-serialize-feature>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Reflection</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17260>#17260</a></div></div><p>The <code>bevy_remote</code> feature of <code>bevy</code> now enables the <code>serialize</code> feature automatically. If you wish to use <code>bevy_remote</code> without enabling the <code>serialize</code> feature for Bevy subcrates, you must import <code>bevy_remote</code> on its own.<hr><h3 id=rename-arglist-push-methods-to-with-and-add-new-push-methods-which-take-mut-self>Rename <code>ArgList::push</code> methods to <code>with</code> and add new <code>push</code> methods which take <code>&mut self</code> <a class=anchor-link href=#rename-arglist-push-methods-to-with-and-add-new-push-methods-which-take-mut-self>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Reflection</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16567>#16567</a></div></div><p>Uses of the <code>ArgList::push</code> methods should be replaced with the <code>with</code> counterpart.<table><thead><tr><th>old<th>new<tbody><tr><td>push_arg<td>with_arg<tr><td>push_ref<td>with_ref<tr><td>push_mut<td>with_mut<tr><td>push_owned<td>with_owned<tr><td>push_boxed<td>with_boxed</table><hr><h3 id=bevy-reflect-deprecate-partialreflect-clone-value>bevy_reflect: Deprecate <code>PartialReflect::clone_value</code> <a class=anchor-link href=#bevy-reflect-deprecate-partialreflect-clone-value>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Reflection</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18284>#18284</a></div></div><p><code>PartialReflect::clone_value</code> is being deprecated. Instead, use <code>PartialReflect::to_dynamic</code> if wanting to create a new dynamic instance of the reflected value. Alternatively, use <code>PartialReflect::reflect_clone</code> to attempt to create a true clone of the underlying value.<p>Similarly, the following methods have been deprecated and should be replaced with these alternatives:<ul><li><code>Array::clone_dynamic</code> â†’ <code>Array::to_dynamic_array</code><li><code>Enum::clone_dynamic</code> â†’ <code>Enum::to_dynamic_enum</code><li><code>List::clone_dynamic</code> â†’ <code>List::to_dynamic_list</code><li><code>Map::clone_dynamic</code> â†’ <code>Map::to_dynamic_map</code><li><code>Set::clone_dynamic</code> â†’ <code>Set::to_dynamic_set</code><li><code>Struct::clone_dynamic</code> â†’ <code>Struct::to_dynamic_struct</code><li><code>Tuple::clone_dynamic</code> â†’ <code>Tuple::to_dynamic_tuple</code><li><code>TupleStruct::clone_dynamic</code> â†’ <code>TupleStruct::to_dynamic_tuple_struct</code></ul><hr><h3 id=bevy-reflect-remove-partialreflect-serializable>bevy_reflect: Remove <code>PartialReflect::serializable</code> <a class=anchor-link href=#bevy-reflect-remove-partialreflect-serializable>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Reflection</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16576>#16576</a></div></div><p><code>PartialReflect::serializable</code> has been removed. If you were using this to pass on serialization information, use <code>ReflectSerialize</code> instead or create custom type data to generate the <code>Serializable</code>.<hr><h3 id=remove-unnecessary-partialreflect-bound-on-deserializewithregistry>Remove unnecessary <code>PartialReflect</code> bound on <code>DeserializeWithRegistry</code> <a class=anchor-link href=#remove-unnecessary-partialreflect-bound-on-deserializewithregistry>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Reflection</span>, <span class=heading-meta__item>Scenes</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17560>#17560</a></div></div><p><code>DeserializeWithRegistry</code> types are no longer guaranteed to be <code>PartialReflect</code> as well. If you were relying on this type bound, you should add it to your own bounds manually.<pre class="language-diff z-code" data-lang=diff><code class=language-diff data-lang=diff><span class="z-source z-diff"><span class="z-markup z-deleted z-diff"><span class="z-punctuation z-definition z-deleted z-diff">-</span> impl&LTT: DeserializeWithRegistry> Foo for T { .. }
</span></span><span class="z-source z-diff"><span class="z-markup z-inserted z-diff"><span class="z-punctuation z-definition z-inserted z-diff">+</span> impl&LTT: DeserializeWithRegistry + PartialReflect> Foo for T { .. }
</span></span></code></pre><h2 id=rendering>Rendering <a class=anchor-link href=#rendering>#</a></h2><h3 id=add-uv-transform-to-colormaterial>Add <code>uv_transform</code> to <code>ColorMaterial</code> <a class=anchor-link href=#add-uv-transform-to-colormaterial>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17879>#17879</a></div></div><p>Add <code>uv_transform</code> field to constructors of <code>ColorMaterial</code><hr><h3 id=add-a-bindless-mode-to-asbindgroup>Add a bindless mode to <code>AsBindGroup</code>. <a class=anchor-link href=#add-a-bindless-mode-to-asbindgroup>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16368>#16368</a></div></div><ul><li><code>RenderAssets::prepare_asset</code> now takes an <code>AssetId</code> parameter.<li>Bin keys now have Bevy-specific material bind group indices instead of <code>wgpu</code> material bind group IDs, as part of the bindless change. Use the new <code>MaterialBindGroupAllocator</code> to map from bind group index to bind group ID.</ul><hr><h3 id=add-bevy-anti-aliasing>Add bevy_anti_aliasing <a class=anchor-link href=#add-bevy-anti-aliasing>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18323>#18323</a></div></div><p>When using anti aliasing features, you now need to import them from <code>bevy::anti_aliasing</code> instead of <code>bevy::core_pipeline</code><hr><h3 id=adding-alpha-threshold-to-orderindependenttransparencysettings-for-user-level-optimization>Adding alpha_threshold to OrderIndependentTransparencySettings for user-level optimization <a class=anchor-link href=#adding-alpha-threshold-to-orderindependenttransparencysettings-for-user-level-optimization>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16090>#16090</a></div></div><p>If you previously explicitly initialized OrderIndependentTransparencySettings with your own <code>layer_count</code>, you will now have to add either a <code>..default()</code> statement or an explicit <code>alpha_threshold</code> value:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">setup</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-storage z-modifier z-rust">mut</span> <span class="z-variable z-parameter z-rust">commands</span><span class="z-punctuation z-separator z-rust">:</span> Commands</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">        <span class="z-meta z-path z-rust">Camera3d<span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">        OrderIndependentTransparencySettings <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">            layer_count<span class="z-punctuation z-separator z-rust">:</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">16</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">            <span class="z-keyword z-operator z-range z-rust">..</span><span class="z-support z-function z-rust">default</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">        </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">    </span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><hr><h3 id=allowed-creating-uninitialized-images-for-use-as-storage-textures>Allowed creating uninitialized images (for use as storage textures) <a class=anchor-link href=#allowed-creating-uninitialized-images-for-use-as-storage-textures>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17760>#17760</a></div></div><p>Code that directly access <code>Image</code> data will now need to use unwrap or handle the case where no data is provided. Behaviour of new_fill slightly changed, but not in a way that is likely to affect anything. It no longer panics and will fill the whole texture instead of leaving black pixels if the data provided is not a nice factor of the size of the image.<hr><h3 id=bind-only-the-written-parts-of-storage-buffers>Bind only the written parts of storage buffers. <a class=anchor-link href=#bind-only-the-written-parts-of-storage-buffers>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16405>#16405</a></div></div><ul><li>Fixed a bug with StorageBuffer and DynamicStorageBuffer binding data from the previous frame(s) due to caching GPU buffers between frames.</ul><hr><h3 id=change-gpuimage-size-from-uvec2-to-extent3d>Change <code>GpuImage::size</code> from <code>UVec2</code> to <code>Extent3d</code> <a class=anchor-link href=#change-gpuimage-size-from-uvec2-to-extent3d>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16815>#16815</a></div></div><ul><li><code>GpuImage::size</code> is now an <code>Extent3d</code>. To easily get 2D size, use <code>size_2d()</code>.</ul><hr><h3 id=cold-specialization>Cold Specialization <a class=anchor-link href=#cold-specialization>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17567>#17567</a></div></div><p>TODO<ul><li><code>AssetEvents</code> has been moved into the <code>PostUpdate</code> schedule.</ul><hr><h3 id=expose-pipeline-compilation-zero-initialize-workgroup-memory-option>Expose Pipeline Compilation Zero Initialize Workgroup Memory Option <a class=anchor-link href=#expose-pipeline-compilation-zero-initialize-workgroup-memory-option>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16301>#16301</a></div></div><ul><li>add <code>zero_initialize_workgroup_memory: false,</code> to <code>ComputePipelineDescriptor</code> or <code>RenderPipelineDescriptor</code> structs to preserve 0.14 functionality, add <code>zero_initialize_workgroup_memory: true,</code> to restore bevy 0.13 functionality.</ul><hr><h3 id=fix-sprite-performance-regression-since-retained-render-world>Fix sprite performance regression since retained render world <a class=anchor-link href=#fix-sprite-performance-regression-since-retained-render-world>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17078>#17078</a></div></div><ul><li><code>ExtractedSprites</code> is now using <code>MainEntityHashMap</code> for storage, which is keyed on <code>MainEntity</code>.<li>The render world entity corresponding to an <code>ExtractedSprite</code> is now stored in the <code>render_entity</code> member of it.</ul><hr><h3 id=fix-the-texture-binding-array-specialized-mesh-pipeline-and-custom-shader-instancing-examples-after-the-bindless-change>Fix the <code>texture_binding_array</code>, <code>specialized_mesh_pipeline</code>, and <code>custom_shader_instancing</code> examples after the bindless change. <a class=anchor-link href=#fix-the-texture-binding-array-specialized-mesh-pipeline-and-custom-shader-instancing-examples-after-the-bindless-change>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16641>#16641</a></div></div><ul><li>Bevy will now unconditionally call <code>AsBindGroup::unprepared_bind_group</code> for your materials, so you must no longer panic in that function. Instead, return the new <code>AsBindGroupError::CreateBindGroupDirectly</code> error, and Bevy will fall back to calling <code>AsBindGroup::as_bind_group</code> as before.</ul><hr><h3 id=implement-bindless-lightmaps>Implement bindless lightmaps. <a class=anchor-link href=#implement-bindless-lightmaps>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16653>#16653</a></div></div><ul><li>The <code>Opaque3dBinKey::lightmap_image</code> field is now <code>Opaque3dBinKey::lightmap_slab</code>, which is a lightweight identifier for an entire binding array of lightmaps.</ul><hr><h3 id=implement-experimental-gpu-two-phase-occlusion-culling-for-the-standard-3d-mesh-pipeline>Implement experimental GPU two-phase occlusion culling for the standard 3D mesh pipeline. <a class=anchor-link href=#implement-experimental-gpu-two-phase-occlusion-culling-for-the-standard-3d-mesh-pipeline>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17413>#17413</a></div></div><ul><li>When enqueuing a custom mesh pipeline, work item buffers are now created with <code>bevy::render::batching::gpu_preprocessing::get_or_create_work_item_buffer</code>, not <code>PreprocessWorkItemBuffers::new</code>. See the <code>specialized_mesh_pipeline</code> example.</ul><hr><h3 id=introduce-support-for-mixed-lighting-by-allowing-lights-to-opt-out-of-contributing-diffuse-light-to-lightmapped-objects>Introduce support for mixed lighting by allowing lights to opt out of contributing diffuse light to lightmapped objects. <a class=anchor-link href=#introduce-support-for-mixed-lighting-by-allowing-lights-to-opt-out-of-contributing-diffuse-light-to-lightmapped-objects>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16761>#16761</a></div></div><ul><li>The <code>AmbientLight</code> resource, the <code>IrradianceVolume</code> component, and the <code>EnvironmentMapLight</code> component now have <code>affects_lightmapped_meshes</code> fields. If you donâ€™t need to use that field (for example, if you arenâ€™t using lightmaps), you can safely set the field to true.<li><code>DirectionalLight</code>, <code>PointLight</code>, and <code>SpotLight</code> now have <code>affects_lightmapped_mesh_diffuse</code> fields. If you donâ€™t need to use that field (for example, if you arenâ€™t using lightmaps), you can safely set the field to true.</ul><hr><h3 id=introduce-two-level-bins-for-multidrawable-meshes>Introduce two-level bins for multidrawable meshes. <a class=anchor-link href=#introduce-two-level-bins-for-multidrawable-meshes>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16898>#16898</a></div></div><ul><li>The <em>batch set key</em> is now separate from the <em>bin key</em> in <code>BinnedPhaseItem</code>. The batch set key is used to collect multidrawable meshes together. If you arenâ€™t using the multidraw feature, you can safely set the batch set key to <code>()</code>.</ul><hr><h3 id=key-render-phases-off-the-main-world-view-entity-not-the-render-world-view-entity>Key render phases off the main world view entity, not the render world view entity. <a class=anchor-link href=#key-render-phases-off-the-main-world-view-entity-not-the-render-world-view-entity>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16942>#16942</a></div></div><hr><h3 id=make-indirect-drawing-opt-out-instead-of-opt-in-enabling-multidraw-by-default>Make indirect drawing opt-out instead of opt-in, enabling multidraw by default. <a class=anchor-link href=#make-indirect-drawing-opt-out-instead-of-opt-in-enabling-multidraw-by-default>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16757>#16757</a></div></div><ul><li>Indirect drawing (GPU culling) is now enabled by default, so the <code>GpuCulling</code> component is no longer available. To disable indirect mode, which may be useful with custom render nodes, add the new <code>NoIndirectDrawing</code> component to your camera.</ul><hr><h3 id=make-the-get-function-on-instanceinputuniformbuffer-less-error-prone>Make the <code>get</code> function on <code>InstanceInputUniformBuffer</code> less error prone <a class=anchor-link href=#make-the-get-function-on-instanceinputuniformbuffer-less-error-prone>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17131>#17131</a></div></div><p><code>InstanceInputUniformBuffer::get</code> now returns <code>Option&LTBDI></code> instead of <code>BDI</code> to reduce panics. If you require the old functionality of <code>InstanceInputUniformBuffer::get</code> consider using <code>InstanceInputUniformBuffer::get_unchecked</code>.<hr><h3 id=make-the-default-directional-light-shadow-cascade-settings-similar-to-those-of-other-engines>Make the default directional light shadow cascade settings similar to those of other engines. <a class=anchor-link href=#make-the-default-directional-light-shadow-cascade-settings-similar-to-those-of-other-engines>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17552>#17552</a></div></div><ul><li>The default shadow cascade far distance has been changed from 1000 to 150, and the default first cascade far bound has been changed from 5 to 10, in order to be similar to the defaults of other engines.</ul><hr><h3 id=mesh-merge-to-return-a-result>Mesh::merge to return a Result <a class=anchor-link href=#mesh-merge-to-return-a-result>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17475>#17475</a></div></div><ul><li><code>Mesh::merge</code> now returns a <code>Result<(), MeshMergeError></code>.</ul><hr><h3 id=move-textureatlas-and-friends-into-bevy-image>Move <code>TextureAtlas</code> and friends into <code>bevy_image</code> <a class=anchor-link href=#move-textureatlas-and-friends-into-bevy-image>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17219>#17219</a></div></div><p>The following types have been moved from <code>bevy_sprite</code> to <code>bevy_image</code>: <code>TextureAtlas</code>, <code>TextureAtlasBuilder</code>, <code>TextureAtlasSources</code>, <code>TextureAtlasLayout</code> and <code>DynamicTextureAtlasBuilder</code>.<p>If you are using the <code>bevy</code> crate, and were importing these types directly (e.g. before <code>use bevy::sprite::TextureAtlas</code>), be sure to update your import paths (e.g. after <code>use bevy::image::TextureAtlas</code>)<p>If you are using the <code>bevy</code> prelude to import these types (e.g. <code>use bevy::prelude::*</code>), you donâ€™t need to change anything.<p>If you are using the <code>bevy_sprite</code> subcrate, be sure to add <code>bevy_image</code> as a dependency if you do not already have it, and be sure to update your import paths.<hr><h3 id=move-non-generic-parts-of-the-prepasspipeline-to-internal-field>Move non-generic parts of the PrepassPipeline to internal field <a class=anchor-link href=#move-non-generic-parts-of-the-prepasspipeline-to-internal-field>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18322>#18322</a></div></div><p>If you were using a field of the <code>PrepassPipeline</code>, most of them have now been move to <code>PrepassPipeline::internal</code>.<hr><h3 id=native-unclipped-depth-on-supported-platforms>Native unclipped depth on supported platforms <a class=anchor-link href=#native-unclipped-depth-on-supported-platforms>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16095>#16095</a></div></div><ul><li><code>MeshPipelineKey::DEPTH_CLAMP_ORTHO</code> is now <code>MeshPipelineKey::UNCLIPPED_DEPTH_ORTHO</code><li>The <code>DEPTH_CLAMP_ORTHO</code> shaderdef has been renamed to <code>UNCLIPPED_DEPTH_ORTHO_EMULATION</code><li><code>clip_position_unclamped: vec4&LTf32></code> is now <code>unclipped_depth: f32</code></ul><hr><h3 id=newtype-anchor>Newtype <code>Anchor</code> <a class=anchor-link href=#newtype-anchor>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18439>#18439</a></div></div><p>The anchor component has been changed from an enum to a struct newtyping a <code>Vec2</code>. The <code>Custom</code> variant has been removed, instead to construct a custom <code>Anchor</code> use its tuple constructor:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">Sprite <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">     anchor<span class="z-punctuation z-separator z-rust">:</span> Anchor<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">Vec2<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">25</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">4</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">     <span class="z-keyword z-operator z-range z-rust">..</span><span class="z-support z-function z-rust">default</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></code></pre><p>The other enum variants have been replaced with corresponding constants:<ul><li><code>Anchor::BottomLeft</code> to <code>Anchor::BOTTOM_LEFT</code><li><code>Anchor::Center</code> to <code>Anchor::CENTER</code><li><code>Anchor::TopRight</code> to <code>Anchor::TOP_RIGHT</code><li>.. and so on for the remaining variants</ul><hr><h3 id=only-use-the-aabb-center-for-mesh-visibility-range-testing-if-specified>Only use the AABB center for mesh visibility range testing if specified. <a class=anchor-link href=#only-use-the-aabb-center-for-mesh-visibility-range-testing-if-specified>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16468>#16468</a></div></div><ul><li>The <code>VisibilityRange</code> component now has an extra field, <code>use_aabb</code>. Generally, you can safely set it to false.</ul><hr><h3 id=reduce-the-clusterable-object-ubo-size-below-16384-for-webgl-2>Reduce the clusterable object UBO size below 16384 for WebGL 2. <a class=anchor-link href=#reduce-the-clusterable-object-ubo-size-below-16384-for-webgl-2>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16069>#16069</a></div></div><p><code>MAX_UNIFORM_BUFFER_CLUSTERABLE_OBJECTS</code> has been reduced from <code>256</code> to <code>204</code>.<hr><h3 id=refactor-and-simplify-custom-projections>Refactor and simplify custom projections <a class=anchor-link href=#refactor-and-simplify-custom-projections>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17063>#17063</a></div></div><ul><li><code>PerspectiveProjection</code> and <code>OrthographicProjection</code> are no longer components. Use <code>Projection</code> instead.<li>Custom projections should no longer be inserted as a component. Instead, simply set the custom projection as a value of <code>Projection</code> with <code>Projection::custom()</code>.</ul><hr><h3 id=remove-the-type-parameter-from-check-visibility-and-visibleentities>Remove the type parameter from <code>check_visibility</code> and <code>VisibleEntities</code> <a class=anchor-link href=#remove-the-type-parameter-from-check-visibility-and-visibleentities>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16812>#16812</a></div></div><p><code>check_visibility</code> no longer takes a <code>QueryFilter</code>, and thereâ€™s no need to add it manually to your app schedule anymore for custom rendering items. Instead, entities with custom renderable components should add the appropriate type IDs to <code>VisibilityClass</code>. See <code>custom_phase_item</code> for an example.<p>Similarly, all methods on <code>VisibleEntities</code> (such as <code>get</code> and <code>iter</code>) no longer take a generic parameter, and instead must be passed a <code>TypeId</code> corresponding to the component used in the <code>VisibilityClass</code> of the entity.<p>Before:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">visible_entities<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-generic z-rust">get_mut<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-meta z-generic z-rust">With<span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Mesh3d<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>After:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">visible_entities<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">get_mut</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">TypeId<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">of<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Mesh3d<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><hr><h3 id=support-scale-factor-for-image-render-targets>Support scale factor for image render targets <a class=anchor-link href=#support-scale-factor-for-image-render-targets>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16796>#16796</a></div></div><p><code>RenderTarget::Image</code> now takes an <code>ImageRenderTarget</code> instead of a <code>Handle&LTImage></code>. You can call <code>handle.into()</code> to construct an <code>ImageRenderTarget</code> using the same settings as before.<hr><h3 id=upgrade-to-wgpu-v24>Upgrade to wgpu v24 <a class=anchor-link href=#upgrade-to-wgpu-v24>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17542>#17542</a></div></div><ul><li>Bevy has upgraded to <a href=https://github.com/gfx-rs/wgpu/blob/trunk/CHANGELOG.md#v2400-2025-01-15>wgpu v24</a>.<li>When using the DirectX 12 rendering backend, the new priority system for choosing a shader compiler is as follows: <ul><li>If the <code>WGPU_DX12_COMPILER</code> environment variable is set at runtime, it is used<li>Else if the new <code>statically-linked-dxc</code> feature is enabled, a custom version of DXC will be statically linked into your app at compile time.<li>Else Bevy will look in the appâ€™s working directory for <code>dxcompiler.dll</code> and <code>dxil.dll</code> at runtime.<li>Else if they are missing, Bevy will fall back to FXC (not recommended)</ul></ul><hr><h3 id=use-multi-draw-indirect-count-where-available-in-preparation-for-two-phase-occlusion-culling>Use <code>multi_draw_indirect_count</code> where available, in preparation for two-phase occlusion culling. <a class=anchor-link href=#use-multi-draw-indirect-count-where-available-in-preparation-for-two-phase-occlusion-culling>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17211>#17211</a></div></div><ul><li>Systems that add custom phase items now need to populate the indirect drawing-related buffers. See the <code>specialized_mesh_pipeline</code> example for an example of how this is done.</ul><hr><h3 id=use-unchecked-shaders-for-better-performance>Use unchecked shaders for better performance <a class=anchor-link href=#use-unchecked-shaders-for-better-performance>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17767>#17767</a></div></div><ul><li>Bevy no longer turns on wgpuâ€™s runtime safety checks https://docs.rs/wgpu/latest/wgpu/struct.ShaderRuntimeChecks.html. If you were using Bevy with untrusted shaders, please file an issue.</ul><hr><h3 id=cleanup-bevy-render-lib-rs>cleanup bevy_render/lib.rs <a class=anchor-link href=#cleanup-bevy-render-lib-rs>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16481>#16481</a></div></div><p><code>RenderCreation::Manual</code> variant fields are now wrapped in a struct called <code>RenderResources</code><hr><h3 id=extractedsprites-slice-buffer><code>ExtractedSprites</code> slice buffer <a class=anchor-link href=#extractedsprites-slice-buffer>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>, <span class=heading-meta__item>Text</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17041>#17041</a></div></div><ul><li><p><code>ExtractedSprite</code> has a new <code>kind: ExtractedSpriteKind</code> field with variants <code>Single</code> and <code>Slices</code>.</p> <ul><li><code>Single</code> represents a single sprite. <code>ExtractedSprite</code>â€™s <code>anchor</code>, <code>rect</code>, <code>scaling_mode</code> and <code>custom_size</code> fields have been moved into <code>Single</code>.<li><code>Slices</code> contains a range that indexes into a new resource <code>ExtractedSlices</code>. Slices are used to draw elements composed from multiple sprites such as text or nine-patched borders.</ul><li><p><code>ComputedTextureSlices::extract_sprites</code> has been renamed to <code>extract_slices</code>. Its <code>transform</code> and <code>original_entity</code> parameters have been removed.</p></ul><hr><h3 id=improved-uiimage-and-sprite-scaling-and-slicing-apis>Improved <code>UiImage</code> and <code>Sprite</code> scaling and slicing APIs <a class=anchor-link href=#improved-uiimage-and-sprite-scaling-and-slicing-apis>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>, <span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16088>#16088</a></div></div><p>The <code>ImageScaleMode</code> component has been removed. Instead, <code>SpriteImageMode</code> and <code>NodeImageMode</code> have been created for a new field <code>image_mode</code> on both <code>Sprite</code> and <code>UiImage</code><p>In most cases, this means code that spawns an entity with<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    <span class="z-meta z-path z-rust">UiImage<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>image<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">clone</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    <span class="z-meta z-path z-rust">ImageScaleMode<span class="z-punctuation z-accessor z-rust">::</span></span>Sliced<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>slicer<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">clone</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre><p>should be converted to:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">    <span class="z-meta z-path z-rust">UiImage<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>image<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">clone</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust">        <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_mode</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">NodeImageMode<span class="z-punctuation z-accessor z-rust">::</span></span>Sliced<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>slicer<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">clone</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre><hr><h3 id=rename-defaultcameraview>Rename <code>DefaultCameraView</code> <a class=anchor-link href=#rename-defaultcameraview>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>, <span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17235>#17235</a></div></div><p><code>DefaultCameraView</code> has been renamed to <code>UiCameraView</code><hr><h3 id=rename-targetcamera-to-uitargetcamera>Rename <code>TargetCamera</code> to <code>UiTargetCamera</code> <a class=anchor-link href=#rename-targetcamera-to-uitargetcamera>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>, <span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17403>#17403</a></div></div><p><code>TargetCamera</code> has been renamed to <code>UiTargetCamera</code>.<hr><h3 id=borderrect-maintenance><code>BorderRect</code> maintenance <a class=anchor-link href=#borderrect-maintenance>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Rendering</span>, <span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16727>#16727</a></div></div><p>The <code>square</code> and <code>rectangle</code> functions belonging to <code>BorderRect</code> have been renamed to <code>all</code> and <code>axes</code>.<h2 id=scenes>Scenes <a class=anchor-link href=#scenes>#</a></h2><h3 id=only-despawn-scene-entities-still-in-the-hierarchy>Only despawn scene entities still in the hierarchy <a class=anchor-link href=#only-despawn-scene-entities-still-in-the-hierarchy>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Scenes</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17938>#17938</a></div></div><p>If you previously relied on scene entities no longer in the hierarchy being despawned when the scene root is despawned , use <code>SceneSpawner::despawn_instance()</code> instead.<h2 id=tasks>Tasks <a class=anchor-link href=#tasks>#</a></h2><h3 id=support-on-thread-spawn-and-on-thread-destroy-for-taskpoolplugin>Support <code>on_thread_spawn</code> and <code>on_thread_destroy</code> for <code>TaskPoolPlugin</code> <a class=anchor-link href=#support-on-thread-spawn-and-on-thread-destroy-for-taskpoolplugin>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Tasks</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/13045>#13045</a></div></div><ul><li><code>TaskPooolThreadAssignmentPolicy</code> now has two additional fields: <code>on_thread_spawn</code> and <code>on_thread_destroy</code>. Please consider defaulting them to <code>None</code>.</ul><h2 id=text>Text <a class=anchor-link href=#text>#</a></h2><h3 id=add-byte-information-to-positionedglyph>Add byte information to <code>PositionedGlyph</code> <a class=anchor-link href=#add-byte-information-to-positionedglyph>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Text</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17900>#17900</a></div></div><p><code>PositionedGlyph::new()</code> has been removed as there is no longer an unused field. Create new <code>PositionedGlyph</code>s directly.<hr><h3 id=remove-the-atlas-scaling-field-from-extracteduiitem-glyphs>Remove the <code>atlas_scaling</code> field from <code>ExtractedUiItem::Glyphs</code>. <a class=anchor-link href=#remove-the-atlas-scaling-field-from-extracteduiitem-glyphs>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Text</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17047>#17047</a></div></div><p>The <code>atlas_scaling</code> field from <code>ExtractedUiItem::Glyphs</code> has been removed. This shouldnâ€™t affect any existing code as it wasnâ€™t used for anything.<hr><h3 id=add-line-height-to-textfont>add line height to <code>TextFont</code> <a class=anchor-link href=#add-line-height-to-textfont>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Text</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16614>#16614</a></div></div><p><code>TextFont</code> now has a <code>line_height</code> field. Any instantiation of <code>TextFont</code> that doesnâ€™t have <code>..default()</code> will need to add this field.<h2 id=ui>UI <a class=anchor-link href=#ui>#</a></h2><h3 id=fixing-valarithmeticerror-typo-and-unused-variant>Fixing <code>ValArithmeticError</code> typo and unused variant <a class=anchor-link href=#fixing-valarithmeticerror-typo-and-unused-variant>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17597>#17597</a></div></div><ul><li><code>ValArithmeticError::NonEvaluateable</code> has been renamed to <code>NonEvaluateable::NonEvaluable</code><li><code>ValArithmeticError::NonIdenticalVariants </code> has been removed</ul><hr><h3 id=move-textureatlas-into-uiimage-and-remove-impl-component-for-textureatlas>Move TextureAtlas into UiImage and remove impl Component for TextureAtlas <a class=anchor-link href=#move-textureatlas-into-uiimage-and-remove-impl-component-for-textureatlas>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16072>#16072</a></div></div><p>Before:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">  <span class="z-meta z-path z-rust">UiImage<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>image</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">  TextureAtlas <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> index<span class="z-punctuation z-separator z-rust">,</span> layout </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust"></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>After:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">UiImage<span class="z-punctuation z-accessor z-rust">::</span></span>from_atlas_image<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>image<span class="z-punctuation z-separator z-rust">,</span> TextureAtlas <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> index<span class="z-punctuation z-separator z-rust">,</span> layout </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>Before:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>UiImage <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    texture<span class="z-punctuation z-separator z-rust">:</span> some_image<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-operator z-range z-rust">..</span><span class="z-support z-function z-rust">default</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre><p>After:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>UiImage <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    image<span class="z-punctuation z-separator z-rust">:</span> some_image<span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-operator z-range z-rust">..</span><span class="z-support z-function z-rust">default</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre><hr><h3 id=multiple-box-shadow-support>Multiple box shadow support <a class=anchor-link href=#multiple-box-shadow-support>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16502>#16502</a></div></div><p>Bevy UI now supports multiple shadows per node. A new struct <code>ShadowStyle</code> is used to set the style for each shadow. And the <code>BoxShadow</code> component is changed to a tuple struct wrapping a vector containing a list of <code>ShadowStyle</code>s. To spawn a node with a single shadow you can use the <code>new</code> constructor function:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">    <span class="z-meta z-path z-rust">Node<span class="z-punctuation z-accessor z-rust">::</span></span>default<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">    <span class="z-meta z-path z-rust">BoxShadow<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">        <span class="z-meta z-path z-rust">Color<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">BLACK</span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">with_alpha</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">8</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">        <span class="z-meta z-path z-rust">Val<span class="z-punctuation z-accessor z-rust">::</span></span>Percent<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>offset<span class="z-punctuation z-accessor z-dot z-rust">.</span>x</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">        <span class="z-meta z-path z-rust">Val<span class="z-punctuation z-accessor z-rust">::</span></span>Percent<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>offset<span class="z-punctuation z-accessor z-dot z-rust">.</span>y</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">        <span class="z-meta z-path z-rust">Val<span class="z-punctuation z-accessor z-rust">::</span></span>Percent<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>spread</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">        <span class="z-meta z-path z-rust">Val<span class="z-punctuation z-accessor z-rust">::</span></span>Px<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>blur</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust">    </span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-meta z-group z-rust"></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><hr><h3 id=only-use-physical-coords-internally-in-bevy-ui>Only use physical coords internally in <code>bevy_ui</code> <a class=anchor-link href=#only-use-physical-coords-internally-in-bevy-ui>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16375>#16375</a></div></div><p><code>ComputedNode</code>â€™s fields and methods now use physical coordinates. <code>ComputedNode</code> has a new field <code>inverse_scale_factor</code>. Multiplying the physical coordinates by the <code>inverse_scale_factor</code> will give the logical values.<hr><h3 id=remove-custom-rounding>Remove custom rounding <a class=anchor-link href=#remove-custom-rounding>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16097>#16097</a></div></div><p><code>UiSurface::get_layout</code> now also returns the final sizes before rounding. Call <code>.0</code> on the <code>Ok</code> result to get the previously returned <code>taffy::Layout</code> value.<hr><h3 id=remove-the-min-and-max-fields-from-layoutcontext>Remove the <code>min</code> and <code>max</code> fields from <code>LayoutContext</code>. <a class=anchor-link href=#remove-the-min-and-max-fields-from-layoutcontext>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16459>#16459</a></div></div><p>The <code>min</code> and <code>max</code> fields have been removed from <code>LayoutContext</code>. To retrieve these values call <code>min_element</code> and <code>max_element</code> on <code>LayoutContent::physical_size</code> instead.<hr><h3 id=rename-uiboxshadowsamples-to-boxshadowsamples>Rename <code>UiBoxShadowSamples</code> to <code>BoxShadowSamples</code>. <a class=anchor-link href=#rename-uiboxshadowsamples-to-boxshadowsamples>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16505>#16505</a></div></div><p><code>UiBoxShadowSamples</code> has been renamed to <code>BoxShadowSamples</code><hr><h3 id=uiimage-imagenode-uiimagesize-imagenodesize>UiImage -> ImageNode, UiImageSize -> ImageNodeSize <a class=anchor-link href=#uiimage-imagenode-uiimagesize-imagenodesize>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>UI</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16271>#16271</a></div></div><p>Before:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">UiImage<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>image</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><p>After:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust">commands<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">spawn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-path z-rust">ImageNode<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>image</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><h2 id=windowing>Windowing <a class=anchor-link href=#windowing>#</a></h2><h3 id=make-customcursor-variants-customcursorimage-customcursorurl-structs>Make CustomCursor variants CustomCursorImage/CustomCursorUrl structs <a class=anchor-link href=#make-customcursor-variants-customcursorimage-customcursorurl-structs>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Windowing</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17518>#17518</a></div></div><p>The <code>CustomCursor</code> enumâ€™s variants now hold instances of <code>CustomCursorImage</code> or <code>CustomCursorUrl</code>. Update your uses of <code>CustomCursor</code> accordingly.<hr><h3 id=make-rawhandlewrapper-fields-private-to-save-users-from-themselves>Make <code>RawHandleWrapper</code> fields private to save users from themselves <a class=anchor-link href=#make-rawhandlewrapper-fields-private-to-save-users-from-themselves>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Windowing</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16968>#16968</a></div></div><p>The <code>window_handle</code> and <code>display_handle</code> fields on <code>RawHandleWrapper</code> are no longer public. Use the newly added getters and setters to manipulate them instead.<hr><h3 id=rework-windowmode-fullscreen-api>Rework WindowMode::Fullscreen API <a class=anchor-link href=#rework-windowmode-fullscreen-api>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Windowing</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17525>#17525</a></div></div><p><code>WindowMode::SizedFullscreen(MonitorSelection)</code> and <code>WindowMode::Fullscreen(MonitorSelection)</code> has become <code>WindowMode::Fullscreen(MonitorSelection, VideoModeSelection)</code>. Previously, the VideoMode was selected based on the closest resolution to the current window size for SizedFullscreen and the largest resolution for Fullscreen. It is possible to replicate that behaviour by searching <code>Monitor::video_modes</code> and selecting it with <code>VideoModeSelection::Specific(VideoMode)</code> but it is recommended to use <code>VideoModeSelection::Current</code> as the default video mode when entering fullscreen.<hr><h3 id=support-texture-atlases-in-customcursor-image>Support texture atlases in CustomCursor::Image <a class=anchor-link href=#support-texture-atlases-in-customcursor-image>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Windowing</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17121>#17121</a></div></div><p>The <code>CustomCursor::Image</code> enum variant has some new fields. Update your code to set them.<p>Before:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-path z-rust">CustomCursor<span class="z-punctuation z-accessor z-rust">::</span></span>Image <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    handle<span class="z-punctuation z-separator z-rust">:</span> asset_server<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">load</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>branding/icon.png<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    hotspot<span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">128</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">128</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></code></pre><p>After:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-path z-rust">CustomCursor<span class="z-punctuation z-accessor z-rust">::</span></span>Image <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    handle<span class="z-punctuation z-separator z-rust">:</span> asset_server<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">load</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>branding/icon.png<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    texture_atlas<span class="z-punctuation z-separator z-rust">:</span> <span class="z-support z-type z-rust">None</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    flip_x<span class="z-punctuation z-separator z-rust">:</span> <span class="z-constant z-language z-rust">false</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    flip_y<span class="z-punctuation z-separator z-rust">:</span> <span class="z-constant z-language z-rust">false</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    rect<span class="z-punctuation z-separator z-rust">:</span> <span class="z-support z-type z-rust">None</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    hotspot<span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">128</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">128</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></code></pre><h2 id=utils>Utils <a class=anchor-link href=#utils>#</a></h2><h3 id=bevy-utils-refactor><code>bevy_utils</code> Refactor <a class=anchor-link href=#bevy-utils-refactor>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span><span class=heading-meta__item>Utils</span>.</div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/15801>#15801</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16112>#16112</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16161>#16161</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16951>#16951</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17158>#17158</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17161>#17161</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17250>#17250</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17254>#17254</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17460>#17460</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17577>#17577</a></div></div><p>In 0.16 <code>bevy_utils</code> (and by extension <code>bevy::utils</code>) was significantly reduced with many of its items either being removed, spun-out into their own crates, or just moved into more appropriate existing crates. Below is a series of tables for all items that were in <code>bevy_utils</code> 0.15 that have since been moved or removed in 0.16.<p>Note that certain items have been completely removed, see below for further details.<p><strong>Re-Exports</strong><table><thead><tr><th>Item<th>0.15 Path<th>0.16 Path<tbody><tr><td><code>hashbrown</code><td><code>bevy_utils</code><td><em>Removed</em><tr><td><code>tracing</code><td><code>bevy_utils</code><td><code>bevy_log</code></table><p><strong>Structs</strong><table><thead><tr><th>Item<th>0.15 Path<th>0.16 Path<tbody><tr><td><code>AHasher</code><td><code>bevy_utils</code><td><code>ahash</code><tr><td><code>Duration</code><td><code>bevy_utils</code><td><code>core::time</code><tr><td><code>FixedState</code><td><code>bevy_utils</code><td><code>bevy_platform::hash</code><tr><td><code>Hashed</code><td><code>bevy_utils</code><td><code>bevy_platform::hash</code><tr><td><code>Instant</code><td><code>bevy_utils</code><td><code>bevy_platform::time</code><tr><td><code>NoOpHash</code><td><code>bevy_utils</code><td><code>bevy_platform::time</code><tr><td><code>PassHash</code><td><code>bevy_utils</code><td><code>bevy_platform::time</code><tr><td><code>PassHasher</code><td><code>bevy_utils</code><td><code>bevy_platform::time</code><tr><td><code>RandomState</code><td><code>bevy_utils</code><td><code>bevy_platform::time</code><tr><td><code>SystemTime</code><td><code>bevy_utils</code><td><code>std::time</code><tr><td><code>SystemTimeError</code><td><code>bevy_utils</code><td><code>std::time</code><tr><td><code>TryFromFloatSecsError</code><td><code>bevy_utils</code><td><code>core::time</code></table><p><strong>Traits</strong><table><thead><tr><th>Item<th>0.15 Path<th>0.16 Path<tbody><tr><td><code>ConditionalSend</code><td><code>bevy_utils</code><td><code>bevy_tasks</code><tr><td><code>ConditionalSendFuture</code><td><code>bevy_utils</code><td><code>bevy_tasks</code></table><p><strong>Macros</strong><table><thead><tr><th>Item<th>0.15 Path<th>0.16 Path<tbody><tr><td><code>assert_object_safe</code><td><code>bevy_utils</code><td><em>Removed</em><tr><td><code>debug</code><td><code>bevy_utils</code><td><code>bevy_log</code><tr><td><code>error</code><td><code>bevy_utils</code><td><code>bevy_log</code><tr><td><code>info</code><td><code>bevy_utils</code><td><code>bevy_log</code><tr><td><code>warn</code><td><code>bevy_utils</code><td><code>bevy_log</code><tr><td><code>all_tuples</code><td><code>bevy_utils</code><td><code>variadics_please</code><tr><td><code>all_tuples_with_size</code><td><code>bevy_utils</code><td><code>variadics_please</code><tr><td><code>debug_once</code><td><code>bevy_utils</code><td><code>bevy_log</code><tr><td><code>detailed_trace</code><td><code>bevy_utils</code><td><em>Removed</em><tr><td><code>error_once</code><td><code>bevy_utils</code><td><code>bevy_log</code><tr><td><code>info_once</code><td><code>bevy_utils</code><td><code>bevy_log</code><tr><td><code>trace_once</code><td><code>bevy_utils</code><td><code>bevy_log</code><tr><td><code>warn_once</code><td><code>bevy_utils</code><td><code>bevy_log</code></table><p>Note that if you were previously relying on <code>bevy_utils</code> to get access to the re-exported <code>tracing</code> macros like <code>info!</code>, <code>warn!</code> or <code>debug!</code>, you should now rely on <code>bevy_log</code> instead (or <code>tracing</code> itself, being sure to keep the versions aligned).<p><strong>Functions</strong><table><thead><tr><th>Item<th>0.15 Path<th>0.16 Path<tbody><tr><td><code>check_ready</code><td><code>bevy_utils::futures</code><td><code>bevy_tasks::futures</code><tr><td><code>now_or_never</code><td><code>bevy_utils::futures</code><td><code>bevy_tasks::futures</code></table><p><strong>Type Aliases</strong><table><thead><tr><th>Item<th>0.15 Path<th>0.16 Path<tbody><tr><td><code>BoxedFuture</code><td><code>bevy_utils</code><td><code>bevy_tasks</code><tr><td><code>Entry</code><td><code>bevy_utils</code><td><code>bevy_platform::collections::hash_map</code><tr><td><code>HashMap</code><td><code>bevy_utils</code><td><code>bevy_platform::collections</code><tr><td><code>HashSet</code><td><code>bevy_utils</code><td><code>bevy_platform::collections</code><tr><td><code>StableHashMap</code><td><code>bevy_utils</code><td><em>Removed</em><tr><td><code>StableHashSet</code><td><code>bevy_utils</code><td><em>Removed</em></table><p><strong>Removed Items</strong><ul><li><p><code>assert_object_safe</code> was removed in part because the term is now outdated (replaced with <em>dyn compatibility</em>) and otherwise because it is trivial to inline.</p> <pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Before
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">const</span> <span class="z-keyword z-operator z-rust">_</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">assert_object_safe<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>dyn MyTrait<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> After
</span></span><span class="z-source z-rust"><span class="z-storage z-type z-rust">const</span> <span class="z-keyword z-operator z-rust">_</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Option</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Box</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>dyn MyTrait<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-definition z-generic z-end z-rust">></span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-support z-type z-rust">None</span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><li><p><code>hashbrown</code> was removed from <code>bevy_utils</code> as a re-export due to its significant API change from <code>hashbrown</code> 0.14 to 0.15. Instead of exposing a large public API out of our direct control, we've taken a more explicit subset and moved it into <code>bevy_platform::collections</code>, mimicking the layout of the standard library. If you need access to <code>hashbrown</code>, take a direct dependency instead.</p><li><p><code>detailed_trace</code> was removed due to its minimal use within the engine. If you still wish to use it, make sure you have taken a direct dependency on <code>tracing</code> and have a feature name <code>detailed_trace</code> defined in your <code>Cargo.toml</code>. You can use the below as a replacement:</p> <pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-macro z-rust"><span class="z-support z-function z-rust">macro_rules!</span> <span class="z-entity z-name z-macro z-rust">detailed_trace</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span></span></span><span class="z-meta z-macro z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-macro z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-group z-macro-matcher z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust"><span class="z-keyword z-operator z-rust">$</span>(</span><span class="z-variable z-parameter z-macro z-rust">$tts</span><span class="z-punctuation z-separator z-rust">:</span><span class="z-storage z-type z-rust">tt</span><span class="z-punctuation z-section z-group z-end z-rust">)</span><span class="z-keyword z-operator z-rust">*</span></span><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">=></span> <span class="z-meta z-block z-macro-body z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-macro z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-macro-body z-rust">        <span class="z-keyword z-control z-rust">if</span> <span class="z-support z-macro z-rust">cfg!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>feature <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>detailed_trace<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-macro z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-macro-body z-rust"><span class="z-meta z-block z-rust">            <span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">tracing<span class="z-punctuation z-accessor z-rust">::</span></span>trace<span class="z-keyword z-operator z-logical z-rust">!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-keyword z-operator z-rust">$</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-variable z-other z-rust">$tts</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-keyword z-operator z-arithmetic z-rust">*</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-macro z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-macro-body z-rust"><span class="z-meta z-block z-rust">        </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-macro z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-macro-body z-rust">    <span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-macro z-rust"><span class="z-meta z-block z-rust"></span></span><span class="z-meta z-macro z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><li><p><code>dbg</code>, <code>info</code>, <code>warn</code>, and <code>error</code> were all removed due to minimal use within the engine. If you still wish to use them, make sure you have taken a direct dependency on <code>tracing</code>. You can use the below as a replacement:</p> <pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">///</span> Calls the [`tracing::info!`] macro on a value.
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">info</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>T<span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-path z-rust">core<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">fmt<span class="z-punctuation z-accessor z-rust">::</span></span>Debug<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">data</span><span class="z-punctuation z-separator z-rust">:</span> T</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">tracing<span class="z-punctuation z-accessor z-rust">::</span></span>info<span class="z-keyword z-operator z-logical z-rust">!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>{:?}<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span><span class="z-punctuation z-separator z-rust">,</span> data</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">///</span> Calls the [`tracing::debug!`] macro on a value.
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">dbg</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>T<span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-path z-rust">core<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">fmt<span class="z-punctuation z-accessor z-rust">::</span></span>Debug<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">data</span><span class="z-punctuation z-separator z-rust">:</span> T</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">tracing<span class="z-punctuation z-accessor z-rust">::</span></span>debug<span class="z-keyword z-operator z-logical z-rust">!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>{:?}<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span><span class="z-punctuation z-separator z-rust">,</span> data</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">///</span> Processes a [`Result`] by calling the [`tracing::warn!`] macro in case of an [`Err`] value.
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">warn</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>E<span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-path z-rust">core<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">fmt<span class="z-punctuation z-accessor z-rust">::</span></span>Debug<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">result</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Result</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-punctuation z-section z-group z-end z-rust">)</span>, E<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">if</span> <span class="z-storage z-type z-rust">let</span> <span class="z-support z-type z-rust">Err</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>warn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> result <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">tracing<span class="z-punctuation z-accessor z-rust">::</span></span>warn<span class="z-keyword z-operator z-logical z-rust">!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>{:?}<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span><span class="z-punctuation z-separator z-rust">,</span> warn</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">///</span> Processes a [`Result`] by calling the [`tracing::error!`] macro in case of an [`Err`] value.
</span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">error</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>E<span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-path z-rust">core<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">fmt<span class="z-punctuation z-accessor z-rust">::</span></span>Debug<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">result</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Result</span><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-punctuation z-section z-group z-end z-rust">)</span>, E<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">if</span> <span class="z-storage z-type z-rust">let</span> <span class="z-support z-type z-rust">Err</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>error</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> result <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">        <span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">tracing<span class="z-punctuation z-accessor z-rust">::</span></span>error<span class="z-keyword z-operator z-logical z-rust">!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>{:?}<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span><span class="z-punctuation z-separator z-rust">,</span> error</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><li><p><code>StableHashMap</code> and <code>StableHashSet</code> were removed due to minimal use within the engine. You can use the below as a replacement:</p> <pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">///</span> A stable hash-map.
</span></span><span class="z-source z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-type z-rust">type</span> <span class="z-entity z-name z-type z-rust">StableHashMap</span><span class="z-keyword z-operator z-comparison z-rust"><</span>K<span class="z-punctuation z-separator z-rust">,</span> V<span class="z-keyword z-operator z-comparison z-rust">></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">bevy<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">platform_support<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">collections<span class="z-punctuation z-accessor z-rust">::</span></span>HashMap<span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>K, V, <span class="z-meta z-path z-rust">bevy<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">platform_support<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">hash<span class="z-punctuation z-accessor z-rust">::</span></span>FixedState<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">///</span> A stable hash-set.
</span></span><span class="z-source z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-type z-rust">type</span> <span class="z-entity z-name z-type z-rust">StableHashSet</span><span class="z-keyword z-operator z-comparison z-rust"><</span>K<span class="z-keyword z-operator z-comparison z-rust">></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">bevy<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">platform_support<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">collections<span class="z-punctuation z-accessor z-rust">::</span></span>HashSet<span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>K, <span class="z-meta z-path z-rust">bevy<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">platform_support<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">hash<span class="z-punctuation z-accessor z-rust">::</span></span>FixedState<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre></ul><h2 id=without-area>Without area <a class=anchor-link href=#without-area>#</a></h2><h3 id=link-ios-example-with-rustc-and-avoid-c-trampoline>Link iOS example with <code>rustc</code>, and avoid C trampoline <a class=anchor-link href=#link-ios-example-with-rustc-and-avoid-c-trampoline>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span></div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/14780>#14780</a></div></div><p><strong>If you have been building your application for iOS:</strong><p>Previously, the <code>#[bevy_main]</code> attribute created a <code>main_rs</code> entry point that most Xcode templates were using to run your Rust code from C. This was found to be unnecessary, as you can simply let Rust build your application as a binary, and run that directly.<p>You have two options for dealing with this.<h4 id=new-suggested-approach>New, suggested approach <a class=anchor-link href=#new-suggested-approach>#</a></h4><p>Preferred option is to remove your â€œcompileâ€ and â€œlinkâ€ build phases, and instead replace it with a â€œrun scriptâ€ phase that invokes <code>cargo build --bin ...</code>, and moves the built binary to the Xcode path <code>$TARGET_BUILD_DIR/$EXECUTABLE_PATH</code>. An example of how to do this can be viewed in <a href=https://github.com/bevyengine/bevy/tree/main/examples/mobile>mobile example</a>.<p>If you are not sure how to do this, consider one of two ways:<ul><li>replace local mobile <code>game</code> crate with the one in repo and reapply your changes.<li>replicate the changes from <a href=https://github.com/bevyengine/bevy/pull/14780>pull request</a> in your <code>mobile</code> crate.</ul><p>To make the debugging experience in Xcode nicer after this, you might also want to consider either enabling <code>panic = "abort"</code> or to set a breakpoint on the <code>rust_panic</code> symbol.<h4 id=restoring-old-behaviour>Restoring old behaviour <a class=anchor-link href=#restoring-old-behaviour>#</a></h4><p>If youâ€™re using additional ObjC code, Swift packages, Xcode customizations, or if it otherwise it makes sense for your use-case to continue link with Xcode, you can revert to the old behavior by adding code below to your <code>main.rs</code> file:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">cfg</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">target_os <span class="z-keyword z-operator z-rust">=</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>ios<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">unsafe</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">no_mangle</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-keyword z-other z-rust">extern</span> <span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>C<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span> <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">main_rs</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-support z-function z-rust">main</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>Note that the old approach of linking a static library prevents the Rust standard library from doing runtime initialization, so certain functionality provided by <code>std</code> might be unavailable (stack overflow handlers, stdout/stderr flushing and other such functionality provided by the initialization routines).<hr><h3 id=remove-image-from-buffer-name-argument-only-present-in-debug-dds-builds>Remove Image::from_buffer <code>name</code> argument (only present in debug "dds" builds) <a class=anchor-link href=#remove-image-from-buffer-name-argument-only-present-in-debug-dds-builds>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span></div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/18538>#18538</a></div></div><ul><li><code>Image::from_buffer()</code> no longer has a <code>name</code> argument thatâ€™s only present in debug builds when the <code>"dds"</code> feature is enabled. If you happen to pass a name, remove it.</ul><hr><h3 id=remove-bevy-core>Remove <code>bevy_core</code> <a class=anchor-link href=#remove-bevy-core>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span></div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16894>#16894</a>, <a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16897>#16897</a></div></div><p><code>bevy_core</code> has been removed and its items moved into more appropriate locations. Below are some tables showing where items have been moved to<h4 id=structs>Structs <a class=anchor-link href=#structs>#</a></h4><table><thead><tr><th>Item<th>0.15 Path<th>0.16 Path<tbody><tr><td><code>FrameCount</code><td><code>bevy_core</code><td><code>bevy_diagnostic</code><tr><td><code>FrameCountPlugin</code><td><code>bevy_core</code><td><code>bevy_diagnostic</code><tr><td><code>Name</code><td><code>bevy_core</code><td><code>bevy_ecs::name</code><tr><td><code>NameOrEntity</code><td><code>bevy_core</code><td><code>bevy_ecs::name</code><tr><td><code>NameOrEntityItem</code><td><code>bevy_core</code><td><code>bevy_ecs::name</code><tr><td><code>NonSendMarker</code><td><code>bevy_core</code><td><code>bevy_ecs::system</code><tr><td><code>TaskPoolOptions</code><td><code>bevy_core</code><td><code>bevy_app</code><tr><td><code>TaskPoolPlugin</code><td><code>bevy_core</code><td><code>bevy_app</code><tr><td><code>TaskPoolThreadAssignmentPolicy</code><td><code>bevy_core</code><td><code>bevy_app</code><tr><td><code>TypeRegistrationPlugin</code><td><code>bevy_core</code><td><em>Removed</em></table><h4 id=functions>Functions <a class=anchor-link href=#functions>#</a></h4><table><thead><tr><th>Item<th>0.15 Path<th>0.16 Path<tbody><tr><td><code>update_frame_count</code><td><code>bevy_core</code><td><code>bevy_diagnostic</code></table><h4 id=removed>Removed <a class=anchor-link href=#removed>#</a></h4><p><code>TypeRegistrationPlugin</code> no longer exists. If you canâ€™t use a default <code>App</code> but still need <code>Name</code> registered, do so manually.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Before
</span></span><span class="z-source z-rust">app<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">add_plugins</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>TypeRegistrationPlugin</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> After
</span></span><span class="z-source z-rust">app<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-meta z-path z-rust">register_type<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-generic z-rust"><span class="z-punctuation z-definition z-generic z-begin z-rust"><</span>Name<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><hr><h3 id=rename-trigger-entity-to-trigger-target>Rename <code>trigger.entity()</code> to <code>trigger.target()</code> <a class=anchor-link href=#rename-trigger-entity-to-trigger-target>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span></div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/16716>#16716</a></div></div><ul><li>Rename <code>Trigger::entity()</code> to <code>Trigger::target()</code>.<li>Rename <code>ObserverTrigger::entity</code> to <code>ObserverTrigger::target</code></ul><hr><h3 id=use-target-abi-sim-instead-of-ios-simulator-feature>Use <code>target_abi = "sim"</code> instead of <code>ios_simulator</code> feature <a class=anchor-link href=#use-target-abi-sim-instead-of-ios-simulator-feature>#</a></h3><div class=heading-meta><div><span class=heading-meta__title>Areas:</span></div><div><span class=heading-meta__title> PRs:</span><a class=heading-meta__item href=https://github.com/bevyengine/bevy/pull/17702>#17702</a></div></div><p>If you're using a project that builds upon the mobile example, remove the <code>ios_simulator</code> feature from your <code>Cargo.toml</code> (Bevy now handles this internally).</div></div><div class="docs-footer print:hidden"><nav class=docs-footer__nav><a class="docs-footer__link docs-footer__link--next" data-docs-nav-next href=/learn/migration-guides/0-14-to-0-15/> <div class=docs-footer__label><div class=docs-footer__dir>Next</div> 0.14 to 0.15</div> <i class="docs-footer__chevron icon icon--chevron-right"></i> </a><a class="docs-footer__link docs-footer__link--prev" data-docs-nav-previous href=/learn/migration-guides/0-16-to-0-17/> <div class=docs-footer__label><div class=docs-footer__dir>Previous</div> 0.16 to 0.17</div> <i class="docs-footer__chevron icon icon--chevron-left"></i> </a></nav><div class=docs-footer__edit-wrapper><a class=docs-footer__edit href=https://github.com/bevyengine/bevy-website/edit/main/content/learn/migration-guides/0.15-to-0.16.md> <i class="icon icon--pencil"></i> Improve this page </a><a href="https://github.com/bevyengine/bevy-website/issues/new?template=docs.md&title=Issue%20on%20page%200.15%20to%200.16" class=docs-footer__edit> <i class="icon icon--github"></i> Report issue </a></div></div></div></div></div></div></div></main><footer class=print:hidden><div class=footer__social-container><a class=footer__social href=https://github.com/bevyengine/bevy title=GitHub> <img alt="GitHub logo" height=24 src=/assets/github-mark-white.svg width=24> </a><a class=footer__social href=https://discord.gg/bevy title=Discord> <img alt="Discord logo" height=24 src=/assets/discord.svg width=24> </a><a class=footer__social href=https://bsky.app/profile/bevy.org title=Bluesky> <img alt="Bluesky logo" height=24 src=/assets/bluesky.svg width=24> </a><a class=footer__social href=https://mastodon.social/@bevy title=Mastodon> <img alt="Mastodon logo" height=24 src=/assets/mastodon-logo-purple.svg width=24> </a><a class=footer__social href=https://www.reddit.com/r/bevy/ title=Reddit> <img alt="Reddit logo" height=24 src=/assets/reddit.svg width=24> </a><a class=footer__social href=https://itch.io/games/tag-bevy title=itch.io> <img alt="itch.io logo" height=24 src=/assets/itchio-textless.svg width=24> </a><a title="Bevy news feed" class=footer__social href=/atom.xml> <img alt="Bevy news feed" height=24 src=/assets/feed.svg width=24> </a></div></footer></div><script>const search_params=new URLSearchParams(window.location.search);if(search_params.has(`show_drafts`)||document.cookie.indexOf(`show_drafts`)>=0){let a=`show_drafts`;if(search_params.get(a)===`0`){document.cookie=`show_drafts=;path=/;expires=Thu, 01 Jan 1970 00:00:00 UTC`}else{document.cookie=`show_drafts=1;path=/`;document.body.classList.add(a)}}</script>